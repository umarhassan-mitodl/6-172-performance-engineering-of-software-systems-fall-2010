---
about_this_resource_text: <p><strong>Description:</strong> Discussion of project 3
  beta. Lecture covering multicore programming, including shared-memory hardware,
  concurrency platforms, and race conditions.</p> <p><strong>Speakers:</strong> Charles
  Leiserson, John Dong</p>
content_type: resource
course_id: 6-172-performance-engineering-of-software-systems-fall-2010
embedded_media:
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.172F10/MIT6_172_F10_lec12_300k.mp4
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: Video-Internet Archive-MP4
  type: Video
  uid: f40f5adb69564d1bcd593d2b1f15f8ff
- id: Video-iTunesU-MP4
  media_location: http://itunes.apple.com/us/itunes-u/lecture-12-multicore-programming/id481759887?i=109649109
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: Video-iTunes U-MP4
  type: Video
  uid: 0f4181b285d6f148c2aef1700c4fbf19
- id: Video-YouTube-Stream
  media_location: _40zvhkmtM8
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: Video-YouTube-Stream
  type: Video
  uid: 7a92973d06437377df29788a7dd524ef
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/_40zvhkmtM8/default.jpg
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: b92fdb0dd64b6119c6a2e587a8fa81b1
- id: MIT6_172F10_lec12.pdf
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-172-performance-engineering-of-software-systems-fall-2010/video-lectures/lecture-12-multicore-programming/MIT6_172F10_lec12.pdf
  title: MIT6_172F10_lec12.pdf
  type: null
  uid: 7fc73afd22086bcad51de89947c118f1
- id: 3Play-3PlayYouTubeid-MP4
  media_location: _40zvhkmtM8
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 9cb8264f63dba6757e060d6accb1e047
- id: 40zvhkmtM8.srt
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-172-performance-engineering-of-software-systems-fall-2010/video-lectures/lecture-12-multicore-programming/40zvhkmtM8.srt
  title: 3play caption file
  type: null
  uid: 218a32d48ea72cc16e7e9a8355d1397b
- id: 40zvhkmtM8.pdf
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-172-performance-engineering-of-software-systems-fall-2010/video-lectures/lecture-12-multicore-programming/40zvhkmtM8.pdf
  title: 3play pdf file
  type: null
  uid: ad55eea4dec4684e5f65343c67c253b7
- id: Caption-3Play YouTube id-SRT
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 432dd370840afddc21ab7fc4f6308867
- id: Transcript-3Play YouTube id-PDF
  parent_uid: b3d5da5fcd90d88e12739229d0e49cd2
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 4dcda22235a8284f722cf9d88995c9c8
file: null
file_size: null
hide_download: true
hide_download_original: null
inline_embed_id: 1367447lecture12:multicoreprogramming35260933
layout: video
license: https://creativecommons.org/licenses/by-nc-sa/4.0/
order_index: 137
parent_uid: 24169d0487e846a39c316276f85b8cb5
related_resources_text: ''
short_url: lecture-12-multicore-programming
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-172-performance-engineering-of-software-systems-fall-2010/video-lectures/lecture-12-multicore-programming
title: 'Lecture 12: Multicore Programming'
transcript: '<p><span m=''120''>The</span> <span m=''190''>following</span> <span
  m=''630''>content</span> <span m=''1230''>is</span> <span m=''1340''>provided</span>
  <span m=''1790''>under</span> <span m=''2070''>a</span> <span m=''2090''>Creative</span>
  <span m=''2500''>Commons</span> <span m=''2910''>license.</span> <span m=''3910''>Your</span>
  <span m=''4200''>support</span> <span m=''4700''>will</span> <span m=''4870''>help</span>
  <span m=''5100''>MIT</span> <span m=''5580''>OpenCourseWare</span> <span m=''6360''>continue</span>
  <span m=''6870''>to</span> <span m=''6950''>offer</span> <span m=''7380''>high</span>
  <span m=''7590''>quality</span> <span m=''8119''>educational</span> <span m=''8740''>resources</span>
  <span m=''9390''>for</span> <span m=''9520''>free.</span> <span m=''10600''>To</span>
  <span m=''10730''>make</span> <span m=''10930''>a</span> <span m=''10980''>donation</span>
  <span m=''11620''>or</span> <span m=''11930''>view</span> <span m=''12340''>additional</span>
  <span m=''12800''>materials</span> <span m=''13340''>from</span> <span m=''13500''>hundreds</span>
  <span m=''13930''>of</span> <span m=''14040''>MIT</span> <span m=''14460''>courses,</span>
  <span m=''15460''>visit</span> <span m=''15790''>MIT</span> <span m=''16219''>OpenCourseWare</span>
  <span m=''17250''>at</span> <span m=''18480''>ocw.mit.edu.</span> </p><p><span m=''30430''>PROFESSOR:
  So</span> <span m=''30720''>John</span> <span m=''31110''>is</span> <span m=''31250''>going</span>
  <span m=''31440''>to</span> <span m=''31640''>present</span> <span m=''33440''>project</span>
  <span m=''33810''>three,</span> <span m=''34440''>beta.</span> </p><p><span m=''35490''>JOHN:
  All</span> <span m=''35620''>right.</span> <span m=''35900''>So</span> <span m=''36530''>here''s</span>
  <span m=''36910''>the</span> <span m=''37190''>performance</span> <span m=''37690''>grades.</span>
  <span m=''38410''>In</span> <span m=''38560''>general,</span> <span m=''39030''>the</span>
  <span m=''39190''>submission</span> <span m=''39740''>went</span> <span m=''39950''>a</span>
  <span m=''40030''>lot</span> <span m=''40320''>better</span> <span m=''40590''>than</span>
  <span m=''40810''>last</span> <span m=''41180''>time</span> <span m=''41520''>in</span>
  <span m=''41640''>that</span> <span m=''41910''>things</span> <span m=''42230''>were</span>
  <span m=''42600''>on</span> <span m=''42880''>time</span> <span m=''43320''>and</span>
  <span m=''44020''>nobody</span> <span m=''44540''>failed</span> <span m=''44880''>to</span>
  <span m=''44950''>build,</span> <span m=''45400''>or</span> <span m=''45570''>forgot</span>
  <span m=''45970''>to</span> <span m=''46940''>add</span> <span m=''47210''>files</span>
  <span m=''47530''>to</span> <span m=''47610''>their</span> <span m=''47750''>project,</span>
  <span m=''48240''>or</span> <span m=''48360''>so</span> <span m=''48580''>on.</span>
  <span m=''50020''>We</span> <span m=''50300''>did</span> <span m=''50500''>change</span>
  <span m=''50890''>the</span> <span m=''51140''>scoring</span> <span m=''51750''>mechanism</span>
  <span m=''52520''>a</span> <span m=''52620''>little</span> <span m=''52910''>bit.</span>
  <span m=''54280''>In</span> <span m=''55330''>the</span> <span m=''55740''>[? mdriver
  ?]</span> <span m=''56430''>that</span> <span m=''56600''>we</span> <span m=''56720''>gave</span>
  <span m=''57020''>you,</span> <span m=''57420''>if</span> <span m=''57630''>your</span>
  <span m=''57940''>validator</span> <span m=''58570''>failed</span> <span m=''58930''>you</span>
  <span m=''59090''>on</span> <span m=''59220''>any</span> <span m=''59450''>of</span>
  <span m=''59550''>your</span> <span m=''59690''>traces,</span> <span m=''60220''>your</span>
  <span m=''60450''>score</span> <span m=''60820''>is</span> <span m=''60910''>a</span>
  <span m=''60980''>zero.</span> </p><p><span m=''62460''>In</span> <span m=''62780''>this</span>
  <span m=''63030''>one,</span> <span m=''63270''>we</span> <span m=''63380''>decided</span>
  <span m=''63780''>to</span> <span m=''63850''>be</span> <span m=''63960''>nicer.</span>
  <span m=''64400''>We</span> <span m=''64560''>replaced</span> <span m=''65030''>your</span>
  <span m=''65209''>validator</span> <span m=''65760''>with</span> <span m=''65990''>our</span>
  <span m=''66550''>correct</span> <span m=''67070''>validator.</span> <span m=''68080''>And</span>
  <span m=''68450''>for</span> <span m=''68680''>traces</span> <span m=''69240''>that</span>
  <span m=''69420''>you</span> <span m=''69500''>failed,</span> <span m=''69830''>you</span>
  <span m=''69910''>get</span> <span m=''70090''>a</span> <span m=''70140''>zero</span>
  <span m=''70620''>for</span> <span m=''70970''>the</span> <span m=''71100''>points</span>
  <span m=''71460''>that</span> <span m=''71690''>those</span> <span m=''71920''>traces</span>
  <span m=''72320''>contribute.</span> <span m=''72950''>But</span> <span m=''73110''>you</span>
  <span m=''73200''>did</span> <span m=''73460''>get</span> <span m=''73610''>an</span>
  <span m=''73740''>overall</span> <span m=''74160''>partial</span> <span m=''74560''>score,</span>
  <span m=''75410''>even</span> <span m=''75680''>if</span> <span m=''75780''>you</span>
  <span m=''76000''>failed</span> <span m=''76320''>a</span> <span m=''76420''>couple</span>
  <span m=''76700''>traces.</span> <span m=''77920''>So</span> <span m=''79280''>on</span>
  <span m=''79570''>that</span> <span m=''79890''>note,</span> <span m=''80220''>the</span>
  <span m=''80520''>reference</span> <span m=''81060''>implementation</span> <span
  m=''82000''>does</span> <span m=''82360''>get</span> <span m=''82490''>a</span>
  <span m=''82620''>56</span> <span m=''83330''>on</span> <span m=''83500''>this</span>
  <span m=''83670''>score.</span> <span m=''84370''>And</span> <span m=''84570''>there</span>
  <span m=''84690''>were</span> <span m=''84940''>people</span> <span m=''85270''>who</span>
  <span m=''85600''>had</span> <span m=''85860''>slower</span> <span m=''86590''>than</span>
  <span m=''86800''>reference</span> <span m=''87240''>implementations</span> <span
  m=''88040''>that</span> <span m=''88950''>landed</span> <span m=''89650''>below</span>
  <span m=''90060''>56.</span> <span m=''90750''>So</span> <span m=''90910''>that</span>
  <span m=''91110''>might</span> <span m=''91280''>be</span> <span m=''91400''>something</span>
  <span m=''91760''>to</span> <span m=''91830''>think</span> <span m=''92050''>about</span>
  <span m=''92360''>for</span> <span m=''92470''>your</span> <span m=''92630''>final</span>
  <span m=''92970''>submission.</span> </p><p><span m=''94610''>The</span> <span m=''94870''>high</span>
  <span m=''95100''>score</span> <span m=''95490''>was</span> <span m=''95750''>a</span>
  <span m=''95850''>96.</span> <span m=''96540''>And</span> <span m=''96790''>there</span>
  <span m=''96960''>were</span> <span m=''97070''>actually</span> <span m=''97460''>quite</span>
  <span m=''97750''>a</span> <span m=''97790''>few</span> <span m=''98310''>groups</span>
  <span m=''98800''>in</span> <span m=''98890''>the</span> <span m=''98960''>90s.</span>
  <span m=''99430''>So</span> <span m=''99870''>overall,</span> <span m=''100250''>people</span>
  <span m=''100510''>did</span> <span m=''100670''>really</span> <span m=''100920''>well</span>
  <span m=''101120''>on</span> <span m=''101440''>this.</span> <span m=''103330''>With</span>
  <span m=''103550''>that</span> <span m=''103810''>said,</span> <span m=''105780''>your</span>
  <span m=''105980''>validators</span> <span m=''107280''>didn''t</span> <span m=''107490''>really--</span>
  <span m=''109160''>I</span> <span m=''109230''>guess</span> <span m=''109630''>they</span>
  <span m=''109710''>were</span> <span m=''109900''>OK.</span> </p><p><span m=''110920''>But</span>
  <span m=''113480''>there''s</span> <span m=''114000''>some</span> <span m=''114300''>people</span>
  <span m=''114660''>whose</span> <span m=''114920''>validators</span> <span m=''115710''>failed</span>
  <span m=''116410''>projects</span> <span m=''116800''>that</span> <span m=''116920''>were</span>
  <span m=''117060''>correct,</span> <span m=''117530''>and</span> <span m=''117890''>other</span>
  <span m=''118090''>people</span> <span m=''118420''>whose</span> <span m=''118640''>validators</span>
  <span m=''119060''>failed</span> <span m=''119470''>to</span> <span m=''119560''>detect</span>
  <span m=''119990''>certain</span> <span m=''120220''>situations.</span> <span m=''121620''>So</span>
  <span m=''122000''>that''s</span> <span m=''122590''>also</span> <span m=''122880''>something</span>
  <span m=''123250''>to</span> <span m=''123330''>work</span> <span m=''123620''>on</span>
  <span m=''123800''>for</span> <span m=''123900''>the</span> <span m=''123990''>final.</span>
  <span m=''124650''>We</span> <span m=''124870''>won''t</span> <span m=''125110''>be</span>
  <span m=''125220''>releasing</span> <span m=''125670''>the</span> <span m=''125760''>stock</span>
  <span m=''126150''>validators.</span> <span m=''126730''>So</span> <span m=''126920''>it''ll</span>
  <span m=''127100''>be</span> <span m=''127290''>up</span> <span m=''127410''>to</span>
  <span m=''127500''>you</span> <span m=''127680''>guys</span> <span m=''128009''>to</span>
  <span m=''128340''>find</span> <span m=''128590''>out</span> <span m=''128840''>what''s</span>
  <span m=''129110''>wrong</span> <span m=''129389''>with your</span> <span m=''129479''>validators</span>
  <span m=''130139''>and</span> <span m=''130340''>fix</span> <span m=''130630''>them.</span>
  </p><p><span m=''131750''>And</span> <span m=''132130''>along</span> <span m=''132530''>the</span>
  <span m=''132620''>same</span> <span m=''132900''>lines</span> <span m=''133200''>of</span>
  <span m=''133290''>correctness,</span> <span m=''134370''>once</span> <span m=''134650''>again,</span>
  <span m=''134950''>for</span> <span m=''135090''>the</span> <span m=''135200''>final</span>
  <span m=''135550''>submission,</span> <span m=''136000''>we''ll</span> <span m=''136140''>be</span>
  <span m=''136300''>running--</span> <span m=''136850''>actually</span> <span m=''137290''>even</span>
  <span m=''137510''>for</span> <span m=''137640''>the</span> <span m=''137700''>beta,</span>
  <span m=''138010''>I</span> <span m=''138110''>believe,</span> <span m=''138490''>we''re</span>
  <span m=''138680''>going</span> <span m=''138810''>to</span> <span m=''139270''>Valgrind</span>
  <span m=''139670''>your projects</span> <span m=''139935''>and</span> <span m=''140300''>look</span>
  <span m=''140480''>for</span> <span m=''140930''>memory</span> <span m=''141390''>errors.</span>
  <span m=''142610''>So</span> <span m=''143240''>do</span> <span m=''143400''>that</span>
  <span m=''143600''>to</span> <span m=''143690''>your</span> <span m=''143870''>own</span>
  <span m=''144030''>projects</span> <span m=''144640''>and</span> <span m=''145000''>investigate</span>
  <span m=''145570''>any</span> <span m=''145760''>messages</span> <span m=''146220''>you</span>
  <span m=''146330''>get.</span> </p><p><span m=''152267''>AUDIENCE: [INAUDIBLE]</span>
  </p><p><span m=''154710''>JOHN: OK.</span> <span m=''155310''>So</span> <span m=''156880''>the</span>
  <span m=''157190''>highlighted</span> <span m=''157750''>column</span> <span m=''158240''>number</span>
  <span m=''158550''>31</span> <span m=''159680''>refers</span> <span m=''160110''>to</span>
  <span m=''160230''>the</span> <span m=''160890''>reference</span> <span m=''161550''>implementation</span>
  <span m=''162300''>of</span> <span m=''162400''>the</span> <span m=''162500''>validator.</span>
  <span m=''163550''>So</span> <span m=''163800''>that''s</span> <span m=''164110''>the</span>
  <span m=''164240''>authority.</span> <span m=''165000''>If</span> <span m=''165120''>that''s</span>
  <span m=''165370''>green,</span> <span m=''165800''>then</span> <span m=''166000''>your</span>
  <span m=''166170''>implementation</span> <span m=''166800''>is</span> <span m=''166920''>correct.</span>
  <span m=''168110''>And</span> <span m=''168400''>so</span> <span m=''168930''>hopefully,</span>
  <span m=''170130''>a</span> <span m=''170440''>correct</span> <span m=''170960''>validator</span>
  <span m=''171470''>would</span> <span m=''171660''>agree</span> <span m=''172010''>with</span>
  <span m=''172340''>column</span> <span m=''172700''>31.</span> </p><p><span m=''176210''>AUDIENCE:
  [INAUDIBLE]</span> </p><p><span m=''179580''>JOHN: Yes.</span> </p><p><span m=''180560''>AUDIENCE:
  [INAUDIBLE]</span> <span m=''181862''>question.</span> <span m=''182730''>How</span>
  <span m=''183200''>can</span> <span m=''183480''>it</span> <span m=''183750''>be
  that</span> <span m=''184020''>most</span> <span m=''184360''>of--</span> <span
  m=''185120''>so</span> <span m=''185578''>an</span> <span m=''186036''>implementation</span>
  <span m=''186494''>is</span> <span m=''186952''>vertical,</span> <span m=''187410''>so</span>
  <span m=''187868''>tests</span> <span m=''188330''>are</span> <span m=''188725''>[UNINTELLIGIBLE]?</span>
  </p><p><span m=''189120''>JOHN: No.</span> <span m=''190000''>The</span> <span m=''190140''>implementations</span>
  <span m=''190595''>are</span> <span m=''191050''>horizontal,</span> <span m=''191375''>and</span>
  <span m=''191700''>the</span> <span m=''192182''>tests</span> <span m=''192664''>are
  vertical.</span> </p><p><span m=''195074''>AUDIENCE: So</span> <span m=''195556''>we</span>
  <span m=''196038''>want our</span> <span m=''196520''>column to look like</span>
  <span m=''197002''>column  31?</span> <span m=''197484''>Or we</span> <span m=''197970''>want--</span>
  </p><p><span m=''198230''>JOHN: You</span> <span m=''198490''>want--</span> <span
  m=''198670''>your</span> <span m=''199360''>validators</span> <span m=''200010''>correctness</span>
  <span m=''200520''>score</span> <span m=''200820''>will</span> <span m=''200950''>be</span>
  <span m=''201220''>determined</span> <span m=''205450''>by</span> <span m=''205570''>whether</span>
  <span m=''205830''>or</span> <span m=''205860''>not</span> <span m=''206110''>your</span>
  <span m=''206330''>column</span> <span m=''206770''>number</span> <span m=''207590''>corresponds</span>
  <span m=''208470''>with</span> <span m=''208640''>column</span> <span m=''208960''>31.</span>
  <span m=''209950''>And</span> <span m=''210150''>then,</span> <span m=''210420''>your</span>
  <span m=''210620''>implementations</span> <span m=''211570''>correctness</span>
  <span m=''212210''>will</span> <span m=''212500''>purely</span> <span m=''212960''>be</span>
  <span m=''213130''>determined</span> <span m=''213630''>by</span> <span m=''213780''>whether</span>
  <span m=''214510''>31</span> <span m=''215150''>marks</span> <span m=''215560''>your</span>
  <span m=''215780''>row</span> <span m=''216140''>red</span> <span m=''216630''>or
  green.</span> <span m=''219910''>Does</span> <span m=''220010''>that</span> <span
  m=''220120''>make</span> <span m=''220280''>sense?</span> </p><p><span m=''223955''>AUDIENCE:
  [INAUDIBLE PHRASE]</span> <span m=''225452''>columns</span> <span m=''225951''>that
  are</span> <span m=''226450''>all green,</span> <span m=''226949''>our validators
  are</span> <span m=''227448''>not</span> <span m=''227947''>[UNINTELLIGIBLE]?</span>
  <span m=''228446''>Is that what you''re saying?</span> </p><p><span m=''228950''>PROFESSOR:
  That''s</span> <span m=''229450''>right.</span> </p><p><span m=''229630''>JOHN:
  That''s</span> <span m=''229810''>correct.</span> </p><p><span m=''231500''>PROFESSOR:
  Whereas</span> <span m=''231830''>the</span> <span m=''231910''>rows</span> <span
  m=''232240''>that</span> <span m=''232340''>are</span> <span m=''232440''>green,</span>
  <span m=''233100''>that''s</span> <span m=''233310''>what</span> <span m=''233400''>we</span>
  <span m=''233500''>like</span> <span m=''233740''>to</span> <span m=''233840''>see.</span>
  <span m=''236230''>We</span> <span m=''236350''>like</span> <span m=''236560''>green</span>
  <span m=''236850''>rows.</span> <span m=''237520''>And</span> <span m=''237710''>then,</span>
  <span m=''237850''>we</span> <span m=''237970''>like</span> <span m=''238370''>columns</span>
  <span m=''238930''>that</span> <span m=''239060''>match</span> <span m=''239840''>column</span>
  <span m=''240160''>31.</span> </p><p><span m=''240950''>AUDIENCE: [INAUDIBLE PHRASE].</span>
  <span m=''244359''>The</span> <span m=''244846''>first row</span> <span m=''245333''>should
  be</span> <span m=''245820''>all red.</span> <span m=''246307''>And</span> <span
  m=''246794''>right</span> <span m=''247281''>now,</span> <span m=''247768''>[INAUDIBLE].</span>
  </p><p><span m=''250210''>JOHN: Right.</span> </p><p><span m=''250370''>PROFESSOR:
  That''s</span> <span m=''250580''>correct.</span> </p><p><span m=''251170''>JOHN:
  Whatever</span> <span m=''251710''>error</span> <span m=''252050''>this</span> <span
  m=''252430''>person</span> <span m=''252950''>had,</span> <span m=''253550''>very</span>
  <span m=''254110''>few</span> <span m=''254280''>validators</span> <span m=''254830''>seems</span>
  <span m=''255090''>to</span> <span m=''255200''>have</span> <span m=''255340''>caught</span>
  <span m=''255650''>them.</span> <span m=''256209''>Which</span> <span m=''256540''>is</span>
  <span m=''256810''>very</span> <span m=''257120''>surprising,</span> <span m=''257680''>because</span>
  <span m=''258050''>what</span> <span m=''258220''>we</span> <span m=''258360''>did</span>
  <span m=''258649''>for</span> <span m=''258810''>your</span> <span m=''258930''>validator.c</span>
  <span m=''259970''>is</span> <span m=''260130''>that</span> <span m=''260360''>we</span>
  <span m=''260620''>removed</span> <span m=''261459''>the</span> <span m=''261560''>line</span>
  <span m=''261899''>of</span> <span m=''261990''>code</span> <span m=''262690''>that</span>
  <span m=''263050''>it</span> <span m=''263220''>contained,</span> <span m=''263830''>and</span>
  <span m=''263980''>we</span> <span m=''264160''>added</span> <span m=''264470''>the</span>
  <span m=''264590''>comment</span> <span m=''265070''>that</span> <span m=''265210''>explained</span>
  <span m=''265480''>in</span> <span m=''265750''>English</span> <span m=''266220''>exactly</span>
  <span m=''266720''>what</span> <span m=''266900''>that</span> <span m=''267060''>line</span>
  <span m=''267290''>of code</span> <span m=''267720''>did.</span> <span m=''269070''>So</span>
  <span m=''269910''>it</span> <span m=''270010''>was</span> <span m=''270200''>kind</span>
  <span m=''270340''>of</span> <span m=''270490''>interesting</span> <span m=''271050''>to</span>
  <span m=''271130''>see</span> <span m=''271380''>that</span> <span m=''271710''>not</span>
  <span m=''271930''>everybody</span> <span m=''272350''>came</span> <span m=''272620''>up</span>
  <span m=''272780''>with</span> <span m=''272900''>the</span> <span m=''272970''>validator</span>
  <span m=''273530''>that''s</span> <span m=''273800''>identical</span> <span m=''274350''>to</span>
  <span m=''274520''>reference</span> <span m=''274950''>one.</span> </p><p><span
  m=''279110''>PROFESSOR: OK--</span> </p><p><span m=''279415''>JOHN:JOHN: Yeah.</span>
  <span m=''279720''>So</span> <span m=''280410''>please</span> <span m=''280650''>run</span>
  <span m=''280830''>Valgrind</span> <span m=''281020''>on your</span> <span m=''281480''>code</span>
  <span m=''281860''>before</span> <span m=''282180''>the</span> <span m=''282320''>final</span>
  <span m=''282630''>submission.</span> <span m=''283930''>And</span> <span m=''284240''>we''ll</span>
  <span m=''284420''>be</span> <span m=''284750''>posting</span> <span m=''285960''>your</span>
  <span m=''286420''>personalized</span> <span m=''287060''>results</span> <span m=''287490''>to
  your</span> <span m=''287670''>repose</span> <span m=''288170''>sometime</span>
  <span m=''288840''>probably</span> <span m=''289170''>by</span> <span m=''289310''>the</span>
  <span m=''289440''>end</span> <span m=''289570''>of</span> <span m=''289640''>the</span>
  <span m=''289720''>day,</span> <span m=''290000''>either</span> <span m=''290220''>today</span>
  <span m=''290470''>or</span> <span m=''290580''>tomorrow.</span> </p><p><span m=''293480''>PROFESSOR:
  Great.</span> <span m=''293970''>All right,</span> <span m=''294100''>you can</span>
  <span m=''294390''>take this</span> <span m=''294777''>[UNINTELLIGIBLE].</span>
  <span m=''295164''>Or you can</span> <span m=''295551''>[UNINTELLIGIBLE].</span>
  <span m=''296976''>Here</span> <span m=''297330''>you</span> <span m=''297560''>go.</span>
  <span m=''298060''>You</span> <span m=''298270''>guys</span> <span m=''298480''>can
  have</span> <span m=''298680''>it</span> <span m=''298780''>here,</span> <span m=''299270''>in
  case you</span> <span m=''299710''>need to</span> <span m=''300115''>chip in.</span>
  <span m=''305550''>OK.</span> <span m=''306930''>So</span> <span m=''307210''>today,</span>
  <span m=''307590''>we''re</span> <span m=''307740''>going</span> <span m=''307840''>to</span>
  <span m=''307920''>talk</span> <span m=''308560''>about</span> <span m=''309830''>programming</span>
  <span m=''310750''>in</span> <span m=''310900''>parallel.</span> <span m=''311960''>Parallel</span>
  <span m=''312320''>programming</span> <span m=''312820''>and</span> <span m=''312900''>so</span>
  <span m=''313090''>forth.</span> <span m=''313380''>So</span> <span m=''314400''>this</span>
  <span m=''314580''>is</span> <span m=''314720''>I''m</span> <span m=''314840''>sure</span>
  <span m=''315060''>what you''ve</span> <span m=''315340''>all</span> <span m=''315500''>been</span>
  <span m=''315620''>waiting</span> <span m=''315940''>for.</span> </p><p><span m=''316480''>Oops.</span>
  <span m=''318060''>Oh,</span> <span m=''318680''>we</span> <span m=''318780''>have</span>
  <span m=''318890''>no</span> <span m=''319020''>power</span> <span m=''319390''>here.</span>
  <span m=''320512''>There</span> <span m=''320920''>we</span> <span m=''321409''>go.</span>
  <span m=''330710''>There</span> <span m=''331180''>we</span> <span m=''331260''>go.</span>
  <span m=''333240''>Now</span> <span m=''333420''>I''ve</span> <span m=''333510''>got</span>
  <span m=''333720''>power.</span> <span m=''337170''>OK.</span> <span m=''339160''>Let''s</span>
  <span m=''339410''>see</span> <span m=''339650''>here.</span> <span m=''342070''>How''s</span>
  <span m=''342240''>that?</span> <span m=''342420''>Good.</span> <span m=''342890''>OK.</span>
  <span m=''343800''>So</span> <span m=''343950''>we</span> <span m=''344030''>talk</span>
  <span m=''344210''>about</span> <span m=''344450''>multicore</span> <span m=''345000''>programming.</span>
  <span m=''346650''>And</span> <span m=''350580''>let</span> <span m=''350710''>me</span>
  <span m=''350800''>start</span> <span m=''351150''>with</span> <span m=''351260''>a</span>
  <span m=''351280''>little</span> <span m=''351560''>bit</span> <span m=''351720''>of</span>
  <span m=''352730''>history.</span> </p><p><span m=''357690''>So</span> <span m=''359490''>since</span>
  <span m=''359890''>the</span> <span m=''359990''>mid</span> <span m=''361100''>to</span>
  <span m=''361240''>late</span> <span m=''361570''>1960s--</span> <span m=''363890''>so</span>
  <span m=''364000''>how</span> <span m=''364110''>many</span> <span m=''364260''>years</span>
  <span m=''364540''>is</span> <span m=''364660''>that?</span> <span m=''366420''>50</span>
  <span m=''366810''>years.</span> <span m=''367270''>Wow.</span> <span m=''371230''>Semiconductor</span>
  <span m=''372540''>density</span> <span m=''373680''>has</span> <span m=''374030''>been</span>
  <span m=''374320''>increasing</span> <span m=''375650''>at</span> <span m=''375850''>the</span>
  <span m=''375940''>rate</span> <span m=''376330''>of</span> <span m=''376440''>about--</span>
  <span m=''377812''>it''s</span> <span m=''378160''>been</span> <span m=''378320''>doubling</span>
  <span m=''378750''>about</span> <span m=''379030''>every</span> <span m=''379350''>18</span>
  <span m=''379970''>to</span> <span m=''380060''>24</span> <span m=''380620''>months.</span>
  </p><p><span m=''382510''>OK.</span> <span m=''382790''>So</span> <span m=''382960''>every</span>
  <span m=''386130''>year,</span> <span m=''388700''>every</span> <span m=''389770''>one</span>
  <span m=''390000''>to</span> <span m=''390100''>two</span> <span m=''390270''>years,</span>
  <span m=''391000''>every</span> <span m=''393830''>year</span> <span m=''393990''>and</span>
  <span m=''394070''>a</span> <span m=''394100''>half</span> <span m=''394350''>to</span>
  <span m=''394490''>two</span> <span m=''394640''>years,</span> <span m=''395710''>we</span>
  <span m=''395840''>get</span> <span m=''396280''>a</span> <span m=''396540''>doubling</span>
  <span m=''397180''>of</span> <span m=''397280''>density</span> <span m=''398520''>on</span>
  <span m=''398750''>the</span> <span m=''398850''>chips.</span> <span m=''400410''>And</span>
  <span m=''401130''>that''s</span> <span m=''401600''>a</span> <span m=''401670''>trend</span>
  <span m=''402040''>that</span> <span m=''402240''>still</span> <span m=''402630''>is</span>
  <span m=''402780''>continuing.</span> <span m=''404220''>OK.</span> <span m=''404480''>So</span>
  <span m=''404620''>that''s</span> <span m=''404860''>called</span> <span m=''405110''>Moore''s</span>
  <span m=''405500''>law,</span> <span m=''406250''>the</span> <span m=''406460''>doubling</span>
  <span m=''406920''>of</span> <span m=''407090''>density</span> <span m=''407560''>of</span>
  <span m=''407620''>integrated</span> <span m=''408070''>circuits.</span> </p><p><span
  m=''408940''>And</span> <span m=''409090''>so,</span> <span m=''409230''>this</span>
  <span m=''409420''>is</span> <span m=''409580''>basically</span> <span m=''410160''>a</span>
  <span m=''410310''>curve</span> <span m=''410670''>showing</span> <span m=''412730''>how</span>
  <span m=''413180''>transistor</span> <span m=''413890''>count</span> <span m=''414250''>is</span>
  <span m=''414430''>rising.</span> <span m=''416110''>OK.</span> <span m=''416550''>So</span>
  <span m=''416760''>all</span> <span m=''416910''>these</span> <span m=''417120''>green</span>
  <span m=''417370''>things</span> <span m=''418420''>are</span> <span m=''419480''>Intel</span>
  <span m=''420580''>CPUs</span> <span m=''420730''>and</span> <span m=''420850''>what</span>
  <span m=''421000''>the</span> <span m=''421060''>transistor</span> <span m=''421680''>count</span>
  <span m=''421940''>is</span> <span m=''422200''>on</span> <span m=''422400''>them.</span>
  <span m=''423460''>Yeah,</span> <span m=''423770''>question?</span> </p><p><span
  m=''424350''>AUDIENCE: [INAUDIBLE PHRASE]</span> <span m=''426210''>the</span> <span
  m=''426675''>lines</span> <span m=''427140''>in</span> <span m=''427605''>[INAUDIBLE]?</span>
  </p><p><span m=''430120''>PROFESSOR: So there</span> <span m=''430466''>have</span>
  <span m=''430812''>been</span> <span m=''431160''>some</span> <span m=''431500''>technology</span>
  <span m=''432150''>changes</span> <span m=''432610''>along</span> <span m=''432950''>the</span>
  <span m=''433030''>way.</span> <span m=''434550''>So</span> <span m=''435300''>in</span>
  <span m=''435460''>particular,</span> <span m=''438100''>the</span> <span m=''438310''>[UNINTELLIGIBLE]</span>
  <span m=''438730''>transition</span> <span m=''439130''>is</span> <span m=''439530''>back</span>
  <span m=''439840''>down</span> <span m=''440030''>here</span> <span m=''440340''>I</span>
  <span m=''440390''>think.</span> <span m=''441800''>I</span> <span m=''441930''>don''t</span>
  <span m=''442090''>remember</span> <span m=''442480''>which</span> <span m=''442670''>one</span>
  <span m=''442840''>that</span> <span m=''443020''>is.</span> <span m=''444812''>Well,</span>
  <span m=''445550''>this</span> <span m=''445740''>is</span> <span m=''445890''>actually</span>
  <span m=''446160''>a</span> <span m=''446200''>different</span> <span m=''446480''>one.</span>
  <span m=''446590''>What</span> <span m=''446770''>we''re</span> <span m=''446910''>looking</span>
  <span m=''447230''>at</span> <span m=''447360''>right</span> <span m=''447560''>now</span>
  <span m=''447780''>is</span> <span m=''447970''>the</span> <span m=''448170''>transistors,</span>
  <span m=''448870''>which</span> <span m=''449050''>have</span> <span m=''449090''>been</span>
  <span m=''449740''>very</span> <span m=''449980''>smooth.</span> <span m=''451590''>OK.</span>
  <span m=''452180''>So</span> <span m=''452730''>I''ll</span> <span m=''452870''>explain</span>
  <span m=''453260''>this</span> <span m=''453440''>curve</span> <span m=''453720''>in</span>
  <span m=''453800''>a</span> <span m=''453840''>minute.</span> </p><p><span m=''454090''>So</span>
  <span m=''454230''>there''s</span> <span m=''454400''>two</span> <span m=''455060''>things</span>
  <span m=''455370''>plotted</span> <span m=''455880''>on</span> <span m=''456040''>here.</span>
  <span m=''456330''>One</span> <span m=''456580''>is</span> <span m=''456970''>the</span>
  <span m=''457130''>Intel</span> <span m=''457480''>CPU</span> <span m=''460010''>density,</span>
  <span m=''460880''>and</span> <span m=''461110''>the</span> <span m=''461220''>other</span>
  <span m=''461490''>is</span> <span m=''461720''>what</span> <span m=''461920''>the</span>
  <span m=''462000''>clock</span> <span m=''462390''>speed</span> <span m=''462770''>of</span>
  <span m=''462890''>those</span> <span m=''463160''>processes</span> <span m=''463820''>is.</span>
  <span m=''465090''>And</span> <span m=''465210''>so</span> <span m=''465320''>these</span>
  <span m=''465590''>are</span> <span m=''465620''>the</span> <span m=''465740''>clock</span>
  <span m=''466080''>speed</span> <span m=''466390''>numbers.</span> <span m=''468450''>And</span>
  <span m=''468600''>so,</span> <span m=''469810''>the</span> <span m=''470130''>integrated</span>
  <span m=''470500''>circuit</span> <span m=''470830''>technology</span> <span m=''472180''>has</span>
  <span m=''472490''>been--</span> <span m=''474890''>the</span> <span m=''475100''>density</span>
  <span m=''475490''>has</span> <span m=''475640''>been</span> <span m=''475840''>doubling.</span>
  <span m=''476430''>And</span> <span m=''476610''>it''s</span> <span m=''476800''>really</span>
  <span m=''477210''>an</span> <span m=''478770''>unbelievable</span> <span m=''479520''>sort</span>
  <span m=''479730''>of</span> <span m=''479810''>social</span> <span m=''480400''>and</span>
  <span m=''480540''>economic</span> <span m=''482790''>process,</span> <span m=''483410''>that</span>
  <span m=''483610''>this</span> <span m=''483830''>has</span> <span m=''483980''>basically</span>
  <span m=''484460''>been</span> <span m=''484630''>called</span> <span m=''484910''>a</span>
  <span m=''484990''>law.</span> </p><p><span m=''486790''>Because</span> <span m=''487240''>what</span>
  <span m=''487360''>happens</span> <span m=''487890''>is</span> <span m=''488866''>if</span>
  <span m=''489352''>a--</span> <span m=''491470''>there''s</span> <span m=''491750''>so</span>
  <span m=''491940''>many</span> <span m=''492150''>people</span> <span m=''492440''>that</span>
  <span m=''492530''>contribute</span> <span m=''493220''>to</span> <span m=''493350''>making</span>
  <span m=''494020''>integrated</span> <span m=''494540''>circuits</span> <span m=''495460''>be
  dense.</span> <span m=''495880''>There''s</span> <span m=''495980''>so</span> <span
  m=''496160''>many</span> <span m=''496340''>pieces</span> <span m=''496740''>of</span>
  <span m=''496850''>technology</span> <span m=''497570''>that</span> <span m=''497670''>go</span>
  <span m=''497890''>into</span> <span m=''498110''>that.</span> <span m=''498970''>And</span>
  <span m=''499100''>what</span> <span m=''499220''>happens</span> <span m=''499660''>is</span>
  <span m=''499900''>if</span> <span m=''500060''>you</span> <span m=''500290''>decide</span>
  <span m=''500880''>that</span> <span m=''501020''>you''re</span> <span m=''501180''>going</span>
  <span m=''501290''>to</span> <span m=''501360''>try</span> <span m=''501610''>to</span>
  <span m=''501740''>jump</span> <span m=''502220''>and</span> <span m=''502420''>try</span>
  <span m=''502680''>to</span> <span m=''502790''>make</span> <span m=''503640''>something</span>
  <span m=''504070''>that</span> <span m=''504190''>goes</span> <span m=''504450''>faster</span>
  <span m=''504980''>than</span> <span m=''505130''>Moore''s</span> <span m=''505530''>law,</span>
  <span m=''506250''>what</span> <span m=''506420''>happens</span> <span m=''506810''>is</span>
  <span m=''507450''>it''s</span> <span m=''507670''>more</span> <span m=''507850''>expensive</span>
  <span m=''508490''>for</span> <span m=''508610''>you</span> <span m=''508750''>to</span>
  <span m=''508840''>do</span> <span m=''509110''>it.</span> <span m=''509440''>And</span>
  <span m=''509650''>none</span> <span m=''510210''>of</span> <span m=''510270''>the</span>
  <span m=''510420''>other</span> <span m=''511370''>participants</span> <span m=''512159''>in</span>
  <span m=''512250''>that</span> <span m=''512429''>economy</span> <span m=''513860''>can</span>
  <span m=''514030''>keep</span> <span m=''514280''>up.</span> <span m=''514500''>And</span>
  <span m=''514620''>you''re</span> <span m=''514750''>just</span> <span m=''514950''>going</span>
  <span m=''515039''>to</span> <span m=''515090''>be</span> <span m=''515210''>more</span>
  <span m=''515440''>expensive.</span> <span m=''516100''>So</span> <span m=''516270''>people</span>
  <span m=''516650''>will op for</span> <span m=''517080''>the</span> <span m=''517230''>cheapest</span>
  <span m=''517690''>thing</span> <span m=''517900''>that</span> <span m=''518120''>gets</span>
  <span m=''520690''>the</span> <span m=''521159''>factor</span> <span m=''521610''>of</span>
  <span m=''521740''>two</span> <span m=''522010''>every</span> <span m=''522520''>18</span>
  <span m=''523049''>to</span> <span m=''523450''>24</span> <span m=''523970''>months.</span>
  </p><p><span m=''525730''>Whereas</span> <span m=''526000''>if</span> <span m=''526110''>you''re</span>
  <span m=''526290''>behind,</span> <span m=''527930''>then</span> <span m=''528340''>nobody</span>
  <span m=''529110''>uses</span> <span m=''530480''>your</span> <span m=''530700''>stuff.</span>
  <span m=''531020''>So</span> <span m=''531150''>everybody''s</span> <span m=''531860''>got</span>
  <span m=''532180''>this</span> <span m=''532740''>sort</span> <span m=''532930''>of</span>
  <span m=''533050''>self-fulfilling</span> <span m=''534310''>prophecy</span> <span
  m=''535790''>that</span> <span m=''535990''>the</span> <span m=''536080''>rate</span>
  <span m=''536540''>at</span> <span m=''536770''>which</span> <span m=''537150''>the</span>
  <span m=''537270''>density</span> <span m=''537790''>is</span> <span m=''537920''>increasing</span>
  <span m=''539120''>has</span> <span m=''539360''>just</span> <span m=''539610''>been</span>
  <span m=''540470''>extremely</span> <span m=''541000''>stable</span> <span m=''541490''>for</span>
  <span m=''541720''>over</span> <span m=''541940''>50</span> <span m=''542320''>years.</span>
  <span m=''543190''>It''s</span> <span m=''543360''>remarkable.</span> <span m=''544180''>Yeah,</span>
  <span m=''544400''>question?</span> </p><p><span m=''545544''>AUDIENCE: [INAUDIBLE
  PHRASE]</span> <span m=''549234''>every</span> <span m=''549705''>six</span> <span
  m=''550176''>months.</span> <span m=''551118''>And</span> <span m=''551589''>somehow,</span>
  <span m=''552060''>[INAUDIBLE]</span> <span m=''553473''>you would</span> <span
  m=''553944''>have</span> <span m=''554415''>self-replicated?</span> </p><p><span
  m=''555360''>PROFESSOR: No,</span> <span m=''555660''>I''m</span> <span m=''555790''>not</span>
  <span m=''555930''>saying</span> <span m=''556250''>that.</span> <span m=''556500''>What</span>
  <span m=''556600''>I''m</span> <span m=''556700''>saying</span> <span m=''557100''>is</span>
  <span m=''558040''>that</span> <span m=''558280''>there</span> <span m=''558420''>is</span>
  <span m=''558700''>some</span> <span m=''558950''>amount</span> <span m=''559370''>of</span>
  <span m=''561670''>everybody</span> <span m=''562230''>expecting</span> <span m=''562990''>that</span>
  <span m=''563170''>this</span> <span m=''563350''>is</span> <span m=''563520''>the</span>
  <span m=''563610''>point</span> <span m=''564030''>that</span> <span m=''564140''>everybody''s</span>
  <span m=''564680''>going</span> <span m=''564800''>to</span> <span m=''564850''>be</span>
  <span m=''565130''>at.</span> <span m=''565990''>And</span> <span m=''566140''>so</span>
  <span m=''566320''>if</span> <span m=''566610''>you</span> <span m=''568340''>try</span>
  <span m=''568520''>to</span> <span m=''568590''>go</span> <span m=''569040''>more</span>
  <span m=''569290''>aggressively</span> <span m=''569970''>than</span> <span m=''570150''>that,</span>
  <span m=''570560''>you</span> <span m=''570720''>can</span> <span m=''570880''>get</span>
  <span m=''571020''>burned</span> <span m=''571390''>because</span> <span m=''571640''>you''ll</span>
  <span m=''571760''>be</span> <span m=''571890''>more</span> <span m=''572090''>expensive.</span>
  </p><p><span m=''573690''>If you</span> <span m=''573870''>don''t</span> <span m=''574140''>go</span>
  <span m=''574340''>that</span> <span m=''574610''>fast,</span> <span m=''575210''>you''re</span>
  <span m=''575340''>going</span> <span m=''575430''>to</span> <span m=''575470''>get</span>
  <span m=''575650''>burned</span> <span m=''575860''>because</span> <span m=''576030''>nobody''s</span>
  <span m=''576300''>going</span> <span m=''576370''>to</span> <span m=''576440''>adopt</span>
  <span m=''576830''>your</span> <span m=''577040''>particular</span> <span m=''578080''>piece</span>
  <span m=''578320''>of</span> <span m=''578390''>the</span> <span m=''578490''>technology.</span>
  <span m=''579960''>And</span> <span m=''580110''>so,</span> <span m=''580250''>what</span>
  <span m=''580380''>happens</span> <span m=''580930''>is</span> <span m=''581200''>everybody</span>
  <span m=''581700''>sort</span> <span m=''581880''>of</span> <span m=''581940''>settles</span>
  <span m=''583130''>for</span> <span m=''583500''>this</span> <span m=''584690''>regular</span>
  <span m=''585560''>repeating.</span> <span m=''586270''>It''s</span> <span m=''586520''>a</span>
  <span m=''586790''>remarkable</span> <span m=''587560''>social</span> <span m=''588010''>and</span>
  <span m=''588080''>economic</span> <span m=''588560''>phenomenon.</span> </p><p><span
  m=''590540''>It''s</span> <span m=''590810''>got</span> <span m=''591030''>very</span>
  <span m=''591260''>little</span> <span m=''591540''>to do</span> <span m=''591790''>at</span>
  <span m=''591900''>some</span> <span m=''592170''>level</span> <span m=''592480''>of</span>
  <span m=''592590''>technology.</span> <span m=''593320''>It''s</span> <span m=''593490''>just</span>
  <span m=''593730''>that</span> <span m=''593910''>we</span> <span m=''594060''>know</span>
  <span m=''594390''>that</span> <span m=''594530''>we</span> <span m=''594660''>can</span>
  <span m=''594800''>improve</span> <span m=''595310''>things.</span> <span m=''596530''>But</span>
  <span m=''596970''>what''s</span> <span m=''597220''>amazing</span> <span m=''597750''>is</span>
  <span m=''597860''>this</span> <span m=''598040''>growth</span> <span m=''598290''>has</span>
  <span m=''598430''>gone</span> <span m=''598630''>through</span> <span m=''598760''>many</span>
  <span m=''599060''>transitions.</span> <span m=''601360''>At</span> <span m=''601470''>one</span>
  <span m=''601710''>point,</span> <span m=''601950''>they</span> <span m=''602080''>said</span>
  <span m=''602280''>we</span> <span m=''602470''>aren''t</span> <span m=''602610''>going</span>
  <span m=''602730''>to</span> <span m=''602770''>be</span> <span m=''602910''>able</span>
  <span m=''603050''>to</span> <span m=''603120''>build</span> <span m=''604450''>integrated</span>
  <span m=''604920''>circuits</span> <span m=''605360''>any</span> <span m=''605610''>more</span>
  <span m=''606260''>densely</span> <span m=''607510''>because</span> <span m=''608160''>all</span>
  <span m=''608560''>of</span> <span m=''608680''>the</span> <span m=''609060''>masks</span>
  <span m=''609660''>that</span> <span m=''609780''>were</span> <span m=''609940''>made--</span>
  <span m=''611190''>it''s</span> <span m=''611380''>basically,</span> <span m=''611790''>you</span>
  <span m=''611880''>make</span> <span m=''612290''>computers</span> <span m=''613080''>with</span>
  <span m=''613200''>a</span> <span m=''613240''>photographic</span> <span m=''613970''>process</span>
  <span m=''615380''>of</span> <span m=''615490''>exposing</span> <span m=''616400''>and</span>
  <span m=''617620''>using</span> <span m=''619140''>masks</span> <span m=''619950''>that</span>
  <span m=''620110''>you</span> <span m=''620260''>shine</span> <span m=''620600''>light</span>
  <span m=''620900''>through.</span> <span m=''622000''>It''s</span> <span m=''622230''>the</span>
  <span m=''622320''>way</span> <span m=''622480''>they</span> <span m=''622590''>used</span>
  <span m=''622760''>to</span> <span m=''622930''>do</span> <span m=''623100''>it.</span>
  </p><p><span m=''623610''>And</span> <span m=''623780''>what</span> <span m=''623890''>happened</span>
  <span m=''624260''>was</span> <span m=''624670''>the</span> <span m=''624760''>wave</span>
  <span m=''625030''>lengths</span> <span m=''625450''>of</span> <span m=''625630''>light</span>
  <span m=''625970''>were</span> <span m=''626080''>such</span> <span m=''626360''>that</span>
  <span m=''626480''>you</span> <span m=''626570''>were</span> <span m=''626680''>just</span>
  <span m=''626860''>simply</span> <span m=''627130''>not</span> <span m=''627320''>going</span>
  <span m=''627420''>to</span> <span m=''627460''>be</span> <span m=''627580''>able</span>
  <span m=''627700''>to</span> <span m=''627750''>get</span> <span m=''627940''>the</span>
  <span m=''628020''>resolutions.</span> <span m=''629070''>So</span> <span m=''629250''>what</span>
  <span m=''629340''>did</span> <span m=''629390''>they</span> <span m=''629530''>do?</span>
  <span m=''629680''>They</span> <span m=''629820''>switched</span> <span m=''630190''>to</span>
  <span m=''630910''>eBeams.</span> <span m=''632160''>OK.</span> <span m=''632430''>Electrons</span>
  <span m=''633160''>rather</span> <span m=''633520''>than</span> <span m=''633920''>photons</span>
  <span m=''634750''>to</span> <span m=''634890''>expose</span> <span m=''637140''>the</span>
  <span m=''637290''>silicon</span> <span m=''637700''>wafers</span> <span m=''638180''>and</span>
  <span m=''638330''>so</span> <span m=''638510''>forth.</span> </p><p><span m=''639100''>And</span>
  <span m=''639260''>so,</span> <span m=''639670''>they''ve</span> <span m=''639850''>gone</span>
  <span m=''640090''>through</span> <span m=''640200''>a</span> <span m=''640270''>whole</span>
  <span m=''640520''>bunch</span> <span m=''640750''>of</span> <span m=''640830''>transitions</span>
  <span m=''641990''>and</span> <span m=''642120''>different</span> <span m=''642360''>technologies.</span>
  <span m=''642910''>And</span> <span m=''643320''>yet,</span> <span m=''644030''>throughout</span>
  <span m=''644460''>all</span> <span m=''644720''>of</span> <span m=''644800''>that,</span>
  <span m=''645180''>it''s</span> <span m=''645370''>been</span> <span m=''645500''>just</span>
  <span m=''646600''>a</span> <span m=''646620''>very</span> <span m=''647020''>steady</span>
  <span m=''647500''>progress</span> <span m=''647800''>at</span> <span m=''648100''>about</span>
  <span m=''648540''>the</span> <span m=''648610''>rate</span> <span m=''648920''>of</span>
  <span m=''649090''>18</span> <span m=''649490''>to</span> <span m=''649570''>24</span>
  <span m=''650080''>months</span> <span m=''651010''>per</span> <span m=''651630''>doubling</span>
  <span m=''652140''>of</span> <span m=''652220''>density.</span> <span m=''653240''>And</span>
  <span m=''653440''>that</span> <span m=''653790''>is</span> <span m=''654010''>still</span>
  <span m=''654280''>going</span> <span m=''654600''>on,</span> <span m=''655040''>and</span>
  <span m=''655190''>is</span> <span m=''655340''>projected</span> <span m=''655870''>to</span>
  <span m=''655930''>go</span> <span m=''656210''>on</span> <span m=''656530''>maybe</span>
  <span m=''657160''>for</span> <span m=''658490''>10</span> <span m=''658750''>years</span>
  <span m=''659330''>more.</span> </p><p><span m=''659980''>It''s</span> <span m=''660140''>going</span>
  <span m=''660230''>to</span> <span m=''660320''>run</span> <span m=''660560''>out,</span>
  <span m=''661990''>I</span> <span m=''662110''>hope</span> <span m=''662360''>in</span>
  <span m=''662470''>my</span> <span m=''662640''>lifetime.</span> <span m=''666000''>And</span>
  <span m=''666330''>certainly</span> <span m=''668960''>within</span> <span m=''669320''>your</span>
  <span m=''669480''>lifetimes.</span> <span m=''670680''>So</span> <span m=''671830''>that</span>
  <span m=''672060''>has</span> <span m=''672230''>been</span> <span m=''672390''>going.</span>
  <span m=''672710''>Then,</span> <span m=''672890''>there''s</span> <span m=''673180''>second</span>
  <span m=''673700''>phenomenon</span> <span m=''674290''>that</span> <span m=''674410''>has</span>
  <span m=''674580''>been</span> <span m=''674740''>going</span> <span m=''675080''>on</span>
  <span m=''678020''>since</span> <span m=''678410''>about</span> <span m=''680210''>mid-1980s.</span>
  <span m=''682200''>And</span> <span m=''682400''>that</span> <span m=''682660''>is</span>
  <span m=''683120''>that</span> <span m=''684370''>the</span> <span m=''684880''>clock</span>
  <span m=''685340''>speed</span> <span m=''685730''>has</span> <span m=''685900''>actually</span>
  <span m=''686250''>been</span> <span m=''686450''>growing</span> <span m=''686910''>on</span>
  <span m=''687070''>a</span> <span m=''687170''>similar</span> <span m=''687650''>curve,</span>
  <span m=''689300''>where</span> <span m=''689790''>basically,</span> <span m=''690320''>we''ve</span>
  <span m=''690530''>been</span> <span m=''690730''>getting</span> <span m=''691480''>30%</span>
  <span m=''692260''>faster</span> <span m=''697320''>processors,</span> <span m=''698230''>clock</span>
  <span m=''698540''>speed,</span> <span m=''700450''>since</span> <span m=''700800''>the</span>
  <span m=''700880''>mid-1980s.</span> </p><p><span m=''702210''>But</span> <span
  m=''702390''>something</span> <span m=''702700''>happened</span> <span m=''703230''>there,</span>
  <span m=''703510''>which</span> <span m=''703750''>was</span> <span m=''704270''>in</span>
  <span m=''704730''>around</span> <span m=''705190''>2003,</span> <span m=''706970''>it</span>
  <span m=''707140''>flattened</span> <span m=''707620''>out.</span> <span m=''711370''>And</span>
  <span m=''711550''>the</span> <span m=''711640''>reason</span> <span m=''712090''>is,</span>
  <span m=''714820''>as</span> <span m=''715010''>a</span> <span m=''715200''>practical</span>
  <span m=''715770''>matter,</span> <span m=''716300''>clock</span> <span m=''716700''>speed</span>
  <span m=''717320''>for</span> <span m=''717550''>air</span> <span m=''717860''>cooled</span>
  <span m=''718270''>systems</span> <span m=''718940''>is</span> <span m=''719350''>bounded</span>
  <span m=''719810''>at</span> <span m=''719950''>somewhere</span> <span m=''720430''>around</span>
  <span m=''720730''>5 gigahertz.</span> <span m=''721730''>If</span> <span m=''722080''>you</span>
  <span m=''722180''>want</span> <span m=''722310''>to</span> <span m=''722450''>liquid</span>
  <span m=''722900''>cool</span> <span m=''723300''>it</span> <span m=''723620''>or</span>
  <span m=''723780''>nitrogen</span> <span m=''724470''>cool</span> <span m=''724850''>it</span>
  <span m=''727360''>or</span> <span m=''727450''>something,</span> <span m=''727800''>you</span>
  <span m=''727950''>could</span> <span m=''728110''>make</span> <span m=''728340''>it</span>
  <span m=''728450''>go</span> <span m=''728620''>faster.</span> </p><p><span m=''729500''>But</span>
  <span m=''729680''>basically,</span> <span m=''730290''>the</span> <span m=''730390''>problem</span>
  <span m=''730980''>is</span> <span m=''731670''>that</span> <span m=''733180''>things</span>
  <span m=''733490''>get</span> <span m=''733740''>too</span> <span m=''733960''>hot.</span>
  <span m=''735240''>And</span> <span m=''735410''>they</span> <span m=''735540''>cannot</span>
  <span m=''736120''>convey</span> <span m=''736640''>the</span> <span m=''736730''>heat</span>
  <span m=''737330''>out.</span> <span m=''738000''>So</span> <span m=''738350''>for</span>
  <span m=''738500''>a</span> <span m=''738550''>while,</span> <span m=''739020''>if</span>
  <span m=''739110''>you</span> <span m=''739230''>have</span> <span m=''739380''>greater</span>
  <span m=''740070''>density,</span> <span m=''740560''>the</span> <span m=''740680''>transistors</span>
  <span m=''741340''>get</span> <span m=''741530''>smaller.</span> <span m=''742010''>They</span>
  <span m=''742180''>switch</span> <span m=''742540''>faster.</span> <span m=''743460''>And</span>
  <span m=''743570''>you</span> <span m=''743660''>can</span> <span m=''743790''>make</span>
  <span m=''744000''>the</span> <span m=''744080''>clock</span> <span m=''744450''>speed</span>
  <span m=''744760''>go</span> <span m=''744910''>faster.</span> <span m=''746030''>But</span>
  <span m=''746260''>at</span> <span m=''746370''>some</span> <span m=''746610''>point,</span>
  <span m=''746920''>they</span> <span m=''747060''>hit</span> <span m=''747340''>the</span>
  <span m=''747420''>wall.</span> </p><p><span m=''748710''>And</span> <span m=''748890''>so</span>
  <span m=''749080''>there</span> <span m=''749290''>the</span> <span m=''749410''>vendors</span>
  <span m=''749900''>were.</span> <span m=''750790''>People</span> <span m=''751060''>like</span>
  <span m=''751270''>Intel,</span> <span m=''752050''>AMD,</span> <span m=''753200''>Motorola.</span>
  <span m=''755150''>A</span> <span m=''755230''>variety</span> <span m=''755700''>of</span>
  <span m=''755770''>the</span> <span m=''755850''>semiconductor</span> <span m=''756480''>manufacturers.</span>
  <span m=''757350''>And</span> <span m=''757560''>what''s</span> <span m=''757780''>happened</span>
  <span m=''758230''>is</span> <span m=''758780''>they</span> <span m=''759020''>can</span>
  <span m=''759210''>still</span> <span m=''759600''>make</span> <span m=''761390''>integrated</span>
  <span m=''761860''>circuits</span> <span m=''762320''>more</span> <span m=''762690''>and</span>
  <span m=''762800''>more</span> <span m=''763030''>dense.</span> <span m=''764340''>But</span>
  <span m=''764490''>they</span> <span m=''764610''>can''t</span> <span m=''764930''>clock</span>
  <span m=''765300''>them</span> <span m=''765440''>any</span> <span m=''765610''>faster.</span>
  <span m=''767820''>OK.</span> </p><p><span m=''769460''>So</span> <span m=''769660''>here''s</span>
  <span m=''771460''>what''s</span> <span m=''771870''>going</span> <span m=''772120''>on</span>
  <span m=''772380''>in</span> <span m=''772560''>the</span> <span m=''772890''>circuits.</span>
  <span m=''773230''>So</span> <span m=''773370''>here''s</span> <span m=''773840''>essentially</span>
  <span m=''775370''>how</span> <span m=''775550''>much</span> <span m=''775790''>power</span>
  <span m=''776660''>was</span> <span m=''777110''>being</span> <span m=''777320''>dissipated</span>
  <span m=''777920''>by</span> <span m=''778150''>a</span> <span m=''778210''>variety</span>
  <span m=''778860''>of</span> <span m=''779260''>Intel</span> <span m=''779730''>processors</span>
  <span m=''780430''>along</span> <span m=''780760''>the</span> <span m=''780850''>way,</span>
  <span m=''781710''>and</span> <span m=''781790''>what they</span> <span m=''781960''>[INAUDIBLE]</span>
  <span m=''782280''>2000.</span> <span m=''783910''>They</span> <span m=''784080''>started</span>
  <span m=''784150''>getting</span> <span m=''784450''>hot</span> <span m=''784830''>and</span>
  <span m=''784980''>hotter,</span> <span m=''785910''>until</span> <span m=''786440''>if</span>
  <span m=''786590''>they</span> <span m=''786800''>just</span> <span m=''787020''>continued</span>
  <span m=''787520''>this</span> <span m=''787800''>trend,</span> <span m=''790860''>they</span>
  <span m=''791230''>were</span> <span m=''791370''>going</span> <span m=''791500''>to</span>
  <span m=''791580''>be</span> <span m=''792130''>trying</span> <span m=''792620''>to</span>
  <span m=''795610''>have</span> <span m=''795750''>junction</span> <span m=''796140''>temperatures</span>
  <span m=''796590''>that</span> <span m=''796700''>are as</span> <span m=''796820''>hot</span>
  <span m=''797120''>as</span> <span m=''797230''>the</span> <span m=''797340''>surface</span>
  <span m=''797720''>of</span> <span m=''797770''>the</span> <span m=''797830''>sun.</span>
  </p><p><span m=''799500''>Well,</span> <span m=''800240''>they</span> <span m=''800650''>clearly</span>
  <span m=''801010''>couldn''t</span> <span m=''801290''>do</span> <span m=''801410''>that.</span>
  <span m=''802140''>OK.</span> <span m=''802900''>So</span> <span m=''803230''>you</span>
  <span m=''803360''>might</span> <span m=''803590''>say,</span> <span m=''803710''>well,</span>
  <span m=''803970''>let''s</span> <span m=''804200''>put</span> <span m=''804360''>it</span>
  <span m=''804450''>off</span> <span m=''804710''>a</span> <span m=''804790''>few</span>
  <span m=''805080''>years.</span> <span m=''805590''>Yeah,</span> <span m=''805990''>but</span>
  <span m=''806510''>how</span> <span m=''806700''>many</span> <span m=''806900''>years
  are you</span> <span m=''807290''>going</span> <span m=''807390''>to</span> <span
  m=''807440''>put</span> <span m=''807650''>this</span> <span m=''807860''>off?</span>
  <span m=''808200''>And</span> <span m=''808360''>so,</span> <span m=''808610''>what</span>
  <span m=''808790''>happened</span> <span m=''809160''>was</span> <span m=''809750''>they</span>
  <span m=''809890''>got</span> <span m=''810120''>stuck.</span> <span m=''810920''>They</span>
  <span m=''811190''>simply</span> <span m=''811620''>could</span> <span m=''811820''>not</span>
  <span m=''812510''>make</span> <span m=''814010''>chips</span> <span m=''814690''>get</span>
  <span m=''814890''>clocked</span> <span m=''815165''>in</span> <span m=''815440''>faster.</span>
  </p><p><span m=''817620''>So</span> <span m=''817810''>what</span> <span m=''818000''>did</span>
  <span m=''818140''>they</span> <span m=''818310''>decide</span> <span m=''818800''>to</span>
  <span m=''818900''>do?</span> <span m=''819370''>They</span> <span m=''819470''>got</span>
  <span m=''819690''>all</span> <span m=''820010''>the</span> <span m=''820100''>silicon</span>
  <span m=''820630''>area,</span> <span m=''822120''>but</span> <span m=''822280''>they</span>
  <span m=''822430''>can''t</span> <span m=''822790''>make</span> <span m=''823040''>the</span>
  <span m=''823110''>processors</span> <span m=''823830''>faster</span> <span m=''824330''>with</span>
  <span m=''824520''>it.</span> <span m=''825810''>So</span> <span m=''825980''>their</span>
  <span m=''826200''>solution</span> <span m=''827350''>was</span> <span m=''828950''>to</span>
  <span m=''829330''>scale</span> <span m=''829780''>performance</span> <span m=''831070''>to</span>
  <span m=''831200''>put</span> <span m=''831420''>many</span> <span m=''831720''>processing</span>
  <span m=''832410''>cores</span> <span m=''832950''>on</span> <span m=''833030''>the</span>
  <span m=''833110''>microprocessor</span> <span m=''834040''>chip.</span> </p><p><span
  m=''835130''>So</span> <span m=''835290''>this</span> <span m=''835480''>is</span>
  <span m=''835680''>an</span> <span m=''835930''>example</span> <span m=''836280''>of
  a</span> <span m=''836400''>Core</span> <span m=''836770''>i7.</span> <span m=''837895''>It''s</span>
  <span m=''838270''>a four</span> <span m=''838550''>core.</span> <span m=''838780''>One,</span>
  <span m=''839090''>two, three,</span> <span m=''839400''>four</span> <span m=''839705''>cores</span>
  <span m=''841730''>processor.</span> <span m=''842180''>We</span> <span m=''842320''>actually
  have</span> <span m=''842580''>six</span> <span m=''842920''>core</span> <span m=''843150''>machines</span>
  <span m=''843670''>now.</span> <span m=''844020''>But</span> <span m=''844220''>I</span>
  <span m=''844370''>didn''t</span> <span m=''844520''>update</span> <span m=''845070''>the</span>
  <span m=''846080''>figure.</span> </p><p><span m=''848290''>And</span> <span m=''849680''>what''s</span>
  <span m=''849910''>going</span> <span m=''849990''>to</span> <span m=''850070''>happen</span>
  <span m=''850480''>now</span> <span m=''850700''>is</span> <span m=''850800''>Moore''s</span>
  <span m=''851170''>law</span> <span m=''851420''>is</span> <span m=''851510''>going</span>
  <span m=''851600''>to</span> <span m=''851700''>continue</span> <span m=''852200''>for</span>
  <span m=''852380''>a</span> <span m=''852420''>few</span> <span m=''852640''>more</span>
  <span m=''852860''>years.</span> <span m=''854080''>And</span> <span m=''854200''>so</span>
  <span m=''854320''>it</span> <span m=''854370''>looks</span> <span m=''854590''>like</span>
  <span m=''854840''>each</span> <span m=''855120''>new</span> <span m=''855300''>generation</span>
  <span m=''855980''>of</span> <span m=''856050''>Moore''s</span> <span m=''856360''>law</span>
  <span m=''856810''>is</span> <span m=''857180''>going</span> <span m=''857310''>to</span>
  <span m=''857370''>potentially</span> <span m=''857830''>double</span> <span m=''858720''>the</span>
  <span m=''858830''>number</span> <span m=''859090''>of</span> <span m=''859180''>cores</span>
  <span m=''859690''>per</span> <span m=''859860''>chip.</span> <span m=''861860''>So</span>
  <span m=''863040''>you</span> <span m=''863350''>folks</span> <span m=''863640''>are</span>
  <span m=''863710''>using</span> <span m=''864010''>12</span> <span m=''864360''>core</span>
  <span m=''864570''>machines.</span> <span m=''865090''>Two</span> <span m=''865320''>six</span>
  <span m=''865660''>core</span> <span m=''868230''>chips.</span> <span m=''869090''>Well,</span>
  <span m=''869290''>that''s</span> <span m=''869620''>going</span> <span m=''869750''>to</span>
  <span m=''870010''>basically</span> <span m=''870530''>keep</span> <span m=''870780''>increasing.</span>
  </p><p><span m=''872210''>And</span> <span m=''872310''>so,</span> <span m=''872380''>we''re</span>
  <span m=''872490''>going</span> <span m=''872580''>to</span> <span m=''872620''>get</span>
  <span m=''872800''>more</span> <span m=''873030''>and</span> <span m=''873100''>more</span>
  <span m=''873350''>cores</span> <span m=''873890''>per</span> <span m=''874040''>chip.</span>
  <span m=''875220''>OK.</span> <span m=''875470''>That''s</span> <span m=''875770''>all</span>
  <span m=''875980''>well</span> <span m=''876220''>and</span> <span m=''876360''>good.</span>
  <span m=''876770''>But</span> <span m=''877180''>it</span> <span m=''877380''>turns</span>
  <span m=''877730''>out</span> <span m=''878550''>that</span> <span m=''879020''>there''s</span>
  <span m=''879360''>a</span> <span m=''880270''>major</span> <span m=''880760''>issue.</span>
  <span m=''882110''>And</span> <span m=''882500''>that''s</span> <span m=''882900''>software.</span>
  <span m=''884480''>Everybody</span> <span m=''885100''>has</span> <span m=''885300''>written</span>
  <span m=''885600''>their</span> <span m=''885780''>software.</span> <span m=''886620''>And</span>
  <span m=''886890''>there''s</span> <span m=''887240''>billions</span> <span m=''888030''>and</span>
  <span m=''888210''>billions</span> <span m=''888810''>and</span> <span m=''889060''>billions</span>
  <span m=''889910''>of</span> <span m=''890050''>dollars</span> <span m=''890840''>invested</span>
  <span m=''891650''>in</span> <span m=''891770''>existing</span> <span m=''892460''>legacy</span>
  <span m=''892950''>software</span> <span m=''894060''>that''s</span> <span m=''894280''>written</span>
  <span m=''894620''>for</span> <span m=''894790''>how</span> <span m=''895060''>many</span>
  <span m=''895330''>cores?</span> </p><p><span m=''897040''>One.</span> <span m=''898910''>And</span>
  <span m=''899130''>moving</span> <span m=''899630''>it</span> <span m=''899780''>to</span>
  <span m=''899930''>multicore</span> <span m=''901890''>is</span> <span m=''904100''>a</span>
  <span m=''904220''>nightmare</span> <span m=''904980''>for</span> <span m=''905080''>these</span>
  <span m=''905300''>companies.</span> <span m=''906160''>OK.</span> <span m=''906760''>And</span>
  <span m=''907060''>it''s</span> <span m=''907450''>potentially</span> <span m=''908040''>a</span>
  <span m=''908090''>nightmare</span> <span m=''908640''>for</span> <span m=''908760''>these</span>
  <span m=''909000''>vendors.</span> <span m=''909850''>Because</span> <span m=''910260''>if</span>
  <span m=''910420''>people</span> <span m=''910800''>say,</span> <span m=''911120''>gee,</span>
  <span m=''911350''>you</span> <span m=''911460''>can''t</span> <span m=''911720''>make</span>
  <span m=''911970''>the</span> <span m=''912460''>processors</span> <span m=''913100''>go</span>
  <span m=''913290''>any</span> <span m=''913440''>faster,</span> <span m=''914000''>why</span>
  <span m=''914250''>should</span> <span m=''914470''>I</span> <span m=''914540''>buy</span>
  <span m=''915470''>a</span> <span m=''915570''>new</span> <span m=''915710''>processor?</span>
  <span m=''916770''>My</span> <span m=''916900''>old</span> <span m=''917120''>processor</span>
  <span m=''917680''>is as</span> <span m=''917830''>good</span> <span m=''918010''>as</span>
  <span m=''918130''>my</span> <span m=''918290''>new</span> <span m=''918460''>one.</span>
  </p><p><span m=''920100''>OK.</span> <span m=''920530''>And</span> <span m=''920770''>so,</span>
  <span m=''921950''>anyway,</span> <span m=''922250''>so</span> <span m=''922370''>that''s</span>
  <span m=''922620''>sometimes</span> <span m=''923100''>been</span> <span m=''923270''>called</span>
  <span m=''924990''>the</span> <span m=''925100''>multicore</span> <span m=''925670''>challenge.</span>
  <span m=''926990''>The</span> <span m=''927100''>multicore</span> <span m=''928220''>menace.</span>
  <span m=''929890''>The</span> <span m=''931190''>multicore</span> <span m=''931890''>revolution.</span>
  <span m=''933860''>Whatever.</span> <span m=''934430''>But</span> <span m=''934550''>that''s</span>
  <span m=''934790''>what</span> <span m=''934940''>it''s</span> <span m=''935080''>all</span>
  <span m=''935290''>about.</span> <span m=''935680''>It''s</span> <span m=''935840''>all</span>
  <span m=''936050''>about</span> <span m=''936660''>the</span> <span m=''936830''>issue</span>
  <span m=''937180''>of</span> <span m=''937820''>the</span> <span m=''937920''>frequency</span>
  <span m=''938500''>scaling</span> <span m=''939050''>of</span> <span m=''939160''>the</span>
  <span m=''939260''>clocks,</span> <span m=''940280''>verses,</span> <span m=''941710''>Moore''s</span>
  <span m=''942270''>law.</span> <span m=''943390''>Which</span> <span m=''943570''>talks</span>
  <span m=''943910''>about</span> <span m=''944300''>what</span> <span m=''944500''>the</span>
  <span m=''944570''>density</span> <span m=''945040''>is.</span> </p><p><span m=''946300''>OK.</span>
  <span m=''947310''>So</span> <span m=''947930''>their</span> <span m=''948220''>solution</span>
  <span m=''948760''>is</span> <span m=''948970''>to</span> <span m=''949050''>do--</span>
  <span m=''949870''>and</span> <span m=''950140''>so</span> <span m=''950260''>what</span>
  <span m=''950420''>we''re</span> <span m=''950590''>going</span> <span m=''950680''>to</span>
  <span m=''950780''>talk</span> <span m=''951070''>about</span> <span m=''951470''>for</span>
  <span m=''951670''>a</span> <span m=''951720''>bunch</span> <span m=''952000''>of</span>
  <span m=''952050''>the</span> <span m=''952130''>rest</span> <span m=''952410''>of</span>
  <span m=''952460''>the</span> <span m=''952570''>term</span> <span m=''953280''>is</span>
  <span m=''953480''>going</span> <span m=''953580''>to</span> <span m=''953680''>be,</span>
  <span m=''954760''>how</span> <span m=''955090''>do</span> <span m=''955210''>you</span>
  <span m=''955560''>actually</span> <span m=''955900''>program</span> <span m=''956660''>multicore</span>
  <span m=''957210''>processors?</span> <span m=''958300''>We''re going to</span>
  <span m=''958480''>look</span> <span m=''958690''>at</span> <span m=''958780''>some</span>
  <span m=''958920''>fairly</span> <span m=''959310''>new</span> <span m=''959560''>software</span>
  <span m=''960000''>technology</span> <span m=''960640''>for</span> <span m=''960800''>doing</span>
  <span m=''961070''>that.</span> </p><p><span m=''963110''>So</span> <span m=''963870''>here''s</span>
  <span m=''964110''>an</span> <span m=''964290''>abstract</span> <span m=''964970''>multicore</span>
  <span m=''965660''>architecture.</span> <span m=''968170''>It''s</span> <span m=''968360''>not</span>
  <span m=''969880''>precise.</span> <span m=''970310''>This is</span> <span m=''970490''>only</span>
  <span m=''970670''>showing</span> <span m=''970960''>one</span> <span m=''971160''>level</span>
  <span m=''971470''>of</span> <span m=''971560''>cache.</span> <span m=''972160''>So</span>
  <span m=''972290''>we</span> <span m=''972360''>have</span> <span m=''972440''>processors</span>
  <span m=''973420''>connected</span> <span m=''973870''>to a</span> <span m=''974080''>cache.</span>
  <span m=''974850''>In</span> <span m=''975000''>fact,</span> <span m=''975420''>of</span>
  <span m=''975510''>course,</span> <span m=''975780''>you know</span> <span m=''976640''>that</span>
  <span m=''976880''>there</span> <span m=''977160''>are</span> <span m=''978360''>multiple</span>
  <span m=''979730''>levels</span> <span m=''980330''>of</span> <span m=''980580''>cache.</span>
  <span m=''981070''>Yeah,</span> <span m=''981260''>this</span> <span m=''981410''>is</span>
  <span m=''981600''>the</span> <span m=''982360''>international</span> <span m=''983000''>symbol</span>
  <span m=''983330''>for</span> <span m=''983480''>cache</span> <span m=''984490''>if</span>
  <span m=''984670''>you</span> <span m=''984830''>live</span> <span m=''985040''>in</span>
  <span m=''985140''>the</span> <span m=''985230''>US.</span> </p><p><span m=''989310''>So</span>
  <span m=''990420''>the</span> <span m=''990540''>processors</span> <span m=''991520''>have</span>
  <span m=''991710''>their</span> <span m=''991820''>cache.</span> <span m=''992130''>Of</span>
  <span m=''992210''>course,</span> <span m=''992430''>you</span> <span m=''992790''>know</span>
  <span m=''993150''>that</span> <span m=''993250''>what</span> <span m=''993360''>actually</span>
  <span m=''993670''>happens</span> <span m=''994110''>is</span> <span m=''994220''>you</span>
  <span m=''994340''>have</span> <span m=''994610''>multiple</span> <span m=''995050''>levels</span>
  <span m=''995440''>of</span> <span m=''995630''>cache.</span> <span m=''995900''>And
  it''s</span> <span m=''996170''>shared</span> <span m=''996640''>cache</span> <span
  m=''997410''>at</span> <span m=''997600''>some</span> <span m=''997830''>levels.</span>
  <span m=''998390''>OK.</span> <span m=''998660''>So</span> <span m=''998790''>it''s</span>
  <span m=''998900''>more</span> <span m=''999150''>complex</span> <span m=''999610''>than</span>
  <span m=''999700''>this.</span> <span m=''1000120''>But</span> <span m=''1000300''>this</span>
  <span m=''1000450''>is</span> <span m=''1000580''>sort</span> <span m=''1000830''>of</span>
  <span m=''1000940''>an</span> <span m=''1001050''>abstract</span> <span m=''1001820''>way</span>
  <span m=''1002200''>of</span> <span m=''1002550''>understanding</span> <span m=''1003210''>a</span>
  <span m=''1003280''>bunch</span> <span m=''1003580''>of</span> <span m=''1003630''>the</span>
  <span m=''1003800''>issues.</span> <span m=''1004550''>And</span> <span m=''1004720''>then,</span>
  <span m=''1004840''>of</span> <span m=''1004930''>course,</span> <span m=''1005150''>they</span>
  <span m=''1005270''>only</span> <span m=''1005460''>get</span> <span m=''1005650''>more</span>
  <span m=''1005850''>complicated</span> <span m=''1006530''>as</span> <span m=''1006660''>we</span>
  <span m=''1006780''>look</span> <span m=''1007020''>at</span> <span m=''1007250''>reality,</span>
  <span m=''1008690''>as</span> <span m=''1009180''>with</span> <span m=''1009320''>all</span>
  <span m=''1009540''>these</span> <span m=''1011890''>hardware</span> <span m=''1012350''>related</span>
  <span m=''1012730''>things.</span> </p><p><span m=''1014200''>And</span> <span m=''1014360''>so,</span>
  <span m=''1014460''>this is</span> <span m=''1014620''>a</span> <span m=''1014720''>chip</span>
  <span m=''1014920''>multiprocessor.</span> <span m=''1015690''>Now</span> <span
  m=''1015850''>there</span> <span m=''1016050''>are</span> <span m=''1016370''>other</span>
  <span m=''1016580''>ways</span> <span m=''1017090''>of</span> <span m=''1017180''>using</span>
  <span m=''1017550''>the</span> <span m=''1017620''>silicon.</span> <span m=''1018150''>So</span>
  <span m=''1018290''>another</span> <span m=''1018570''>way</span> <span m=''1018760''>of</span>
  <span m=''1018830''>using</span> <span m=''1019100''>the</span> <span m=''1019150''>silicon</span>
  <span m=''1020040''>is</span> <span m=''1020220''>building</span> <span m=''1020570''>things</span>
  <span m=''1020830''>like</span> <span m=''1021010''>graphics</span> <span m=''1021490''>processors</span>
  <span m=''1022730''>and</span> <span m=''1023040''>using</span> <span m=''1023350''>silicon</span>
  <span m=''1023810''>for a</span> <span m=''1023950''>very</span> <span m=''1024230''>special</span>
  <span m=''1024670''>purpose</span> <span m=''1026810''>thing.</span> <span m=''1027130''>So</span>
  <span m=''1027280''>that</span> <span m=''1027859''>instead</span> <span m=''1028280''>of</span>
  <span m=''1028369''>saying,</span> <span m=''1028680''>let''s</span> <span m=''1028880''>build</span>
  <span m=''1029460''>multiple</span> <span m=''1029890''>processors,</span> <span
  m=''1030540''>you</span> <span m=''1030630''>can</span> <span m=''1030790''>say,</span>
  <span m=''1030980''>let''s</span> <span m=''1031270''>dedicate</span> <span m=''1031920''>some</span>
  <span m=''1032460''>fraction</span> <span m=''1032960''>of</span> <span m=''1033060''>the</span>
  <span m=''1033720''>silicon</span> <span m=''1034180''>real</span> <span m=''1034410''>estate.</span>
  <span m=''1034829''>Instead</span> <span m=''1035119''>of</span> <span m=''1035210''>to</span>
  <span m=''1035310''>general</span> <span m=''1035710''>purpose</span> <span m=''1036700''>computing,</span>
  <span m=''1037310''>let''s</span> <span m=''1037579''>dedicate</span> <span m=''1038079''>it</span>
  <span m=''1038280''>to</span> <span m=''1038550''>some</span> <span m=''1039160''>specific</span>
  <span m=''1039760''>purpose,</span> <span m=''1040150''>like</span> <span m=''1040359''>graphics,</span>
  <span m=''1042060''>or</span> <span m=''1042319''>some</span> <span m=''1042520''>kind</span>
  <span m=''1042710''>of</span> <span m=''1042770''>stream</span> <span m=''1043170''>processing,</span>
  <span m=''1044680''>or</span> <span m=''1044910''>what</span> <span m=''1045060''>have</span>
  <span m=''1045300''>you.</span> <span m=''1046290''>Sensor</span> <span m=''1048450''>processing.</span>
  <span m=''1049800''>A</span> <span m=''1050180''>variety</span> <span m=''1050300''>of
  other</span> <span m=''1050420''>things</span> <span m=''1050610''>you can</span>
  <span m=''1050730''>do.</span> </p><p><span m=''1051360''>But</span> <span m=''1051560''>one</span>
  <span m=''1052000''>main</span> <span m=''1052450''>trend</span> <span m=''1053010''>is</span>
  <span m=''1053380''>doing</span> <span m=''1053620''>chip</span> <span m=''1053840''>multiprocessors.</span>
  <span m=''1057930''>So</span> <span m=''1058180''>we''re</span> <span m=''1058340''>going</span>
  <span m=''1058420''>to</span> <span m=''1058500''>talk</span> <span m=''1058790''>a</span>
  <span m=''1058860''>little</span> <span m=''1059140''>bit</span> <span m=''1059310''>about</span>
  <span m=''1059680''>shared</span> <span m=''1060010''>memory</span> <span m=''1060280''>hardware.</span>
  <span m=''1060820''>Just</span> <span m=''1061190''>enough</span> <span m=''1061410''>to</span>
  <span m=''1061510''>get</span> <span m=''1061720''>you</span> <span m=''1061810''>folks</span>
  <span m=''1062140''>off</span> <span m=''1062380''>the</span> <span m=''1062460''>ground</span>
  <span m=''1063770''>to</span> <span m=''1063900''>understand</span> <span m=''1064680''>what''s</span>
  <span m=''1064950''>going</span> <span m=''1065190''>on</span> <span m=''1065490''>underneath</span>
  <span m=''1066080''>the</span> <span m=''1066160''>system.</span> <span m=''1067400''>And</span>
  <span m=''1067530''>then,</span> <span m=''1067670''>we''re</span> <span m=''1067770''>going</span>
  <span m=''1067860''>to</span> <span m=''1067940''>talk</span> <span m=''1068270''>about</span>
  <span m=''1068680''>four</span> <span m=''1068760''>concurrency</span> <span m=''1069710''>platforms,</span>
  <span m=''1070500''>which</span> <span m=''1070730''>are</span> <span m=''1071980''>not</span>
  <span m=''1072180''>the</span> <span m=''1072400''>only</span> <span m=''1072630''>platforms</span>
  <span m=''1073230''>one</span> <span m=''1073430''>can</span> <span m=''1073590''>program</span>
  <span m=''1074050''>in.</span> <span m=''1074230''>But</span> <span m=''1076800''>they''re</span>
  <span m=''1077110''>ones</span> <span m=''1077480''>that</span> <span m=''1077640''>you</span>
  <span m=''1078290''>should</span> <span m=''1078500''>be</span> <span m=''1078820''>familiar</span>
  <span m=''1079130''>with.</span> </p><p><span m=''1079640''>The</span> <span m=''1079740''>last</span>
  <span m=''1080160''>one,</span> <span m=''1080340''>Cilk++,</span> <span m=''1081380''>is</span>
  <span m=''1081520''>the</span> <span m=''1081600''>one</span> <span m=''1081760''>we''re</span>
  <span m=''1081870''>going</span> <span m=''1081980''>to</span> <span m=''1082050''>do</span>
  <span m=''1082220''>our</span> <span m=''1082740''>programming</span> <span m=''1083350''>assignments</span>
  <span m=''1083860''>in.</span> <span m=''1085520''>And</span> <span m=''1086580''>then,</span>
  <span m=''1088370''>race</span> <span m=''1088790''>conditions,</span> <span m=''1089230''>we''re</span>
  <span m=''1089320''>going</span> <span m=''1089380''>to</span> <span m=''1089450''>talk</span>
  <span m=''1089730''>about,</span> <span m=''1090030''>because</span> <span m=''1090780''>that''s</span>
  <span m=''1091540''>the</span> <span m=''1091990''>biggest</span> <span m=''1092400''>thing</span>
  <span m=''1092580''>that</span> <span m=''1092700''>comes</span> <span m=''1092960''>up</span>
  <span m=''1093120''>when</span> <span m=''1093210''>you</span> <span m=''1093320''>do</span>
  <span m=''1093450''>parallel</span> <span m=''1093890''>programming</span> <span
  m=''1094960''>compared</span> <span m=''1095500''>to</span> <span m=''1096040''>ordinary</span>
  <span m=''1096490''>serial</span> <span m=''1096900''>programming.</span> <span
  m=''1097240''>It''s</span> <span m=''1097580''>the</span> <span m=''1097750''>most</span>
  <span m=''1098070''>pernicious</span> <span m=''1098970''>type</span> <span m=''1099230''>of</span>
  <span m=''1099320''>bugs.</span> <span m=''1099850''>And</span> <span m=''1100100''>you</span>
  <span m=''1100180''>need</span> <span m=''1101550''>to</span> <span m=''1101620''>understand</span>
  <span m=''1102170''>race</span> <span m=''1102420''>conditions</span> <span m=''1102900''>and</span>
  <span m=''1102950''>need a</span> <span m=''1103210''>way</span> <span m=''1104670''>of</span>
  <span m=''1104830''>handling</span> <span m=''1105085''>it.</span> </p><p><span
  m=''1105340''>So</span> <span m=''1105580''>here''s</span> <span m=''1106000''>basically--</span>
  <span m=''1107240''>so we''ll</span> <span m=''1107390''>start</span> <span m=''1107670''>with</span>
  <span m=''1107900''>shared</span> <span m=''1108280''>memory</span> <span m=''1108500''>hardware.</span>
  <span m=''1113830''>So</span> <span m=''1113990''>the</span> <span m=''1114080''>main</span>
  <span m=''1114370''>thing</span> <span m=''1114620''>that</span> <span m=''1114720''>shared</span>
  <span m=''1115100''>memory</span> <span m=''1115370''>hardware</span> <span m=''1115920''>provides</span>
  <span m=''1116560''>is</span> <span m=''1116850''>a</span> <span m=''1116920''>thing</span>
  <span m=''1117140''>called</span> <span m=''1117440''>cache</span> <span m=''1117840''>coherence.</span>
  <span m=''1119940''>OK.</span> <span m=''1120880''>And</span> <span m=''1121160''>the</span>
  <span m=''1121240''>basic</span> <span m=''1121740''>idea</span> <span m=''1122280''>is</span>
  <span m=''1123210''>that</span> <span m=''1123530''>you</span> <span m=''1123650''>want</span>
  <span m=''1124190''>every</span> <span m=''1124530''>processor</span> <span m=''1125160''>to</span>
  <span m=''1125220''>be</span> <span m=''1125360''>able</span> <span m=''1125510''>to</span>
  <span m=''1125580''>fetch</span> <span m=''1125930''>stuff</span> <span m=''1126170''>out</span>
  <span m=''1126350''>of</span> <span m=''1126440''>local</span> <span m=''1126790''>caches</span>
  <span m=''1127330''>because</span> <span m=''1127520''>that''s</span> <span m=''1127800''>fast.</span>
  </p><p><span m=''1130300''>But</span> <span m=''1130420''>at</span> <span m=''1130480''>the</span>
  <span m=''1130560''>same</span> <span m=''1130910''>time,</span> <span m=''1131280''>you</span>
  <span m=''1131390''>want</span> <span m=''1131700''>them</span> <span m=''1131870''>to</span>
  <span m=''1131960''>have</span> <span m=''1132560''>a</span> <span m=''1132720''>common</span>
  <span m=''1133290''>view</span> <span m=''1134570''>of</span> <span m=''1135020''>what</span>
  <span m=''1135420''>is</span> <span m=''1135590''>stored</span> <span m=''1136040''>in</span>
  <span m=''1136160''>a</span> <span m=''1136190''>given</span> <span m=''1136480''>location.</span>
  <span m=''1138760''>So</span> <span m=''1138910''>let''s</span> <span m=''1139160''>run</span>
  <span m=''1139360''>through</span> <span m=''1139520''>this</span> <span m=''1139700''>example</span>
  <span m=''1140180''>and</span> <span m=''1140290''>see</span> <span m=''1140450''>what</span>
  <span m=''1140610''>the</span> <span m=''1140690''>problem</span> <span m=''1141290''>is.</span>
  <span m=''1141580''>And</span> <span m=''1141680''>then,</span> <span m=''1141790''>I''ll</span>
  <span m=''1141890''>show</span> <span m=''1142100''>you</span> <span m=''1142210''>how</span>
  <span m=''1142640''>they</span> <span m=''1142860''>solve</span> <span m=''1143270''>it</span>
  <span m=''1143430''>in</span> <span m=''1144610''>sketchy</span> <span m=''1145060''>detail.</span>
  </p><p><span m=''1149070''>So</span> <span m=''1149290''>here''s</span> <span m=''1149530''>a</span>
  <span m=''1149570''>processor.</span> <span m=''1150050''>Says</span> <span m=''1150290''>he</span>
  <span m=''1150370''>wants</span> <span m=''1150600''>to</span> <span m=''1150690''>load</span>
  <span m=''1150960''>the</span> <span m=''1151050''>value</span> <span m=''1151390''>of</span>
  <span m=''1151480''>x.</span> <span m=''1151880''>And in</span> <span m=''1152010''>main</span>
  <span m=''1152270''>memory</span> <span m=''1152600''>here,</span> <span m=''1152950''>x
  has</span> <span m=''1153410''>got</span> <span m=''1153610''>the</span> <span m=''1153690''>value</span>
  <span m=''1154010''>of</span> <span m=''1154100''>3,</span> <span m=''1154530''>up</span>
  <span m=''1154710''>here</span> <span m=''1154840''>in</span> <span m=''1154980''>DRAM.</span>
  <span m=''1156210''>OK.</span> <span m=''1156890''>So</span> <span m=''1157070''>x</span>
  <span m=''1157400''>moves</span> <span m=''1158770''>through</span> <span m=''1159320''>to</span>
  <span m=''1159580''>the</span> <span m=''1159680''>processor,</span> <span m=''1160840''>where</span>
  <span m=''1161030''>it gets</span> <span m=''1161250''>consumed.</span> <span m=''1162160''>And</span>
  <span m=''1162970''>it</span> <span m=''1163140''>leaves</span> <span m=''1163570''>behind</span>
  <span m=''1164140''>the</span> <span m=''1164240''>fact</span> <span m=''1164590''>that</span>
  <span m=''1164750''>x</span> <span m=''1164980''>equals</span> <span m=''1165370''>3</span>
  <span m=''1165850''>in</span> <span m=''1165930''>its</span> <span m=''1166100''>local</span>
  <span m=''1166420''>cache.</span> </p><p><span m=''1168690''>Well,</span> <span
  m=''1170020''>now</span> <span m=''1170270''>along</span> <span m=''1170650''>comes</span>
  <span m=''1171120''>the</span> <span m=''1171220''>second</span> <span m=''1171590''>processor.</span>
  <span m=''1172040''>It says,</span> <span m=''1172300''>I</span> <span m=''1172440''>want</span>
  <span m=''1172960''>x</span> <span m=''1173265''>too.</span> <span m=''1173860''>And</span>
  <span m=''1174190''>perhaps</span> <span m=''1174600''>the</span> <span m=''1174690''>same</span>
  <span m=''1174980''>thing</span> <span m=''1175200''>happens.</span> <span m=''1177500''>Very</span>
  <span m=''1177740''>good.</span> <span m=''1178020''>So</span> <span m=''1178200''>far,</span>
  <span m=''1178480''>no</span> <span m=''1178600''>problem.</span> <span m=''1179160''>So</span>
  <span m=''1179400''>two</span> <span m=''1180310''>caches</span> <span m=''1180890''>may</span>
  <span m=''1181080''>have</span> <span m=''1181270''>the</span> <span m=''1181360''>same</span>
  <span m=''1181700''>value</span> <span m=''1182210''>of</span> <span m=''1182310''>x.</span>
  <span m=''1183250''>They</span> <span m=''1183720''>may</span> <span m=''1183930''>both</span>
  <span m=''1184250''>want</span> <span m=''1184440''>to</span> <span m=''1184480''>use</span>
  <span m=''1184730''>x,</span> <span m=''1184990''>and</span> <span m=''1185150''>it''s</span>
  <span m=''1185310''>both</span> <span m=''1185590''>in</span> <span m=''1185670''>their</span>
  <span m=''1185800''>local</span> <span m=''1186110''>caches.</span> </p><p><span
  m=''1187090''>Now</span> <span m=''1187320''>comes</span> <span m=''1187580''>along</span>
  <span m=''1187920''>the</span> <span m=''1187990''>third</span> <span m=''1188340''>processor.</span>
  <span m=''1189960''>Says</span> <span m=''1190320''>load</span> <span m=''1190600''>x</span>
  <span m=''1190840''>as</span> <span m=''1190970''>well.</span> <span m=''1191620''>Well,</span>
  <span m=''1191950''>it</span> <span m=''1192050''>turns</span> <span m=''1192370''>out</span>
  <span m=''1192700''>that</span> <span m=''1192870''>it''s</span> <span m=''1193020''>actually--</span>
  <span m=''1193940''>what</span> <span m=''1194180''>I</span> <span m=''1194230''>showed</span>
  <span m=''1194510''>you</span> <span m=''1194600''>on</span> <span m=''1194690''>the</span>
  <span m=''1194890''>second</span> <span m=''1195090''>case</span> <span m=''1195340''>is</span>
  <span m=''1195470''>not</span> <span m=''1195710''>the</span> <span m=''1195790''>common</span>
  <span m=''1196100''>case.</span> <span m=''1196940''>If</span> <span m=''1197170''>these</span>
  <span m=''1197480''>two</span> <span m=''1197610''>processors,</span> <span m=''1198430''>these</span>
  <span m=''1198640''>two</span> <span m=''1198750''>processing</span> <span m=''1199280''>cores,</span>
  <span m=''1199620''>are</span> <span m=''1199960''>on</span> <span m=''1200080''>the</span>
  <span m=''1200190''>same</span> <span m=''1200620''>chip,</span> <span m=''1201680''>it''s</span>
  <span m=''1201930''>generally</span> <span m=''1202410''>cheaper</span> <span m=''1203570''>for</span>
  <span m=''1203720''>this</span> <span m=''1204050''>guy</span> <span m=''1204340''>to</span>
  <span m=''1204540''>fetch</span> <span m=''1204750''>it</span> <span m=''1204900''>out</span>
  <span m=''1205160''>of</span> <span m=''1205900''>one of</span> <span m=''1205960''>these</span>
  <span m=''1206220''>guys</span> <span m=''1206610''>caches</span> <span m=''1207850''>than</span>
  <span m=''1207980''>it is</span> <span m=''1208290''>to</span> <span m=''1208380''>fetch
  it</span> <span m=''1208780''>out</span> <span m=''1208930''>of</span> <span m=''1209040''>DRAM.</span>
  <span m=''1210500''>DRAM</span> <span m=''1210890''>is</span> <span m=''1210950''>slow.</span>
  <span m=''1212000''>Getting</span> <span m=''1212280''>it</span> <span m=''1212370''>locally</span>
  <span m=''1212930''>is</span> <span m=''1213040''>much</span> <span m=''1213310''>cheaper.</span>
  </p><p><span m=''1214530''>So</span> <span m=''1214690''>basically,</span> <span
  m=''1215220''>in</span> <span m=''1215290''>this</span> <span m=''1215480''>case,</span>
  <span m=''1215750''>he</span> <span m=''1215840''>gets</span> <span m=''1216110''>it</span>
  <span m=''1218490''>from</span> <span m=''1218880''>this</span> <span m=''1219310''>processor.</span>
  <span m=''1220030''>The</span> <span m=''1220090''>first</span> <span m=''1220360''>processor.</span>
  <span m=''1221710''>All is</span> <span m=''1221860''>well and</span> <span m=''1222430''>good.</span>
  <span m=''1222650''>They''re</span> <span m=''1222780''>all</span> <span m=''1222940''>sharing</span>
  <span m=''1223340''>merrily</span> <span m=''1223790''>around.</span> <span m=''1224900''>OK.</span>
  <span m=''1226110''>And</span> <span m=''1226280''>then</span> <span m=''1227310''>this</span>
  <span m=''1227540''>fella</span> <span m=''1227830''>decides</span> <span m=''1229040''>if</span>
  <span m=''1229330''>he</span> <span m=''1229460''>wants</span> <span m=''1229710''>to</span>
  <span m=''1229810''>load</span> <span m=''1230050''>it,</span> <span m=''1230180''>no</span>
  <span m=''1230310''>problem.</span> <span m=''1230700''>He</span> <span m=''1230820''>can</span>
  <span m=''1230930''>just</span> <span m=''1231080''>load it.</span> <span m=''1231400''>He</span>
  <span m=''1231540''>loads</span> <span m=''1231810''>it</span> <span m=''1231880''>locally.</span>
  <span m=''1232320''>No</span> <span m=''1232470''>problem.</span> <span m=''1233550''>OK.</span>
  </p><p><span m=''1234580''>This</span> <span m=''1234850''>guy</span> <span m=''1235030''>decides,</span>
  <span m=''1235470''>oh,</span> <span m=''1235600''>he''s</span> <span m=''1235800''>going</span>
  <span m=''1235910''>to</span> <span m=''1235970''>store</span> <span m=''1236410''>some</span>
  <span m=''1236640''>value</span> <span m=''1237010''>to</span> <span m=''1237120''>x.</span>
  <span m=''1237500''>In</span> <span m=''1237610''>this</span> <span m=''1237740''>case,</span>
  <span m=''1237960''>he''s</span> <span m=''1238080''>going</span> <span m=''1238190''>to</span>
  <span m=''1238230''>store</span> <span m=''1238540''>the</span> <span m=''1238640''>value</span>
  <span m=''1238960''>5.</span> <span m=''1240420''>So</span> <span m=''1240550''>he</span>
  <span m=''1240640''>sets</span> <span m=''1240900''>x</span> <span m=''1241170''>equal</span>
  <span m=''1241410''>to</span> <span m=''1241480''>5.</span> <span m=''1243480''>OK.</span>
  <span m=''1244520''>fine.</span> <span m=''1245810''>OK,</span> <span m=''1246000''>now</span>
  <span m=''1246280''>what?</span> <span m=''1247310''>Now</span> <span m=''1247530''>this</span>
  <span m=''1247720''>guy</span> <span m=''1247900''>says,</span> <span m=''1248140''>let</span>
  <span m=''1248280''>me</span> <span m=''1248420''>load</span> <span m=''1248720''>x.</span>
  <span m=''1251130''>He</span> <span m=''1251280''>gets</span> <span m=''1251410''>the</span>
  <span m=''1251470''>value</span> <span m=''1251790''>x</span> <span m=''1252030''>equals</span>
  <span m=''1252430''>3.</span> </p><p><span m=''1254130''>Uh-oh.</span> <span m=''1255920''>If</span>
  <span m=''1256050''>your</span> <span m=''1256180''>parallel</span> <span m=''1256540''>program</span>
  <span m=''1256910''>expected</span> <span m=''1257760''>that</span> <span m=''1258030''>this</span>
  <span m=''1258280''>guy</span> <span m=''1258590''>had</span> <span m=''1258810''>gone</span>
  <span m=''1259110''>first</span> <span m=''1259600''>and</span> <span m=''1259830''>it
  set</span> <span m=''1260040''>x</span> <span m=''1260330''>value</span> <span m=''1260620''>x
  equal</span> <span m=''1260840''>to</span> <span m=''1261105''>5,</span> <span m=''1261690''>these</span>
  <span m=''1262030''>guys</span> <span m=''1262410''>are</span> <span m=''1262510''>now</span>
  <span m=''1263850''>incorrect.</span> <span m=''1267000''>And</span> <span m=''1267210''>so,</span>
  <span m=''1268890''>the</span> <span m=''1269240''>idea</span> <span m=''1269660''>of</span>
  <span m=''1269740''>cache</span> <span m=''1270190''>coherence</span> <span m=''1270740''>is</span>
  <span m=''1270940''>not</span> <span m=''1271190''>letting</span> <span m=''1271510''>this</span>
  <span m=''1271670''>happen,</span> <span m=''1272790''>making</span> <span m=''1273220''>it</span>
  <span m=''1273360''>so</span> <span m=''1273730''>that</span> <span m=''1274190''>whenever</span>
  <span m=''1274760''>a</span> <span m=''1274830''>value</span> <span m=''1275270''>is</span>
  <span m=''1275440''>changed</span> <span m=''1277760''>by</span> <span m=''1278020''>a</span>
  <span m=''1278170''>processor,</span> <span m=''1279180''>the</span> <span m=''1279330''>other</span>
  <span m=''1279580''>processors</span> <span m=''1280270''>see</span> <span m=''1280640''>that</span>
  <span m=''1280910''>change</span> <span m=''1281500''>and</span> <span m=''1281750''>yet,</span>
  <span m=''1282440''>they''re</span> <span m=''1282590''>still</span> <span m=''1282950''>able</span>
  <span m=''1283670''>most</span> <span m=''1283900''>of</span> <span m=''1284140''>the</span>
  <span m=''1284250''>time</span> <span m=''1284680''>to</span> <span m=''1284790''>execute</span>
  <span m=''1285330''>effectively</span> <span m=''1285980''>out</span> <span m=''1286180''>of</span>
  <span m=''1286270''>their</span> <span m=''1286440''>own</span> <span m=''1286590''>local</span>
  <span m=''1286930''>caches.</span> </p><p><span m=''1289200''>OK.</span> <span m=''1289530''>So</span>
  <span m=''1289690''>that''s</span> <span m=''1290040''>the</span> <span m=''1290130''>problem.</span>
  <span m=''1291660''>So do</span> <span m=''1291870''>people</span> <span m=''1292070''>understand</span>
  <span m=''1293720''>basically</span> <span m=''1294120''>what</span> <span m=''1294250''>the</span>
  <span m=''1294320''>cache</span> <span m=''1294650''>coherence</span> <span m=''1295050''>problem</span>
  <span m=''1295410''>is?</span> <span m=''1297470''>Yes,</span> <span m=''1297770''>question?</span>
  </p><p><span m=''1298140''>AUDIENCE: If</span> <span m=''1298625''>the</span> <span
  m=''1299110''>last</span> <span m=''1299595''>processor</span> <span m=''1300080''>was</span>
  <span m=''1300565''>to</span> <span m=''1301050''>store</span> <span m=''1301410''>x</span>
  <span m=''1301770''>and</span> <span m=''1301880''>set</span> <span m=''1302190''>x</span>
  <span m=''1302500''>equals</span> <span m=''1302950''>5,</span> <span m=''1304006''>as</span>
  <span m=''1304492''>soon</span> <span m=''1304978''>as</span> <span m=''1305464''>that</span>
  <span m=''1305950''>happens,</span> <span m=''1306436''>wouldn''t</span> <span m=''1306922''>that</span>
  <span m=''1307408''>write</span> <span m=''1307894''>DRAM</span> <span m=''1308380''>x</span>
  <span m=''1308715''>equals 5?</span> </p><p><span m=''1309050''>PROFESSOR: Good.</span>
  <span m=''1309370''>So</span> <span m=''1309655''>there''s</span> <span m=''1309940''>actually</span>
  <span m=''1310425''>two</span> <span m=''1310910''>types</span> <span m=''1311395''>of</span>
  <span m=''1311880''>strategies</span> <span m=''1312365''>that</span> <span m=''1312850''>are</span>
  <span m=''1312870''>used</span> <span m=''1313550''>in</span> <span m=''1314280''>caches.</span>
  <span m=''1314910''>One</span> <span m=''1315120''>is</span> <span m=''1315280''>called</span>
  <span m=''1316570''>write</span> <span m=''1317090''>through.</span> <span m=''1318040''>And</span>
  <span m=''1318230''>one</span> <span m=''1318370''>is</span> <span m=''1318520''>called</span>
  <span m=''1318840''>write</span> <span m=''1319230''>back.</span> <span m=''1320180''>What</span>
  <span m=''1320360''>you''re</span> <span m=''1320590''>describing</span> <span m=''1321260''>is</span>
  <span m=''1321400''>write</span> <span m=''1321760''>through.</span> <span m=''1322150''>What</span>
  <span m=''1322340''>right</span> <span m=''1322620''>through</span> <span m=''1322820''>caches</span>
  <span m=''1323340''>do</span> <span m=''1323510''>is</span> <span m=''1323710''>if</span>
  <span m=''1323820''>you</span> <span m=''1324000''>write</span> <span m=''1324300''>a</span>
  <span m=''1324330''>value,</span> <span m=''1325070''>it</span> <span m=''1325240''>pushes</span>
  <span m=''1325590''>it</span> <span m=''1325680''>all</span> <span m=''1326080''>the</span>
  <span m=''1326160''>way</span> <span m=''1326350''>out</span> <span m=''1326580''>to</span>
  <span m=''1326680''>DRAM.</span> <span m=''1328440''>These</span> <span m=''1328770''>days,</span>
  <span m=''1329060''>nobody</span> <span m=''1329420''>uses</span> <span m=''1329790''>write</span>
  <span m=''1330070''>through.</span> <span m=''1331170''>You''re</span> <span m=''1331350''>always</span>
  <span m=''1331810''>going</span> <span m=''1332010''>to</span> <span m=''1332200''>DRAM.</span>
  <span m=''1332640''>You''re</span> <span m=''1332800''>always</span> <span m=''1333120''>exercising</span>
  <span m=''1334290''>the</span> <span m=''1335950''>slow</span> <span m=''1336310''>DRAM</span>
  <span m=''1337480''>versus</span> <span m=''1338130''>being</span> <span m=''1338340''>able</span>
  <span m=''1338520''>to</span> <span m=''1338610''>just</span> <span m=''1338840''>write</span>
  <span m=''1339040''>it</span> <span m=''1339120''>locally.</span> </p><p><span m=''1340770''>But</span>
  <span m=''1340920''>you</span> <span m=''1341020''>do</span> <span m=''1341210''>have</span>
  <span m=''1341350''>to</span> <span m=''1341720''>do</span> <span m=''1341890''>something</span>
  <span m=''1342340''>about</span> <span m=''1343340''>these</span> <span m=''1343570''>guys</span>
  <span m=''1343960''>that</span> <span m=''1344060''>are</span> <span m=''1344140''>going</span>
  <span m=''1344260''>to</span> <span m=''1344320''>have</span> <span m=''1345470''>the</span>
  <span m=''1346070''>shared</span> <span m=''1346420''>values.</span> <span m=''1347000''>So</span>
  <span m=''1347200''>here''s</span> <span m=''1347500''>the</span> <span m=''1347580''>mechanism</span>
  <span m=''1348120''>that</span> <span m=''1348280''>they</span> <span m=''1348390''>use.</span>
  <span m=''1349290''>So</span> <span m=''1349460''>what</span> <span m=''1349660''>most</span>
  <span m=''1349920''>people</span> <span m=''1350150''>do</span> <span m=''1350280''>these</span>
  <span m=''1350470''>days</span> <span m=''1350700''>is</span> <span m=''1350790''>write</span>
  <span m=''1351060''>back</span> <span m=''1351510''>caches.</span> <span m=''1352580''>Which</span>
  <span m=''1352820''>basically</span> <span m=''1353280''>means</span> <span m=''1354190''>you</span>
  <span m=''1354440''>only</span> <span m=''1354740''>write it</span> <span m=''1355050''>back</span>
  <span m=''1355400''>when</span> <span m=''1355540''>you</span> <span m=''1355650''>really</span>
  <span m=''1355890''>need</span> <span m=''1356100''>to</span> <span m=''1356250''>evict</span>
  <span m=''1357180''>or</span> <span m=''1357630''>what</span> <span m=''1357960''>have</span>
  <span m=''1358150''>you.</span> <span m=''1360330''>You</span> <span m=''1360450''>don''t</span>
  <span m=''1361120''>always</span> <span m=''1361540''>write</span> <span m=''1361840''>it
  all</span> <span m=''1362010''>the</span> <span m=''1362070''>way</span> <span m=''1362230''>through.</span>
  </p><p><span m=''1363340''>And</span> <span m=''1363470''>so</span> <span m=''1363590''>here''s</span>
  <span m=''1363840''>how</span> <span m=''1364030''>these</span> <span m=''1364370''>schemes</span>
  <span m=''1364680''>work.</span> <span m=''1364990''>So,</span> <span m=''1365130''>right.</span>
  <span m=''1365390''>So</span> <span m=''1365480''>that''s</span> <span m=''1367300''>a</span>
  <span m=''1367350''>bogus</span> <span m=''1367730''>value</span> <span m=''1368520''>for</span>
  <span m=''1368630''>that</span> <span m=''1368790''>kind</span> <span m=''1368900''>to</span>
  <span m=''1369010''>be getting.</span> <span m=''1371470''>So</span> <span m=''1371670''>let''s</span>
  <span m=''1371940''>take</span> <span m=''1372160''>a</span> <span m=''1372280''>look.</span>
  <span m=''1372410''>So</span> <span m=''1372530''>what</span> <span m=''1372690''>they</span>
  <span m=''1372790''>use</span> <span m=''1373260''>is what''s</span> <span m=''1373520''>called--</span>
  <span m=''1373830''>the</span> <span m=''1373900''>simplest</span> <span m=''1374460''>is</span>
  <span m=''1374680''>called</span> <span m=''1374960''>an</span> <span m=''1376590''>MSI</span>
  <span m=''1378040''>protocol.</span> <span m=''1379060''>There are</span> <span
  m=''1379280''>somewhat</span> <span m=''1379640''>more</span> <span m=''1379820''>complicated</span>
  <span m=''1380510''>ones</span> <span m=''1380850''>called</span> <span m=''1381230''>MESI</span>
  <span m=''1382620''>protocols,</span> <span m=''1383270''>and</span> <span m=''1383510''>ones</span>
  <span m=''1383790''>that</span> <span m=''1383900''>are</span> <span m=''1384130''>MOESI.</span>
  <span m=''1386480''>&quot;Mo-esi&quot;</span> <span m=''1387340''>and</span> <span
  m=''1387450''>&quot;messy&quot;.</span> </p><p><span m=''1388930''>Anyway,</span>
  <span m=''1389180''>the</span> <span m=''1389320''>MESI</span> <span m=''1389690''>one</span>
  <span m=''1389900''>is</span> <span m=''1390020''>probably</span> <span m=''1390560''>the</span>
  <span m=''1390660''>one</span> <span m=''1391170''>you''ll</span> <span m=''1391420''>hear</span>
  <span m=''1391610''>most</span> <span m=''1391950''>often.</span> <span m=''1392730''>It''s</span>
  <span m=''1392810''>just</span> <span m=''1393010''>a</span> <span m=''1393060''>little</span>
  <span m=''1393300''>bit</span> <span m=''1393490''>more</span> <span m=''1393680''>complicated</span>
  <span m=''1394310''>than</span> <span m=''1394440''>this</span> <span m=''1394650''>one.</span>
  <span m=''1394920''>But</span> <span m=''1400160''>it</span> <span m=''1400290''>saves</span>
  <span m=''1400570''>you</span> <span m=''1400690''>one</span> <span m=''1400930''>extra</span>
  <span m=''1401240''>access</span> <span m=''1401680''>when</span> <span m=''1401920''>we</span>
  <span m=''1402040''>do</span> <span m=''1402170''>a</span> <span m=''1402340''>write.</span>
  <span m=''1402510''>I''ll</span> <span m=''1402570''>explain</span> <span m=''1402970''>it
  in</span> <span m=''1403090''>just</span> <span m=''1403330''>a</span> <span m=''1403370''>minute.</span>
  <span m=''1403930''>But</span> <span m=''1404080''>let''s</span> <span m=''1404330''>first</span>
  <span m=''1404580''>understand</span> <span m=''1405010''>the</span> <span m=''1405080''>simplest</span>
  <span m=''1405640''>of</span> <span m=''1405720''>these</span> <span m=''1406490''>mechanisms.</span>
  </p><p><span m=''1408610''>So</span> <span m=''1408780''>what</span> <span m=''1408980''>you</span>
  <span m=''1409120''>do</span> <span m=''1409520''>is</span> <span m=''1409940''>in</span>
  <span m=''1410190''>each</span> <span m=''1410540''>cache,</span> <span m=''1411080''>you''re</span>
  <span m=''1411180''>going</span> <span m=''1411270''>to</span> <span m=''1411330''>label</span>
  <span m=''1411820''>each</span> <span m=''1412140''>cache</span> <span m=''1412560''>line</span>
  <span m=''1412950''>with</span> <span m=''1413040''>a</span> <span m=''1413130''>state.</span>
  <span m=''1414840''>And</span> <span m=''1415000''>basically,</span> <span m=''1416490''>it''s</span>
  <span m=''1416780''>because</span> <span m=''1417320''>of</span> <span m=''1417440''>these</span>
  <span m=''1417630''>states</span> <span m=''1418150''>that</span> <span m=''1418250''>you</span>
  <span m=''1418350''>associate</span> <span m=''1418890''>with</span> <span m=''1419030''>a</span>
  <span m=''1419080''>cache</span> <span m=''1419500''>line</span> <span m=''1420130''>that</span>
  <span m=''1420270''>cache</span> <span m=''1420590''>lines</span> <span m=''1420830''>end</span>
  <span m=''1420990''>up</span> <span m=''1421090''>having</span> <span m=''1421420''>to</span>
  <span m=''1421480''>be</span> <span m=''1421610''>long.</span> </p><p><span m=''1422860''>OK?</span>
  <span m=''1423140''>Because</span> <span m=''1424290''>if</span> <span m=''1424440''>you</span>
  <span m=''1424600''>think</span> <span m=''1424850''>about,</span> <span m=''1425080''>you''d</span>
  <span m=''1425240''>like</span> <span m=''1425430''>cache</span> <span m=''1425750''>lines</span>
  <span m=''1426020''>to</span> <span m=''1426110''>be</span> <span m=''1427100''>at</span>
  <span m=''1427500''>some</span> <span m=''1427750''>level</span> <span m=''1428070''>very</span>
  <span m=''1428400''>short,</span> <span m=''1430220''>in</span> <span m=''1430450''>that</span>
  <span m=''1430820''>then</span> <span m=''1431050''>you</span> <span m=''1431170''>have</span>
  <span m=''1431510''>more</span> <span m=''1431830''>opportunity</span> <span m=''1432390''>to</span>
  <span m=''1432520''>have</span> <span m=''1432860''>just</span> <span m=''1433170''>the</span>
  <span m=''1433250''>stuff</span> <span m=''1433650''>in</span> <span m=''1434030''>cache</span>
  <span m=''1434440''>that</span> <span m=''1434610''>you</span> <span m=''1434710''>want,</span>
  <span m=''1435480''>from</span> <span m=''1435690''>a</span> <span m=''1435750''>temporal</span>
  <span m=''1436180''>locality</span> <span m=''1436810''>point</span> <span m=''1437070''>of</span>
  <span m=''1437140''>view.</span> <span m=''1437740''>It''s</span> <span m=''1437930''>one</span>
  <span m=''1438200''>thing</span> <span m=''1438400''>if</span> <span m=''1438490''>you</span>
  <span m=''1438610''>want</span> <span m=''1438780''>to</span> <span m=''1438830''>bring</span>
  <span m=''1439180''>in</span> <span m=''1439370''>extra</span> <span m=''1439810''>lines,</span>
  <span m=''1440810''>extra</span> <span m=''1441160''>data,</span> <span m=''1441770''>for</span>
  <span m=''1441990''>spatial</span> <span m=''1442390''>locality.</span> <span m=''1443120''>But</span>
  <span m=''1443240''>to</span> <span m=''1443360''>insist</span> <span m=''1443625''>that</span>
  <span m=''1443890''>it</span> <span m=''1443980''>all</span> <span m=''1444190''>be</span>
  <span m=''1444370''>there</span> <span m=''1444550''>whether</span> <span m=''1444740''>you</span>
  <span m=''1444880''>access</span> <span m=''1445260''>it or</span> <span m=''1445710''>not,</span>
  <span m=''1446910''>that''s</span> <span m=''1447160''>not</span> <span m=''1447360''>clear</span>
  <span m=''1447660''>how</span> <span m=''1447840''>helpful</span> <span m=''1448270''>that</span>
  <span m=''1448450''>it</span> <span m=''1448490''>is.</span> </p><p><span m=''1449870''>However,</span>
  <span m=''1450440''>what</span> <span m=''1450600''>instead</span> <span m=''1451060''>is</span>
  <span m=''1451220''>we</span> <span m=''1451340''>have</span> <span m=''1451490''>things</span>
  <span m=''1451730''>like,</span> <span m=''1451930''>on</span> <span m=''1452010''>the</span>
  <span m=''1452150''>Intel</span> <span m=''1452470''>architecture,</span> <span
  m=''1453060''>64 bytes</span> <span m=''1455650''>of</span> <span m=''1455810''>cache</span>
  <span m=''1456170''>line.</span> <span m=''1456590''>And</span> <span m=''1456710''>the</span>
  <span m=''1456780''>reason</span> <span m=''1457060''>is</span> <span m=''1457190''>because</span>
  <span m=''1457370''>they''re</span> <span m=''1457500''>keeping</span> <span m=''1457910''>extra</span>
  <span m=''1458680''>data</span> <span m=''1459090''>with</span> <span m=''1459380''>each</span>
  <span m=''1460600''>cache</span> <span m=''1460970''>line.</span> <span m=''1461360''>And</span>
  <span m=''1461560''>they</span> <span m=''1461760''>want</span> <span m=''1462290''>the</span>
  <span m=''1462750''>data</span> <span m=''1463180''>to</span> <span m=''1463300''>be</span>
  <span m=''1463440''>the</span> <span m=''1463550''>larger</span> <span m=''1464010''>fraction</span>
  <span m=''1464790''>of</span> <span m=''1465260''>what</span> <span m=''1465570''>they''re</span>
  <span m=''1465680''>keeping</span> <span m=''1466080''>compared</span> <span m=''1466470''>to</span>
  <span m=''1466570''>the</span> <span m=''1466660''>control</span> <span m=''1467160''>information</span>
  <span m=''1467720''>about</span> <span m=''1468040''>the</span> <span m=''1468120''>data.</span>
  </p><p><span m=''1468900''>So</span> <span m=''1469030''>in</span> <span m=''1469070''>this</span>
  <span m=''1469270''>case,</span> <span m=''1469510''>they''re</span> <span m=''1469660''>keeping</span>
  <span m=''1470010''>three</span> <span m=''1470290''>values.</span> <span m=''1471120''>Three</span>
  <span m=''1471360''>bits.</span> <span m=''1473520''>The</span> <span m=''1473820''>M</span>
  <span m=''1474020''>bit says</span> <span m=''1474330''>this</span> <span m=''1474780''>cache</span>
  <span m=''1475050''>block</span> <span m=''1475350''>has</span> <span m=''1475530''>been</span>
  <span m=''1475690''>modified.</span> <span m=''1476370''>Somebody''s</span> <span
  m=''1476740''>written</span> <span m=''1477090''>to</span> <span m=''1477260''>it.</span>
  <span m=''1478140''>And</span> <span m=''1478270''>what</span> <span m=''1478430''>they</span>
  <span m=''1478550''>do</span> <span m=''1478770''>is</span> <span m=''1478970''>they,</span>
  <span m=''1479230''>in</span> <span m=''1479460''>this</span> <span m=''1479680''>protocol,</span>
  <span m=''1480850''>they</span> <span m=''1481800''>guarantee</span> <span m=''1483130''>in</span>
  <span m=''1483280''>the</span> <span m=''1483360''>protocol</span> <span m=''1484090''>that</span>
  <span m=''1484350''>if</span> <span m=''1484580''>somebody</span> <span m=''1485050''>has</span>
  <span m=''1485430''>it</span> <span m=''1485570''>in</span> <span m=''1485720''>the</span>
  <span m=''1485900''>M</span> <span m=''1486210''>state,</span> <span m=''1487200''>no</span>
  <span m=''1487570''>other</span> <span m=''1487840''>caches</span> <span m=''1488370''>contain</span>
  <span m=''1488820''>this</span> <span m=''1489050''>block</span> <span m=''1489650''>in</span>
  <span m=''1490000''>either the</span> <span m=''1490210''>M</span> <span m=''1490490''>state</span>
  <span m=''1491010''>or</span> <span m=''1491200''>S</span> <span m=''1491420''>state.</span>
  </p><p><span m=''1493980''>So</span> <span m=''1494130''>what</span> <span m=''1494290''>are</span>
  <span m=''1494370''>those</span> <span m=''1494710''>states?</span> <span m=''1494920''>So</span>
  <span m=''1495080''>the</span> <span m=''1495300''>S</span> <span m=''1495655''>state</span>
  <span m=''1496010''>is</span> <span m=''1496990''>when</span> <span m=''1497560''>other</span>
  <span m=''1497790''>caches</span> <span m=''1498260''>may</span> <span m=''1498420''>be</span>
  <span m=''1498540''>sharing</span> <span m=''1499000''>this</span> <span m=''1499200''>block.</span>
  <span m=''1500500''>And</span> <span m=''1500770''>the I</span> <span m=''1501060''>state</span>
  <span m=''1501680''>is</span> <span m=''1501990''>that</span> <span m=''1502130''>this</span>
  <span m=''1502330''>cache</span> <span m=''1502670''>block</span> <span m=''1503040''>is</span>
  <span m=''1503680''>invalid.</span> <span m=''1504280''>It''s</span> <span m=''1504440''>the</span>
  <span m=''1504520''>same</span> <span m=''1504780''>as</span> <span m=''1504890''>if</span>
  <span m=''1505000''>it''s</span> <span m=''1505190''>not</span> <span m=''1505460''>there.</span>
  <span m=''1505720''>It''s</span> <span m=''1505890''>empty</span> <span m=''1506770''>entry.</span>
  <span m=''1508250''>So</span> <span m=''1508380''>it just</span> <span m=''1509310''>marks</span>
  <span m=''1509640''>this</span> <span m=''1509840''>entry.</span> <span m=''1510460''>There''s</span>
  <span m=''1510640''>no</span> <span m=''1510830''>data</span> <span m=''1511140''>there.</span>
  <span m=''1512680''>The</span> <span m=''1512790''>cache</span> <span m=''1513090''>line</span>
  <span m=''1513330''>that''s</span> <span m=''1513540''>there</span> <span m=''1514150''>is</span>
  <span m=''1514290''>not</span> <span m=''1514500''>really</span> <span m=''1514760''>there,</span>
  <span m=''1516075''>is</span> <span m=''1516370''>basically</span> <span m=''1516860''>what</span>
  <span m=''1517020''>it</span> <span m=''1517110''>says.</span> </p><p><span m=''1517820''>So</span>
  <span m=''1517960''>here,</span> <span m=''1518220''>you</span> <span m=''1518320''>see</span>
  <span m=''1518590''>for</span> <span m=''1518710''>example</span> <span m=''1519690''>that</span>
  <span m=''1520390''>this</span> <span m=''1521030''>fella</span> <span m=''1521980''>has</span>
  <span m=''1523460''>x</span> <span m=''1523690''>equals</span> <span m=''1524100''>13</span>
  <span m=''1524900''>in</span> <span m=''1525050''>the</span> <span m=''1525130''>modified</span>
  <span m=''1525870''>state.</span> <span m=''1526890''>And</span> <span m=''1527060''>so,</span>
  <span m=''1527280''>if</span> <span m=''1527360''>you</span> <span m=''1527480''>look</span>
  <span m=''1527670''>across</span> <span m=''1528170''>here,</span> <span m=''1528530''>oh,</span>
  <span m=''1528740''>nobody</span> <span m=''1529150''>else</span> <span m=''1529380''>has</span>
  <span m=''1529620''>that in</span> <span m=''1529920''>either</span> <span m=''1530270''>the</span>
  <span m=''1530720''>M or</span> <span m=''1530840''>the</span> <span m=''1531010''>S</span>
  <span m=''1531305''>state.</span> <span m=''1532770''>They</span> <span m=''1532880''>only</span>
  <span m=''1533070''>have</span> <span m=''1533210''>it</span> <span m=''1533280''>in</span>
  <span m=''1533380''>the</span> <span m=''1533520''>I</span> <span m=''1533750''>state</span>
  <span m=''1534160''>or</span> <span m=''1534380''>not</span> <span m=''1534610''>at</span>
  <span m=''1534690''>all.</span> </p><p><span m=''1537160''>If</span> <span m=''1537290''>you</span>
  <span m=''1537460''>have</span> <span m=''1537640''>it in the</span> <span m=''1537670''>shared</span>
  <span m=''1538110''>state,</span> <span m=''1538700''>as</span> <span m=''1538970''>these</span>
  <span m=''1539240''>guys</span> <span m=''1539510''>have,</span> <span m=''1539780''>well,</span>
  <span m=''1539940''>they</span> <span m=''1540140''>all</span> <span m=''1540350''>have</span>
  <span m=''1540520''>it</span> <span m=''1540590''>in</span> <span m=''1540690''>the</span>
  <span m=''1540740''>shared</span> <span m=''1541120''>state</span> <span m=''1541470''>and</span>
  <span m=''1541580''>notice</span> <span m=''1541870''>the</span> <span m=''1541950''>values</span>
  <span m=''1542370''>are</span> <span m=''1542530''>all</span> <span m=''1542640''>the</span>
  <span m=''1542720''>same.</span> <span m=''1545340''>And</span> <span m=''1545530''>then,</span>
  <span m=''1545820''>if</span> <span m=''1545940''>it''s</span> <span m=''1546120''>in</span>
  <span m=''1546420''>the invalid</span> <span m=''1547020''>state,</span> <span m=''1547330''>here</span>
  <span m=''1547750''>this</span> <span m=''1547960''>guy</span> <span m=''1548130''>once</span>
  <span m=''1548390''>again</span> <span m=''1548620''>has</span> <span m=''1548910''>it</span>
  <span m=''1549090''>in</span> <span m=''1549370''>the</span> <span m=''1549830''>modified</span>
  <span m=''1550440''>state,</span> <span m=''1550760''>which</span> <span m=''1550910''>means</span>
  <span m=''1551130''>these</span> <span m=''1551380''>guys</span> <span m=''1552050''>don''t</span>
  <span m=''1552260''>have</span> <span m=''1552510''>it</span> <span m=''1552670''>in</span>
  <span m=''1552870''>either</span> <span m=''1553180''>the</span> <span m=''1553370''>S</span>
  <span m=''1553710''>or M</span> <span m=''1553890''>state.</span> <span m=''1554230''>So</span>
  <span m=''1554310''>that''s</span> <span m=''1554700''>the</span> <span m=''1554840''>invariant.</span>
  </p><p><span m=''1555610''>So</span> <span m=''1555790''>what''s</span> <span m=''1556050''>the</span>
  <span m=''1556150''>basic</span> <span m=''1556600''>idea</span> <span m=''1557030''>behind</span>
  <span m=''1557440''>the</span> <span m=''1557520''>cache?</span> <span m=''1558950''>The</span>
  <span m=''1559540''>MSI</span> <span m=''1559780''>protocol?</span> <span m=''1560650''>The</span>
  <span m=''1560800''>idea</span> <span m=''1561170''>is</span> <span m=''1561470''>that</span>
  <span m=''1561670''>before</span> <span m=''1562250''>you</span> <span m=''1562600''>can</span>
  <span m=''1562950''>write</span> <span m=''1563430''>on</span> <span m=''1563700''>a</span>
  <span m=''1563880''>location,</span> <span m=''1565190''>you</span> <span m=''1565360''>must</span>
  <span m=''1565670''>first</span> <span m=''1567230''>invalidate</span> <span m=''1568390''>all</span>
  <span m=''1568710''>the</span> <span m=''1568880''>other</span> <span m=''1569050''>copies.</span>
  <span m=''1572260''>So</span> <span m=''1572420''>whenever</span> <span m=''1572660''>you</span>
  <span m=''1572770''>try</span> <span m=''1573000''>to</span> <span m=''1573100''>write</span>
  <span m=''1573580''>on</span> <span m=''1573770''>something</span> <span m=''1574160''>that''s</span>
  <span m=''1574300''>shared</span> <span m=''1574760''>across</span> <span m=''1575240''>a</span>
  <span m=''1575290''>bunch</span> <span m=''1575590''>of</span> <span m=''1575680''>things</span>
  <span m=''1575980''>or</span> <span m=''1576260''>that</span> <span m=''1576470''>somebody</span>
  <span m=''1576800''>else</span> <span m=''1577000''>has</span> <span m=''1577160''>modified,</span>
  <span m=''1578640''>what</span> <span m=''1578810''>happens</span> <span m=''1579320''>is</span>
  <span m=''1579590''>over</span> <span m=''1579870''>the</span> <span m=''1579990''>network</span>
  <span m=''1580480''>goes</span> <span m=''1580730''>out</span> <span m=''1580880''>a</span>
  <span m=''1580940''>protocol</span> <span m=''1582050''>to</span> <span m=''1582200''>invalidate</span>
  <span m=''1582930''>all</span> <span m=''1583230''>the</span> <span m=''1583360''>other</span>
  <span m=''1583540''>copies.</span> </p><p><span m=''1585000''>So</span> <span m=''1585220''>if</span>
  <span m=''1585280''>they''re</span> <span m=''1585400''>just</span> <span m=''1585720''>being</span>
  <span m=''1585950''>shared,</span> <span m=''1586590''>that''s</span> <span m=''1586830''>no</span>
  <span m=''1586980''>problem.</span> <span m=''1587540''>Because</span> <span m=''1587850''>all</span>
  <span m=''1587990''>you</span> <span m=''1588130''>do</span> <span m=''1588350''>is</span>
  <span m=''1588470''>just</span> <span m=''1588670''>have</span> <span m=''1588830''>them</span>
  <span m=''1588970''>drop</span> <span m=''1589290''>it</span> <span m=''1589410''>from</span>
  <span m=''1589560''>the</span> <span m=''1589660''>cache.</span> <span m=''1591300''>If</span>
  <span m=''1591440''>it''s</span> <span m=''1591580''>modified,</span> <span m=''1592910''>then</span>
  <span m=''1593060''>it</span> <span m=''1593150''>may</span> <span m=''1593310''>have</span>
  <span m=''1593540''>to</span> <span m=''1593660''>be</span> <span m=''1594050''>written</span>
  <span m=''1594330''>back</span> <span m=''1594750''>or</span> <span m=''1594880''>the</span>
  <span m=''1595000''>value</span> <span m=''1595460''>brought</span> <span m=''1595920''>back</span>
  <span m=''1596280''>to</span> <span m=''1596400''>you,</span> <span m=''1597610''>so
  that</span> <span m=''1597790''>you''re</span> <span m=''1598110''>in</span> <span
  m=''1598160''>a</span> <span m=''1598190''>position</span> <span m=''1598710''>of</span>
  <span m=''1598820''>changing it.</span> <span m=''1599200''>If</span> <span m=''1599270''>somebody</span>
  <span m=''1599510''>has it</span> <span m=''1599800''>modified,</span> <span m=''1600300''>then</span>
  <span m=''1600420''>you</span> <span m=''1600610''>don''t</span> <span m=''1600790''>have</span>
  <span m=''1601050''>it.</span> <span m=''1601610''>So</span> <span m=''1601810''>therefore,</span>
  <span m=''1602300''>you</span> <span m=''1602470''>need</span> <span m=''1602670''>to</span>
  <span m=''1602750''>bring</span> <span m=''1603030''>it</span> <span m=''1603130''>in</span>
  <span m=''1604250''>and</span> <span m=''1605100''>make</span> <span m=''1605330''>the</span>
  <span m=''1605420''>change</span> <span m=''1605830''>to it.</span> <span m=''1606250''>Question?</span>
  </p><p><span m=''1607117''>AUDIENCE: [INAUDIBLE]</span> <span m=''1607574''>three</span>
  <span m=''1608031''>states?</span> </p><p><span m=''1609470''>PROFESSOR: Three</span>
  <span m=''1609815''>states.</span> <span m=''1610160''>Not</span> <span m=''1610260''>three</span>
  <span m=''1610490''>bits.</span> <span m=''1611210''>Two</span> <span m=''1611350''>bits.</span>
  <span m=''1611600''>Right.</span> <span m=''1612900''>OK.</span> <span m=''1615150''>So</span>
  <span m=''1615350''>the</span> <span m=''1615480''>idea</span> <span m=''1615770''>is</span>
  <span m=''1615850''>you</span> <span m=''1615970''>first</span> <span m=''1616310''>invalidate</span>
  <span m=''1616800''>the</span> <span m=''1616910''>other</span> <span m=''1617030''>copies.</span>
  <span m=''1617470''>Therefore,</span> <span m=''1617960''>when</span> <span m=''1618255''>a</span>
  <span m=''1619180''>processor</span> <span m=''1619750''>core</span> <span m=''1620540''>is</span>
  <span m=''1621060''>changing</span> <span m=''1621520''>the</span> <span m=''1621610''>value</span>
  <span m=''1622430''>of</span> <span m=''1623250''>some</span> <span m=''1623610''>variable,</span>
  <span m=''1624240''>it</span> <span m=''1624400''>has</span> <span m=''1624690''>the</span>
  <span m=''1624970''>only</span> <span m=''1625250''>copy.</span> <span m=''1628320''>And</span>
  <span m=''1628520''>by</span> <span m=''1628660''>making</span> <span m=''1629010''>sure</span>
  <span m=''1629180''>that</span> <span m=''1629310''>it</span> <span m=''1629500''>only</span>
  <span m=''1629730''>has</span> <span m=''1630030''>the</span> <span m=''1630200''>only</span>
  <span m=''1630380''>copy,</span> <span m=''1630830''>you</span> <span m=''1630940''>make</span>
  <span m=''1631160''>sure</span> <span m=''1631400''>that</span> <span m=''1631580''>you</span>
  <span m=''1631680''>never</span> <span m=''1631980''>have</span> <span m=''1632180''>copies</span>
  <span m=''1632690''>out</span> <span m=''1632960''>there</span> <span m=''1633460''>that
  are</span> <span m=''1633660''>anything</span> <span m=''1634210''>except</span>
  <span m=''1635410''>copies</span> <span m=''1637600''>of</span> <span m=''1637790''>what</span>
  <span m=''1637930''>everybody</span> <span m=''1638410''>else</span> <span m=''1638600''>has.</span>
  <span m=''1640020''>That</span> <span m=''1640190''>they''re</span> <span m=''1640350''>all</span>
  <span m=''1640510''>the</span> <span m=''1640600''>same.</span> </p><p><span m=''1642170''>OK.</span>
  <span m=''1643340''>Does</span> <span m=''1643460''>everybody</span> <span m=''1643930''>follow</span>
  <span m=''1644230''>that?</span> <span m=''1646320''>So</span> <span m=''1646450''>there''s</span>
  <span m=''1646620''>hardware</span> <span m=''1647190''>under</span> <span m=''1647410''>there</span>
  <span m=''1647610''>doing</span> <span m=''1647960''>that.</span> <span m=''1648440''>It''s</span>
  <span m=''1648540''>actually</span> <span m=''1648820''>pretty</span> <span m=''1649050''>clever</span>
  <span m=''1649380''>hardware.</span> <span m=''1650250''>In</span> <span m=''1650430''>fact,</span>
  <span m=''1651530''>the</span> <span m=''1651690''>verification</span> <span m=''1652690''>of</span>
  <span m=''1652780''>cache</span> <span m=''1653110''>protocols</span> <span m=''1655550''>is</span>
  <span m=''1655900''>a</span> <span m=''1655980''>huge</span> <span m=''1656550''>problem</span>
  <span m=''1657310''>for</span> <span m=''1657440''>which</span> <span m=''1658380''>there''s</span>
  <span m=''1658640''>a</span> <span m=''1658710''>lot</span> <span m=''1659390''>of</span>
  <span m=''1659900''>technology</span> <span m=''1661130''>built</span> <span m=''1661470''>to</span>
  <span m=''1661560''>try</span> <span m=''1661780''>to</span> <span m=''1661870''>verify</span>
  <span m=''1663220''>to</span> <span m=''1663340''>make</span> <span m=''1663510''>sure</span>
  <span m=''1663640''>these</span> <span m=''1663870''>cache</span> <span m=''1664220''>protocols</span>
  <span m=''1664700''>work</span> <span m=''1664990''>the</span> <span m=''1665090''>way</span>
  <span m=''1665290''>they''re</span> <span m=''1665440''>supposed</span> <span m=''1665790''>to</span>
  <span m=''1665860''>work.</span> </p><p><span m=''1666960''>Because</span> <span
  m=''1667260''>what</span> <span m=''1667390''>happens</span> <span m=''1667810''>in</span>
  <span m=''1667930''>practice</span> <span m=''1668440''>is</span> <span m=''1668580''>there
  are</span> <span m=''1668720''>all</span> <span m=''1668860''>these</span> <span
  m=''1669040''>intermediate</span> <span m=''1669640''>states.</span> <span m=''1670070''>What</span>
  <span m=''1670210''>happens</span> <span m=''1670640''>if</span> <span m=''1671090''>this</span>
  <span m=''1671350''>guy</span> <span m=''1671660''>starts</span> <span m=''1672120''>doing</span>
  <span m=''1672340''>this</span> <span m=''1672560''>while</span> <span m=''1672730''>this</span>
  <span m=''1672980''>guy</span> <span m=''1673200''>is</span> <span m=''1673350''>doing</span>
  <span m=''1673630''>that,</span> <span m=''1674945''>and</span> <span m=''1676110''>these</span>
  <span m=''1676310''>protocols</span> <span m=''1676800''>start</span> <span m=''1677110''>getting</span>
  <span m=''1677400''>mixed,</span> <span m=''1677870''>and</span> <span m=''1678480''>so</span>
  <span m=''1678800''>forth?</span> <span m=''1679130''>And</span> <span m=''1679290''>you''ve</span>
  <span m=''1679390''>got</span> <span m=''1679500''>to</span> <span m=''1679560''>make</span>
  <span m=''1679740''>sure</span> <span m=''1680060''>that</span> <span m=''1680240''>works</span>
  <span m=''1680530''>out.</span> <span m=''1680770''>And</span> <span m=''1680880''>that''s</span>
  <span m=''1681150''>what''s</span> <span m=''1681290''>going</span> <span m=''1681550''>on</span>
  <span m=''1681780''>in the</span> <span m=''1681860''>hardware.</span> </p><p><span
  m=''1683410''>The</span> <span m=''1683690''>MESI</span> <span m=''1684960''>protocol</span>
  <span m=''1685490''>does</span> <span m=''1685790''>a</span> <span m=''1686000''>simple</span>
  <span m=''1686370''>optimization.</span> <span m=''1687200''>It</span> <span m=''1687340''>says,</span>
  <span m=''1687570''>look,</span> <span m=''1688470''>before</span> <span m=''1688980''>I</span>
  <span m=''1689220''>store</span> <span m=''1689700''>something,</span> <span m=''1690970''>I</span>
  <span m=''1691080''>probably</span> <span m=''1691610''>want</span> <span m=''1691810''>to</span>
  <span m=''1691860''>read</span> <span m=''1692140''>it.</span> <span m=''1693230''>It''s</span>
  <span m=''1693360''>likely</span> <span m=''1693750''>I''m</span> <span m=''1693830''>going</span>
  <span m=''1693900''>to</span> <span m=''1693970''>read</span> <span m=''1694230''>it.</span>
  <span m=''1695120''>So</span> <span m=''1695290''>I</span> <span m=''1695380''>can</span>
  <span m=''1695550''>read</span> <span m=''1695780''>it</span> <span m=''1695880''>in</span>
  <span m=''1696020''>two</span> <span m=''1696210''>ways.</span> <span m=''1696590''>I</span>
  <span m=''1696710''>can</span> <span m=''1696920''>read</span> <span m=''1697140''>it</span>
  <span m=''1697350''>in</span> <span m=''1697510''>a</span> <span m=''1697570''>way</span>
  <span m=''1697820''>that</span> <span m=''1697990''>says</span> <span m=''1698400''>that</span>
  <span m=''1698560''>it is--</span> <span m=''1701100''>where</span> <span m=''1701390''>it''s</span>
  <span m=''1701510''>just</span> <span m=''1701700''>going</span> <span m=''1701800''>to</span>
  <span m=''1701840''>be</span> <span m=''1701940''>shared.</span> <span m=''1703330''>But</span>
  <span m=''1703410''>if</span> <span m=''1703520''>I</span> <span m=''1703610''>expect</span>
  <span m=''1703910''>that</span> <span m=''1704210''>I''m</span> <span m=''1704320''>going</span>
  <span m=''1704460''>to</span> <span m=''1704540''>write</span> <span m=''1704860''>it,</span>
  <span m=''1705670''>let</span> <span m=''1705890''>me</span> <span m=''1706050''>when</span>
  <span m=''1706280''>I</span> <span m=''1706390''>read</span> <span m=''1706740''>it</span>
  <span m=''1706970''>instead</span> <span m=''1707290''>of</span> <span m=''1707430''>getting</span>
  <span m=''1707720''>a</span> <span m=''1707760''>shared</span> <span m=''1708190''>copy,</span>
  <span m=''1709520''>let</span> <span m=''1709730''>me</span> <span m=''1709880''>get</span>
  <span m=''1710310''>an</span> <span m=''1711530''>exclusive</span> <span m=''1712320''>copy.</span>
  <span m=''1712770''>And</span> <span m=''1712850''>that''s</span> <span m=''1713050''>where</span>
  <span m=''1713310''>the E</span> <span m=''1713510''>comes</span> <span m=''1713820''>from.</span>
  <span m=''1714920''>Let</span> <span m=''1715020''>me</span> <span m=''1715130''>get
  an</span> <span m=''1715280''>exclusive</span> <span m=''1715960''>copy.</span>
  <span m=''1716350''>In other words,</span> <span m=''1716620''>go</span> <span m=''1716800''>through</span>
  <span m=''1716950''>the</span> <span m=''1717150''>invalidation</span> <span m=''1718440''>protocols</span>
  <span m=''1719090''>on</span> <span m=''1719320''>the</span> <span m=''1719420''>read,</span>
  <span m=''1720680''>so</span> <span m=''1721040''>that</span> <span m=''1721660''>with</span>
  <span m=''1721780''>the</span> <span m=''1721880''>expectation</span> <span m=''1722560''>that</span>
  <span m=''1722680''>when</span> <span m=''1722870''>you</span> <span m=''1723030''>write,</span>
  <span m=''1724220''>you</span> <span m=''1724340''>don''t</span> <span m=''1724520''>have</span>
  <span m=''1724680''>to</span> <span m=''1724840''>then</span> <span m=''1725140''>wait</span>
  <span m=''1725570''>for</span> <span m=''1726430''>the</span> <span m=''1726630''>invalidation</span>
  <span m=''1727240''>to</span> <span m=''1727320''>occur</span> <span m=''1727610''>at</span>
  <span m=''1727710''>that</span> <span m=''1727970''>point.</span> <span m=''1728240''>So</span>
  <span m=''1728390''>it''s</span> <span m=''1728500''>a</span> <span m=''1728650''>way</span>
  <span m=''1729020''>of</span> <span m=''1729740''>reducing</span> <span m=''1730470''>the</span>
  <span m=''1730550''>latency</span> <span m=''1731550''>of</span> <span m=''1731720''>the</span>
  <span m=''1731810''>protocol</span> <span m=''1733330''>by</span> <span m=''1733980''>getting</span>
  <span m=''1734290''>it</span> <span m=''1734360''>exclusively</span> <span m=''1735220''>by</span>
  <span m=''1735380''>the</span> <span m=''1735540''>read</span> <span m=''1735860''>that</span>
  <span m=''1735990''>you</span> <span m=''1736090''>do</span> <span m=''1736270''>before</span>
  <span m=''1736700''>you</span> <span m=''1736820''>do</span> <span m=''1736990''>the</span>
  <span m=''1737090''>write.</span> </p><p><span m=''1738860''>So</span> <span m=''1739090''>rather</span>
  <span m=''1739390''>than</span> <span m=''1739850''>doing</span> <span m=''1740100''>a</span>
  <span m=''1740230''>read,</span> <span m=''1740850''>which</span> <span m=''1741090''>would</span>
  <span m=''1741230''>go</span> <span m=''1741410''>out</span> <span m=''1741510''>and</span>
  <span m=''1741660''>get</span> <span m=''1741890''>the</span> <span m=''1741970''>value--</span>
  <span m=''1744210''>but</span> <span m=''1744470''>everybody</span> <span m=''1744870''>[?
  has them ?]</span> <span m=''1745250''>shared--</span> <span m=''1745680''>then</span>
  <span m=''1745840''>doing</span> <span m=''1746080''>the</span> <span m=''1746170''>write,</span>
  <span m=''1746610''>and</span> <span m=''1747080''>then</span> <span m=''1747340''>doing</span>
  <span m=''1747610''>a</span> <span m=''1747650''>whole</span> <span m=''1747940''>invalidation</span>
  <span m=''1749170''>protocol,</span> <span m=''1749900''>if</span> <span m=''1750180''>I</span>
  <span m=''1750330''>basically</span> <span m=''1750880''>get</span> <span m=''1751120''>it</span>
  <span m=''1751260''>in</span> <span m=''1751410''>exclusive</span> <span m=''1752020''>mode</span>
  <span m=''1752330''>on</span> <span m=''1752440''>the</span> <span m=''1752560''>read,</span>
  <span m=''1753380''>then</span> <span m=''1753570''>I</span> <span m=''1753640''>go</span>
  <span m=''1753880''>out,</span> <span m=''1754070''>I</span> <span m=''1754140''>get</span>
  <span m=''1754410''>the</span> <span m=''1754510''>value,</span> <span m=''1754980''>and</span>
  <span m=''1755390''>I</span> <span m=''1755480''>invalidate</span> <span m=''1756170''>everybody</span>
  <span m=''1756710''>else.</span> <span m=''1757570''>Now</span> <span m=''1757780''>I''ve</span>
  <span m=''1757880''>just</span> <span m=''1758150''>saved</span> <span m=''1758390''>myself</span>
  <span m=''1758980''>half</span> <span m=''1759330''>the</span> <span m=''1759450''>work</span>
  <span m=''1760340''>and</span> <span m=''1760550''>half</span> <span m=''1760800''>the</span>
  <span m=''1760890''>latency.</span> <span m=''1762630''>Or</span> <span m=''1762760''>basically</span>
  <span m=''1763470''>saved</span> <span m=''1763690''>myself</span> <span m=''1763980''>some</span>
  <span m=''1764180''>latency.</span> <span m=''1764770''>Not</span> <span m=''1765170''>half
  the latency.</span> <span m=''1766100''>OK?</span> </p><p><span m=''1767900''>So</span>
  <span m=''1768820''>basically,</span> <span m=''1769620''>what</span> <span m=''1769860''>you</span>
  <span m=''1770010''>should</span> <span m=''1770230''>know</span> <span m=''1770530''>is</span>
  <span m=''1771210''>there</span> <span m=''1771430''>is</span> <span m=''1771520''>invalidation</span>
  <span m=''1772300''>stuff</span> <span m=''1772600''>going</span> <span m=''1772890''>on</span>
  <span m=''1773130''>behind</span> <span m=''1773640''>when</span> <span m=''1773760''>you</span>
  <span m=''1773830''>start</span> <span m=''1774130''>using</span> <span m=''1774370''>shared</span>
  <span m=''1774740''>memory,</span> <span m=''1775030''>behind the</span> <span m=''1775440''>scenes</span>
  <span m=''1776800''>which</span> <span m=''1777070''>can</span> <span m=''1777730''>slow</span>
  <span m=''1778180''>down</span> <span m=''1778600''>your</span> <span m=''1779200''>processor</span>
  <span m=''1781760''>from</span> <span m=''1781960''>executing.</span> <span m=''1782800''>Because</span>
  <span m=''1783100''>it</span> <span m=''1783260''>can''t</span> <span m=''1783950''>do</span>
  <span m=''1784100''>the</span> <span m=''1784200''>things</span> <span m=''1784470''>that</span>
  <span m=''1784540''>it</span> <span m=''1784610''>needs</span> <span m=''1784840''>to</span>
  <span m=''1784940''>do</span> <span m=''1785150''>until</span> <span m=''1785420''>it</span>
  <span m=''1785520''>goes</span> <span m=''1787210''>through</span> <span m=''1787480''>the</span>
  <span m=''1787600''>protocol.</span> <span m=''1789810''>Any</span> <span m=''1790000''>questions</span>
  <span m=''1791540''>about</span> <span m=''1791900''>that?</span> <span m=''1792060''>That''s</span>
  <span m=''1792260''>basically</span> <span m=''1792820''>the</span> <span m=''1792930''>level</span>
  <span m=''1793270''>we''re</span> <span m=''1793430''>going</span> <span m=''1793550''>to</span>
  <span m=''1793620''>cover</span> <span m=''1798800''>the</span> <span m=''1798920''>hardware</span>
  <span m=''1801060''>at.</span> </p><p><span m=''1801390''>And</span> <span m=''1801600''>so,</span>
  <span m=''1801740''>you''ll</span> <span m=''1802170''>discover</span> <span m=''1802610''>that</span>
  <span m=''1802810''>in</span> <span m=''1802980''>doing</span> <span m=''1803190''>some</span>
  <span m=''1803390''>your</span> <span m=''1803560''>problems,</span> <span m=''1804510''>that</span>
  <span m=''1804870''>if</span> <span m=''1805020''>you''re</span> <span m=''1805130''>not</span>
  <span m=''1805340''>careful,</span> <span m=''1805760''>you''re</span> <span m=''1805930''>going</span>
  <span m=''1806030''>to</span> <span m=''1806100''>create</span> <span m=''1806700''>what</span>
  <span m=''1806880''>are</span> <span m=''1806980''>called</span> <span m=''1807420''>invalidation</span>
  <span m=''1808150''>storms,</span> <span m=''1809640''>where you</span> <span m=''1809800''>have</span>
  <span m=''1809940''>a</span> <span m=''1809980''>whole</span> <span m=''1810220''>bunch</span>
  <span m=''1810480''>of</span> <span m=''1810580''>things</span> <span m=''1810870''>that</span>
  <span m=''1811490''>are</span> <span m=''1811700''>red,</span> <span m=''1812130''>and</span>
  <span m=''1812240''>they''re</span> <span m=''1812340''>distributed</span> <span
  m=''1812710''>across</span> <span m=''1812880''>the</span> <span m=''1813060''>processor.</span>
  <span m=''1813560''>And</span> <span m=''1813660''>then</span> <span m=''1813800''>you</span>
  <span m=''1813890''>go</span> <span m=''1814130''>in,</span> <span m=''1814290''>and</span>
  <span m=''1814550''>you</span> <span m=''1815220''>set</span> <span m=''1815520''>one</span>
  <span m=''1815720''>value.</span> <span m=''1816220''>And</span> <span m=''1816430''>suddenly,</span>
  <span m=''1816980''>vrrrrrruuuum.</span> <span m=''1818460''>Gee,</span> <span m=''1818790''>how</span>
  <span m=''1818940''>come</span> <span m=''1819050''>that</span> <span m=''1819250''>wasn''t</span>
  <span m=''1819410''>a</span> <span m=''1819520''>fast</span> <span m=''1819970''>store?</span>
  <span m=''1821420''>The</span> <span m=''1821710''>answer</span> <span m=''1822000''>is
  it''s</span> <span m=''1822260''>going</span> <span m=''1822490''>through and</span>
  <span m=''1822650''>invalidating</span> <span m=''1823390''>all</span> <span m=''1823550''>those</span>
  <span m=''1823720''>other</span> <span m=''1823890''>copies.</span> <span m=''1827630''>Good.</span>
  </p><p><span m=''1829330''>So</span> <span m=''1829540''>let''s</span> <span m=''1829900''>turn</span>
  <span m=''1830240''>to</span> <span m=''1830370''>the</span> <span m=''1830500''>real</span>
  <span m=''1830850''>hard</span> <span m=''1831200''>problem.</span> <span m=''1831700''>So</span>
  <span m=''1831940''>it</span> <span m=''1832050''>turns</span> <span m=''1832290''>out</span>
  <span m=''1832480''>that</span> <span m=''1832550''>building</span> <span m=''1832990''>these</span>
  <span m=''1833240''>things</span> <span m=''1834010''>is</span> <span m=''1834860''>not</span>
  <span m=''1835290''>particularly</span> <span m=''1835980''>well</span> <span m=''1836260''>understood.</span>
  <span m=''1836930''>But</span> <span m=''1837110''>it''s</span> <span m=''1837270''>understood</span>
  <span m=''1837680''>a</span> <span m=''1837730''>lot</span> <span m=''1838150''>better</span>
  <span m=''1838450''>than</span> <span m=''1838640''>programming</span> <span m=''1839280''>these</span>
  <span m=''1839500''>beasts.</span> <span m=''1841310''>OK.</span> <span m=''1842400''>And</span>
  <span m=''1842670''>so,</span> <span m=''1842970''>we''re</span> <span m=''1843210''>going</span>
  <span m=''1843300''>to</span> <span m=''1843680''>focus</span> <span m=''1844080''>on</span>
  <span m=''1844480''>some</span> <span m=''1844750''>of</span> <span m=''1844860''>the</span>
  <span m=''1846460''>strategies</span> <span m=''1847250''>for</span> <span m=''1847370''>programming.</span>
  </p><p><span m=''1851120''>So</span> <span m=''1852110''>it</span> <span m=''1852270''>turns</span>
  <span m=''1852590''>out</span> <span m=''1852780''>that</span> <span m=''1852890''>trying</span>
  <span m=''1853220''>to</span> <span m=''1853320''>program</span> <span m=''1854420''>their</span>
  <span m=''1854650''>processor</span> <span m=''1855330''>cores</span> <span m=''1855760''>directly</span>
  <span m=''1857170''>is</span> <span m=''1857590''>painful.</span> <span m=''1858530''>And</span>
  <span m=''1860140''>you''re</span> <span m=''1860320''>liable</span> <span m=''1860760''>to</span>
  <span m=''1860860''>make</span> <span m=''1861060''>a</span> <span m=''1861120''>lot</span>
  <span m=''1861350''>of</span> <span m=''1861440''>errors,</span> <span m=''1863380''>as</span>
  <span m=''1863570''>we''ll</span> <span m=''1863690''>see.</span> <span m=''1864110''>Because</span>
  <span m=''1864360''>we''re</span> <span m=''1864460''>going</span> <span m=''1864550''>to</span>
  <span m=''1864620''>talk</span> <span m=''1864890''>about</span> <span m=''1865740''>races</span>
  <span m=''1867030''>soon.</span> </p><p><span m=''1868170''>And</span> <span m=''1868330''>so</span>
  <span m=''1868490''>the</span> <span m=''1868620''>idea</span> <span m=''1868940''>of</span>
  <span m=''1869030''>a</span> <span m=''1869110''>current</span> <span m=''1869470''>currency</span>
  <span m=''1869910''>platform</span> <span m=''1871080''>is</span> <span m=''1871280''>to</span>
  <span m=''1871750''>do</span> <span m=''1871910''>some</span> <span m=''1872400''>level</span>
  <span m=''1872740''>of</span> <span m=''1872850''>abstraction</span> <span m=''1873540''>of</span>
  <span m=''1873610''>the</span> <span m=''1873700''>processor</span> <span m=''1874320''>cores</span>
  <span m=''1875480''>to</span> <span m=''1875550''>handle</span> <span m=''1876880''>synchronization</span>
  <span m=''1877800''>communication</span> <span m=''1878450''>protocols,</span> <span
  m=''1879150''>and</span> <span m=''1879870''>often</span> <span m=''1880270''>to</span>
  <span m=''1880370''>do</span> <span m=''1880540''>things</span> <span m=''1880810''>like</span>
  <span m=''1881020''>load</span> <span m=''1881280''>balancing,</span> <span m=''1883580''>so</span>
  <span m=''1883810''>that</span> <span m=''1884040''>the</span> <span m=''1884240''>work</span>
  <span m=''1884620''>that</span> <span m=''1884750''>you''re</span> <span m=''1884870''>doing</span>
  <span m=''1885240''>can</span> <span m=''1885400''>be</span> <span m=''1885990''>moved</span>
  <span m=''1886330''>across</span> <span m=''1886820''>from</span> <span m=''1886960''>processor</span>
  <span m=''1887255''>to</span> <span m=''1887550''>processor.</span> </p><p><span
  m=''1888750''>And</span> <span m=''1888890''>so,</span> <span m=''1889040''>here
  are</span> <span m=''1889270''>some</span> <span m=''1889400''>examples</span> <span
  m=''1889980''>of</span> <span m=''1890080''>concurrency</span> <span m=''1890780''>platforms.</span>
  <span m=''1891390''>Pthreads</span> <span m=''1892550''>and</span> <span m=''1892760''>WinAPI</span>
  <span m=''1893410''>threads,</span> <span m=''1893760''>we''re</span> <span m=''1893860''>going</span>
  <span m=''1893930''>to</span> <span m=''1894000''>talk</span> <span m=''1894220''>more</span>
  <span m=''1894410''>in</span> <span m=''1894500''>detail</span> <span m=''1894910''>about.</span>
  <span m=''1895500''>Pthreads</span> <span m=''1896080''>is</span> <span m=''1896210''>basically</span>
  <span m=''1897630''>for</span> <span m=''1897780''>Unix</span> <span m=''1898210''>type</span>
  <span m=''1898450''>systems,</span> <span m=''1898880''>like</span> <span m=''1899050''>Linux</span>
  <span m=''1899500''>and</span> <span m=''1899640''>such.</span> <span m=''1900470''>WinAPI</span>
  <span m=''1901270''>threads</span> <span m=''1901600''>is</span> <span m=''1901730''>for</span>
  <span m=''1901830''>Windows.</span> </p><p><span m=''1903930''>There''s</span> <span
  m=''1904190''>threading</span> <span m=''1904540''>building</span> <span m=''1904940''>blocks,</span>
  <span m=''1905870''>TBB,</span> <span m=''1907340''>OpenMP,</span> <span m=''1908070''>which</span>
  <span m=''1908240''>is</span> <span m=''1908380''>a</span> <span m=''1908440''>standard,</span>
  <span m=''1909000''>and</span> <span m=''1909270''>Cilk++.</span> <span m=''1910120''>Those</span>
  <span m=''1910270''>are</span> <span m=''1910370''>all</span> <span m=''1910530''>examples</span>
  <span m=''1911850''>of</span> <span m=''1912800''>concurrency</span> <span m=''1913400''>platforms</span>
  <span m=''1913930''>that</span> <span m=''1914060''>make</span> <span m=''1914250''>it</span>
  <span m=''1914360''>easier</span> <span m=''1914810''>to</span> <span m=''1914900''>program</span>
  <span m=''1916430''>these</span> <span m=''1916790''>parallel</span> <span m=''1917140''>machines.</span>
  </p><p><span m=''1919280''>So</span> <span m=''1919410''>I''m</span> <span m=''1919500''>going</span>
  <span m=''1919580''>to</span> <span m=''1919660''>do,</span> <span m=''1919970''>as</span>
  <span m=''1920100''>an</span> <span m=''1920150''>example,</span> <span m=''1920890''>I''m</span>
  <span m=''1921130''>going</span> <span m=''1921210''>to</span> <span m=''1921250''>use</span>
  <span m=''1921440''>the</span> <span m=''1921520''>Fibonacci</span> <span m=''1922100''>numbers,</span>
  <span m=''1922610''>which</span> <span m=''1922830''>you</span> <span m=''1924190''>have</span>
  <span m=''1924650''>seen</span> <span m=''1924890''>before</span> <span m=''1925360''>I''m</span>
  <span m=''1925470''>sure,</span> <span m=''1926320''>because</span> <span m=''1926520''>we''ve</span>
  <span m=''1926680''>actually</span> <span m=''1927920''>even</span> <span m=''1928150''>used</span>
  <span m=''1928400''>it in</span> <span m=''1928510''>this</span> <span m=''1928680''>class.</span>
  <span m=''1931260''>This</span> <span m=''1931510''>is</span> <span m=''1932000''>Leonardo</span>
  <span m=''1932810''>da</span> <span m=''1933010''>Pisa,</span> <span m=''1933740''>who</span>
  <span m=''1933930''>was</span> <span m=''1934100''>also</span> <span m=''1934350''>known</span>
  <span m=''1934540''>as</span> <span m=''1934660''>Fibonacci.</span> <span m=''1936040''>And</span>
  <span m=''1936790''>he</span> <span m=''1937230''>introduced--</span> <span m=''1937820''>he</span>
  <span m=''1937900''>was</span> <span m=''1938380''>the</span> <span m=''1938590''>most</span>
  <span m=''1938810''>brilliant</span> <span m=''1939110''>mathematician</span> <span
  m=''1939790''>of</span> <span m=''1939870''>his</span> <span m=''1940140''>day.</span>
  <span m=''1940680''>He</span> <span m=''1940970''>came</span> <span m=''1941190''>basically</span>
  <span m=''1941650''>out of</span> <span m=''1941850''>the</span> <span m=''1941940''>blue,</span>
  <span m=''1943360''>doing</span> <span m=''1943600''>all</span> <span m=''1943870''>kinds</span>
  <span m=''1944160''>of</span> <span m=''1944230''>beautiful</span> <span m=''1944600''>mathematics</span>
  <span m=''1946580''>very</span> <span m=''1947000''>early</span> <span m=''1947350''>in</span>
  <span m=''1947470''>the</span> <span m=''1947550''>Renaissance.</span> <span m=''1948150''>You''ll</span>
  <span m=''1948270''>recognize</span> <span m=''1949290''>1202</span> <span m=''1949950''>is</span>
  <span m=''1950110''>very</span> <span m=''1950410''>early</span> <span m=''1950700''>Renaissance.</span>
  </p><p><span m=''1955610''>But</span> <span m=''1955850''>it</span> <span m=''1955960''>turns</span>
  <span m=''1956240''>out,</span> <span m=''1956440''>for</span> <span m=''1956520''>those</span>
  <span m=''1956790''>of</span> <span m=''1956850''>you</span> <span m=''1957010''>of</span>
  <span m=''1957100''>Indian</span> <span m=''1957470''>descent,</span> <span m=''1958310''>the</span>
  <span m=''1958440''>Indian</span> <span m=''1958960''>mathematicians</span> <span
  m=''1959650''>had</span> <span m=''1959710''>already</span> <span m=''1959900''>discovered</span>
  <span m=''1960390''>all</span> <span m=''1960530''>this</span> <span m=''1960610''>stuff.</span>
  <span m=''1963700''>But</span> <span m=''1964000''>it</span> <span m=''1964150''>didn''t</span>
  <span m=''1964350''>make</span> <span m=''1964550''>it</span> <span m=''1964620''>into</span>
  <span m=''1964820''>Western</span> <span m=''1965190''>culture</span> <span m=''1965660''>except</span>
  <span m=''1966030''>for</span> <span m=''1966480''>Leonardo</span> <span m=''1967020''>da</span>
  <span m=''1967390''>Pisa.</span> <span m=''1970040''>So</span> <span m=''1970280''>here''s</span>
  <span m=''1970620''>a</span> <span m=''1970790''>program</span> <span m=''1971300''>as</span>
  <span m=''1971400''>you</span> <span m=''1971510''>might</span> <span m=''1971760''>write</span>
  <span m=''1972000''>it</span> <span m=''1972180''>in</span> <span m=''1973010''>C.</span>
  <span m=''1976840''>So</span> <span m=''1977080''>Fib</span> <span m=''1977740''>int</span>
  <span m=''1978020''>n</span> <span m=''1978480''>says,</span> <span m=''1978840''>well,</span>
  <span m=''1978990''>if</span> <span m=''1979060''>n</span> <span m=''1979230''>is</span>
  <span m=''1979370''>less</span> <span m=''1979610''>than</span> <span m=''1979750''>2,</span>
  <span m=''1979970''>return</span> <span m=''1980390''>n.</span> <span m=''1980980''>So</span>
  <span m=''1981180''>if</span> <span m=''1981430''>it''s</span> <span m=''1981780''>0
  or 1,</span> <span m=''1982140''>we</span> <span m=''1982290''>return,</span> <span
  m=''1983070''>Fib</span> <span m=''1983220''>of</span> <span m=''1983330''>0</span>
  <span m=''1983680''>is</span> <span m=''1983790''>0.</span> <span m=''1984100''>Fib
  of</span> <span m=''1984340''>1</span> <span m=''1984610''>is</span> <span m=''1984780''>1.</span>
  </p><p><span m=''1985580''>And</span> <span m=''1985750''>otherwise,</span> <span
  m=''1986940''>we</span> <span m=''1987090''>compute</span> <span m=''1987660''>Fib</span>
  <span m=''1987770''>of</span> <span m=''1988000''>n</span> <span m=''1988140''>minus</span>
  <span m=''1988480''>1,</span> <span m=''1988840''>compute</span> <span m=''1989330''>Fib
  of</span> <span m=''1989630''>n minus</span> <span m=''1990000''>2,</span> <span
  m=''1990300''>and</span> <span m=''1990480''>return</span> <span m=''1990880''>the</span>
  <span m=''1990950''>sum.</span> <span m=''1992220''>Simple</span> <span m=''1992550''>recursive</span>
  <span m=''1993000''>program.</span> <span m=''1993950''>Here''s</span> <span m=''1994160''>the</span>
  <span m=''1994250''>main</span> <span m=''1994540''>routine.</span> <span m=''1995080''>We</span>
  <span m=''1995600''>get</span> <span m=''1995800''>the</span> <span m=''1995910''>argument</span>
  <span m=''1996350''>from</span> <span m=''1996510''>the</span> <span m=''1996590''>command</span>
  <span m=''1996940''>line,</span> <span m=''1998480''>compute</span> <span m=''1998850''>the</span>
  <span m=''1998940''>result,</span> <span m=''1999530''>and</span> <span m=''1999910''>then</span>
  <span m=''2000070''>print</span> <span m=''2000280''>out</span> <span m=''2001560''>Fibonacci</span>
  <span m=''2002170''>of</span> <span m=''2002450''>whatever</span> <span m=''2002890''>is</span>
  <span m=''2003110''>whatever.</span> <span m=''2004210''>Pretty</span> <span m=''2004440''>simple</span>
  <span m=''2004750''>piece</span> <span m=''2004970''>of</span> <span m=''2005040''>code.</span>
  </p><p><span m=''2006290''>So</span> <span m=''2006630''>what we''re</span> <span
  m=''2006710''>going to do</span> <span m=''2006820''>is</span> <span m=''2006940''>take</span>
  <span m=''2007140''>a</span> <span m=''2007210''>look</span> <span m=''2007430''>at</span>
  <span m=''2007510''>what</span> <span m=''2007660''>happens</span> <span m=''2008130''>in</span>
  <span m=''2008240''>each</span> <span m=''2008410''>of</span> <span m=''2008500''>these</span>
  <span m=''2009160''>four</span> <span m=''2010260''>concurrency</span> <span m=''2010880''>platforms</span>
  <span m=''2011970''>to</span> <span m=''2012110''>see</span> <span m=''2012330''>how</span>
  <span m=''2012580''>it</span> <span m=''2012660''>is</span> <span m=''2012900''>that</span>
  <span m=''2013060''>they</span> <span m=''2013660''>make</span> <span m=''2013910''>this</span>
  <span m=''2014150''>easy</span> <span m=''2014570''>to</span> <span m=''2014720''>run
  this</span> <span m=''2015090''>in</span> <span m=''2015220''>parallel.</span> <span
  m=''2017510''>Now</span> <span m=''2017760''>just</span> <span m=''2018030''>a</span>
  <span m=''2018110''>disclaimer</span> <span m=''2018740''>here.</span> <span m=''2020770''>This</span>
  <span m=''2020990''>is</span> <span m=''2021410''>a</span> <span m=''2021440''>really</span>
  <span m=''2021750''>bad</span> <span m=''2022180''>way--</span> <span m=''2022720''>I</span>
  <span m=''2022840''>hope</span> <span m=''2023050''>you</span> <span m=''2023190''>all</span>
  <span m=''2023300''>recognize--</span> <span m=''2023850''>of</span> <span m=''2023940''>computing</span>
  <span m=''2024360''>Fibonacci</span> <span m=''2024920''>numbers.</span> </p><p><span
  m=''2026365''>So</span> <span m=''2027300''>this</span> <span m=''2027600''>is</span>
  <span m=''2027740''>exponential</span> <span m=''2028420''>time</span> <span m=''2028760''>algorithm.</span>
  <span m=''2029960''>And</span> <span m=''2030170''>you</span> <span m=''2030280''>all</span>
  <span m=''2030540''>know</span> <span m=''2030900''>the</span> <span m=''2031420''>linear</span>
  <span m=''2031850''>time</span> <span m=''2032160''>algorithm,</span> <span m=''2032670''>which</span>
  <span m=''2032870''>is</span> <span m=''2032990''>basically</span> <span m=''2033580''>computed</span>
  <span m=''2034030''>up</span> <span m=''2034190''>from</span> <span m=''2034320''>the</span>
  <span m=''2034400''>bottom.</span> <span m=''2035440''>And</span> <span m=''2035620''>some</span>
  <span m=''2035830''>of</span> <span m=''2035930''>you</span> <span m=''2036120''>probably</span>
  <span m=''2036520''>know</span> <span m=''2036760''>there''s</span> <span m=''2036990''>a</span>
  <span m=''2037050''>logarithmic</span> <span m=''2037880''>time</span> <span m=''2038210''>algorithm</span>
  <span m=''2039250''>based</span> <span m=''2039580''>on</span> <span m=''2039740''>squaring</span>
  <span m=''2040250''>matrices.</span> <span m=''2040910''>Two</span> <span m=''2041050''>by</span>
  <span m=''2041210''>two</span> <span m=''2041390''>matrices.</span> </p><p><span
  m=''2045030''>So</span> <span m=''2045280''>in</span> <span m=''2045370''>any</span>
  <span m=''2045570''>case,</span> <span m=''2050989''>we''re</span> <span m=''2051350''>all</span>
  <span m=''2051489''>about</span> <span m=''2051830''>performance</span> <span m=''2052409''>here.</span>
  <span m=''2052670''>But</span> <span m=''2053810''>obviously,</span> <span m=''2054380''>this</span>
  <span m=''2054540''>is</span> <span m=''2054639''>a</span> <span m=''2054719''>really</span>
  <span m=''2054949''>poor</span> <span m=''2055239''>choice</span> <span m=''2055620''>to</span>
  <span m=''2055699''>do</span> <span m=''2055820''>performance</span> <span m=''2056075''>on.</span>
  <span m=''2056330''>But it</span> <span m=''2056739''>is</span> <span m=''2056980''>a</span>
  <span m=''2057020''>good</span> <span m=''2057250''>didactic</span> <span m=''2057820''>example,</span>
  <span m=''2058510''>because</span> <span m=''2058710''>it''s</span> <span m=''2058900''>so</span>
  <span m=''2059480''>the</span> <span m=''2059570''>structure</span> <span m=''2060530''>and</span>
  <span m=''2060719''>the</span> <span m=''2060830''>issues</span> <span m=''2061239''>that</span>
  <span m=''2061350''>you</span> <span m=''2061460''>get</span> <span m=''2061620''>into</span>
  <span m=''2062270''>in</span> <span m=''2062639''>doing</span> <span m=''2062900''>this</span>
  <span m=''2064409''>with</span> <span m=''2064650''>a</span> <span m=''2064699''>very</span>
  <span m=''2064949''>simple</span> <span m=''2065300''>program</span> <span m=''2065679''>that</span>
  <span m=''2065800''>I</span> <span m=''2065850''>can</span> <span m=''2066020''>fit</span>
  <span m=''2066179''>on</span> <span m=''2066250''>a</span> <span m=''2066330''>slide.</span>
  </p><p><span m=''2068639''>OK.</span> <span m=''2068909''>So</span> <span m=''2069070''>when</span>
  <span m=''2069239''>you</span> <span m=''2069370''>execute</span> <span m=''2069909''>Fibonacci,</span>
  <span m=''2071610''>when</span> <span m=''2071800''>you</span> <span m=''2071880''>call</span>
  <span m=''2072260''>Fib</span> <span m=''2072370''>of 4,</span> <span m=''2072989''>it</span>
  <span m=''2073219''>calls</span> <span m=''2073810''>Fib</span> <span m=''2073949''>of</span>
  <span m=''2074050''>3</span> <span m=''2074480''>and</span> <span m=''2074600''>Fib</span>
  <span m=''2074780''>of</span> <span m=''2074949''>2.</span> <span m=''2076469''>And</span>
  <span m=''2076670''>Fib</span> <span m=''2076850''>of</span> <span m=''2076949''>3</span>
  <span m=''2077320''>calls</span> <span m=''2077590''>Fib of</span> <span m=''2077820''>2</span>
  <span m=''2078010''>and</span> <span m=''2078190''>Fib</span> <span m=''2078389''>of</span>
  <span m=''2078750''>1.</span> <span m=''2079570''>And</span> <span m=''2079840''>Fib
  of</span> <span m=''2080110''>1</span> <span m=''2080860''>just</span> <span m=''2081090''>returns</span>
  <span m=''2081540''>Fib</span> <span m=''2081670''>of 2,</span> <span m=''2082100''>calls</span>
  <span m=''2082330''>[UNINTELLIGIBLE]</span> <span m=''2082489''>1,</span> <span
  m=''2082739''>0,</span> <span m=''2083020''>et</span> <span m=''2083130''>cetera.</span>
  </p><p><span m=''2084060''>And</span> <span m=''2084199''>so</span> <span m=''2084380''>basically,</span>
  <span m=''2084920''>you</span> <span m=''2085070''>get</span> <span m=''2087230''>an</span>
  <span m=''2087710''>execution</span> <span m=''2088420''>trace</span> <span m=''2088909''>that</span>
  <span m=''2089199''>basically</span> <span m=''2089659''>corresponds</span> <span
  m=''2090280''>to</span> <span m=''2090420''>walk</span> <span m=''2091480''>of</span>
  <span m=''2091670''>this</span> <span m=''2091900''>tree.</span> <span m=''2093270''>So</span>
  <span m=''2093480''>if</span> <span m=''2093550''>you</span> <span m=''2093719''>were</span>
  <span m=''2093810''>doing</span> <span m=''2094120''>this</span> <span m=''2095179''>in</span>
  <span m=''2095360''>C,</span> <span m=''2096110''>you''d</span> <span m=''2096250''>basically</span>
  <span m=''2097050''>call</span> <span m=''2097400''>this,</span> <span m=''2097720''>call</span>
  <span m=''2097960''>this,</span> <span m=''2098170''>call</span> <span m=''2098380''>this.</span>
  <span m=''2098770''>Get a value</span> <span m=''2099140''>return.</span> <span
  m=''2099670''>Call</span> <span m=''2099920''>this.</span> <span m=''2100550''>Add</span>
  <span m=''2100770''>the</span> <span m=''2100860''>two</span> <span m=''2101000''>values</span>
  <span m=''2101370''>together.</span> <span m=''2102930''>Return</span> <span m=''2103320''>here.</span>
  <span m=''2104540''>Call</span> <span m=''2104780''>this.</span> <span m=''2105170''>Add</span>
  <span m=''2105380''>the</span> <span m=''2105460''>two</span> <span m=''2105610''>values</span>
  <span m=''2105990''>together.</span> <span m=''2106330''>Call</span> <span m=''2106610''>the</span>
  <span m=''2107020''>return</span> <span m=''2107460''>there.</span> <span m=''2107780''>And</span>
  <span m=''2107890''>so</span> <span m=''2108080''>forth.</span> <span m=''2108260''>You</span>
  <span m=''2108370''>walk</span> <span m=''2108750''>that</span> <span m=''2109290''>using</span>
  <span m=''2109620''>a</span> <span m=''2109670''>stack,</span> <span m=''2110340''>a</span>
  <span m=''2110650''>call</span> <span m=''2111120''>stack,</span> <span m=''2111590''>in</span>
  <span m=''2111750''>the</span> <span m=''2111870''>execution.</span> </p><p><span
  m=''2115240''>The</span> <span m=''2115350''>key</span> <span m=''2115620''>idea</span>
  <span m=''2116050''>for</span> <span m=''2116230''>parallelization</span> <span
  m=''2117190''>is,</span> <span m=''2117440''>well,</span> <span m=''2117800''>gee.</span>
  <span m=''2119550''>Fib</span> <span m=''2119740''>of</span> <span m=''2119920''>n</span>
  <span m=''2120050''>minus</span> <span m=''2120420''>1</span> <span m=''2120840''>and</span>
  <span m=''2120970''>fib</span> <span m=''2121210''>of</span> <span m=''2121300''>n</span>
  <span m=''2121440''>minus</span> <span m=''2121820''>2</span> <span m=''2121980''>are</span>
  <span m=''2122335''>really,</span> <span m=''2122690''>in</span> <span m=''2122900''>this</span>
  <span m=''2123390''>calculation,</span> <span m=''2124080''>completely</span> <span
  m=''2124570''>independently</span> <span m=''2125240''>calculated.</span> <span
  m=''2126420''>So</span> <span m=''2126530''>let''s</span> <span m=''2126690''>just</span>
  <span m=''2126870''>do</span> <span m=''2127140''>them</span> <span m=''2127210''>at
  the</span> <span m=''2127290''>same</span> <span m=''2127580''>time.</span> <span
  m=''2131040''>And</span> <span m=''2132660''>they</span> <span m=''2132930''>can</span>
  <span m=''2133070''>be</span> <span m=''2133200''>executed</span> <span m=''2134320''>at</span>
  <span m=''2134490''>the</span> <span m=''2134580''>same</span> <span m=''2134810''>time</span>
  <span m=''2135120''>without</span> <span m=''2135590''>interference,</span> <span
  m=''2136290''>because</span> <span m=''2136600''>all</span> <span m=''2136790''>they''re</span>
  <span m=''2136900''>doing</span> <span m=''2137220''>is</span> <span m=''2137350''>basing</span>
  <span m=''2137730''>it</span> <span m=''2137850''>on</span> <span m=''2138050''>n.</span>
  <span m=''2138290''>They''re</span> <span m=''2138410''>not</span> <span m=''2138710''>using</span>
  <span m=''2139150''>any</span> <span m=''2139320''>shared</span> <span m=''2139670''>memory</span>
  <span m=''2140010''>or</span> <span m=''2140110''>anything</span> <span m=''2140430''>even</span>
  <span m=''2141110''>for</span> <span m=''2141220''>this</span> <span m=''2141400''>particular</span>
  <span m=''2141780''>program.</span> </p><p><span m=''2143800''>So</span> <span m=''2143960''>let''s</span>
  <span m=''2144200''>take</span> <span m=''2144420''>a</span> <span m=''2144480''>look,</span>
  <span m=''2144680''>to</span> <span m=''2144770''>begin</span> <span m=''2145090''>with,</span>
  <span m=''2145230''>how</span> <span m=''2145450''>Pthreads</span> <span m=''2146090''>might</span>
  <span m=''2146330''>do</span> <span m=''2146480''>this.</span> <span m=''2148320''>So</span>
  <span m=''2148500''>Pthreads</span> <span m=''2149390''>is</span> <span m=''2149900''>a</span>
  <span m=''2150530''>standard</span> <span m=''2152090''>that</span> <span m=''2153980''>ANSI</span>
  <span m=''2154330''>and the</span> <span m=''2154560''>IEEE</span> <span m=''2155200''>have</span>
  <span m=''2156090''>established</span> <span m=''2157460''>for--</span> <span m=''2158550''>and</span>
  <span m=''2158750''>I</span> <span m=''2159020''>actually</span> <span m=''2159300''>believe</span>
  <span m=''2159640''>this</span> <span m=''2159840''>is</span> <span m=''2160200''>a</span>
  <span m=''2160330''>little</span> <span m=''2160530''>bit</span> <span m=''2160660''>out</span>
  <span m=''2160860''>of date.</span> <span m=''2160960''>I</span> <span m=''2161070''>believe</span>
  <span m=''2161350''>there''s</span> <span m=''2161520''>now</span> <span m=''2161730''>a</span>
  <span m=''2161810''>2010</span> <span m=''2162880''>version.</span> <span m=''2163700''>I''m</span>
  <span m=''2163820''>not</span> <span m=''2164030''>sure.</span> <span m=''2165870''>But</span>
  <span m=''2165990''>I</span> <span m=''2166030''>recall</span> <span m=''2166440''>that</span>
  <span m=''2166580''>they</span> <span m=''2166700''>were</span> <span m=''2166840''>working</span>
  <span m=''2167190''>on</span> <span m=''2167320''>a</span> <span m=''2167390''>new</span>
  <span m=''2167550''>version.</span> </p><p><span m=''2167990''>But</span> <span
  m=''2168130''>anyway,</span> <span m=''2168400''>this</span> <span m=''2168590''>is</span>
  <span m=''2169040''>a</span> <span m=''2169330''>recent</span> <span m=''2169630''>enough</span>
  <span m=''2169880''>standard.</span> <span m=''2170330''>It''s</span> <span m=''2170470''>a</span>
  <span m=''2170560''>standard</span> <span m=''2170990''>that has</span> <span m=''2171170''>been</span>
  <span m=''2171320''>revised</span> <span m=''2171870''>over</span> <span m=''2172100''>the</span>
  <span m=''2172210''>years,</span> <span m=''2173170''>the</span> <span m=''2173520''>so-called</span>
  <span m=''2174780''>POSIX</span> <span m=''2175470''>standard.</span> <span m=''2175980''>So</span>
  <span m=''2176080''>you''ll</span> <span m=''2176240''>hear,</span> <span m=''2176730''>Pthreads</span>
  <span m=''2177380''>is</span> <span m=''2177560''>basically</span> <span m=''2178000''>POSIX</span>
  <span m=''2178560''>threads.</span> <span m=''2181020''>It''s</span> <span m=''2181210''>basically</span>
  <span m=''2181700''>what</span> <span m=''2181860''>you</span> <span m=''2181950''>might</span>
  <span m=''2182210''>characterize</span> <span m=''2182890''>as</span> <span m=''2183030''>a</span>
  <span m=''2183110''>do</span> <span m=''2183300''>it</span> <span m=''2183530''>yourself</span>
  <span m=''2184020''>concurrency</span> <span m=''2184640''>platform.</span> <span
  m=''2185920''>It''s</span> <span m=''2186110''>kind</span> <span m=''2186380''>of</span>
  <span m=''2186460''>like</span> <span m=''2186680''>assembly</span> <span m=''2187170''>language</span>
  <span m=''2187890''>for</span> <span m=''2188290''>parallelism.</span> </p><p><span
  m=''2190370''>It</span> <span m=''2191120''>allows</span> <span m=''2191500''>you</span>
  <span m=''2191630''>to</span> <span m=''2191720''>do</span> <span m=''2191920''>the</span>
  <span m=''2192040''>things</span> <span m=''2192310''>you</span> <span m=''2192380''>need</span>
  <span m=''2192590''>to</span> <span m=''2192680''>do,</span> <span m=''2193590''>but</span>
  <span m=''2193880''>you''re</span> <span m=''2194000''>sort</span> <span m=''2194200''>of</span>
  <span m=''2194280''>doing</span> <span m=''2194570''>it</span> <span m=''2194650''>all</span>
  <span m=''2194870''>by</span> <span m=''2195030''>hand,</span> <span m=''2195800''>one</span>
  <span m=''2196060''>step</span> <span m=''2196340''>at</span> <span m=''2196420''>a</span>
  <span m=''2196510''>time.</span> <span m=''2198230''>It''s</span> <span m=''2198430''>built</span>
  <span m=''2198740''>as</span> <span m=''2198850''>a</span> <span m=''2198920''>library</span>
  <span m=''2199400''>of</span> <span m=''2199500''>functions</span> <span m=''2200050''>with</span>
  <span m=''2200200''>special</span> <span m=''2201320''>non-C</span> <span m=''2202190''>or</span>
  <span m=''2202540''>C++</span> <span m=''2203100''>semantics.</span> <span m=''2210760''>And</span>
  <span m=''2211200''>we''ll</span> <span m=''2211320''>look</span> <span m=''2211540''>at</span>
  <span m=''2211630''>what</span> <span m=''2211810''>some</span> <span m=''2211940''>of</span>
  <span m=''2211990''>those</span> <span m=''2212150''>semantics</span> <span m=''2212650''>are.</span>
  </p><p><span m=''2213650''>Each</span> <span m=''2213930''>thread</span> <span m=''2214200''>implements
  an</span> <span m=''2214690''>abstraction</span> <span m=''2215350''>of</span> <span
  m=''2215430''>a</span> <span m=''2215490''>processor,</span> <span m=''2217670''>which</span>
  <span m=''2218140''>are</span> <span m=''2218210''>multiplexed</span> <span m=''2218870''>onto</span>
  <span m=''2219110''>the</span> <span m=''2219210''>machine</span> <span m=''2219580''>resources</span>
  <span m=''2221070''>by</span> <span m=''2221350''>the</span> <span m=''2221640''>Pthread</span>
  <span m=''2222400''>runtime</span> <span m=''2222890''>implementation.</span> <span
  m=''2225700''>Threads</span> <span m=''2226130''>communicate</span> <span m=''2226790''>through</span>
  <span m=''2226980''>shared</span> <span m=''2227390''>memory.</span> <span m=''2228800''>And</span>
  <span m=''2229630''>library</span> <span m=''2230170''>functions</span> <span m=''2230730''>mask</span>
  <span m=''2231200''>the</span> <span m=''2231290''>protocols</span> <span m=''2232160''>involved</span>
  <span m=''2232820''>in</span> <span m=''2233090''>interthread</span> <span m=''2234190''>coordination.</span>
  <span m=''2235680''>So</span> <span m=''2237550''>you</span> <span m=''2237780''>can</span>
  <span m=''2238350''>start</span> <span m=''2238800''>up</span> <span m=''2238980''>threads,</span>
  <span m=''2239430''>et</span> <span m=''2239580''>cetera,</span> <span m=''2239750''>and
  their</span> <span m=''2239880''>library</span> <span m=''2240290''>function</span>
  <span m=''2240640''>for</span> <span m=''2240770''>doing</span> <span m=''2240990''>that.</span>
  <span m=''2241230''>So</span> <span m=''2241350''>let''s</span> <span m=''2241530''>just</span>
  <span m=''2241810''>see</span> <span m=''2242000''>how</span> <span m=''2242190''>that</span>
  <span m=''2242370''>works.</span> </p><p><span m=''2243310''>So</span> <span m=''2243440''>here</span>
  <span m=''2243800''>are,</span> <span m=''2244730''>basically,</span> <span m=''2245280''>the</span>
  <span m=''2245510''>two</span> <span m=''2245860''>important</span> <span m=''2247480''>Pthread</span>
  <span m=''2249210''>functions.</span> <span m=''2249800''>There</span> <span m=''2250030''>are</span>
  <span m=''2250120''>actually</span> <span m=''2250370''>a</span> <span m=''2250410''>whole</span>
  <span m=''2250670''>bunch</span> <span m=''2250970''>of</span> <span m=''2251060''>them,</span>
  <span m=''2251230''>because</span> <span m=''2251460''>they</span> <span m=''2251560''>also</span>
  <span m=''2251800''>provide</span> <span m=''2252230''>a</span> <span m=''2252420''>bunch</span>
  <span m=''2252720''>of</span> <span m=''2252820''>other</span> <span m=''2252990''>facilities.</span>
  <span m=''2254730''>One</span> <span m=''2255030''>is</span> <span m=''2255170''>pthread_create,</span>
  <span m=''2256570''>which</span> <span m=''2256770''>creates</span> <span m=''2257430''>Pthread.</span>
  <span m=''2258200''>And</span> <span m=''2258340''>one</span> <span m=''2258540''>is</span>
  <span m=''2258680''>pthread_join.</span> </p><p><span m=''2261620''>So</span> <span
  m=''2262450''>pthread_create</span> <span m=''2264420''>basically</span> <span m=''2268380''>is</span>
  <span m=''2268600''>return</span> <span m=''2269240''>an</span> <span m=''2269390''>identifier.</span>
  <span m=''2269990''>So</span> <span m=''2270110''>when</span> <span m=''2270220''>you</span>
  <span m=''2270310''>say</span> <span m=''2270500''>create</span> <span m=''2270950''>a</span>
  <span m=''2271020''>Pthread,</span> <span m=''2272200''>the</span> <span m=''2272510''>Pthread</span>
  <span m=''2272790''>system</span> <span m=''2273160''>says,</span> <span m=''2273530''>here''s</span>
  <span m=''2273770''>a</span> <span m=''2273800''>handle</span> <span m=''2274360''>by</span>
  <span m=''2274520''>which</span> <span m=''2274750''>you</span> <span m=''2274880''>can</span>
  <span m=''2275020''>name</span> <span m=''2275280''>this</span> <span m=''2275540''>thread</span>
  <span m=''2275790''>in</span> <span m=''2275860''>the</span> <span m=''2275940''>future.</span>
  <span m=''2277420''>OK.</span> <span m=''2277660''>So</span> <span m=''2277800''>it''s</span>
  <span m=''2277910''>a</span> <span m=''2277960''>very</span> <span m=''2278250''>common</span>
  <span m=''2278660''>thing</span> <span m=''2278920''>that</span> <span m=''2279350''>the</span>
  <span m=''2279550''>implementer</span> <span m=''2280170''>says,</span> <span m=''2280490''>here''s</span>
  <span m=''2280790''>the</span> <span m=''2280900''>name</span> <span m=''2281300''>that
  you</span> <span m=''2281450''>get.</span> <span m=''2281730''>It''s called</span>
  <span m=''2281910''>a</span> <span m=''2281930''>handle.</span> </p><p><span m=''2282850''>So
  it</span> <span m=''2282960''>returns</span> <span m=''2283260''>a</span> <span
  m=''2283370''>handle.</span> <span m=''2285640''>It</span> <span m=''2286080''>then</span>
  <span m=''2286330''>has</span> <span m=''2289360''>an</span> <span m=''2289440''>object</span>
  <span m=''2289940''>to</span> <span m=''2290020''>set</span> <span m=''2290600''>various</span>
  <span m=''2290980''>thread</span> <span m=''2291270''>attributes.</span> <span m=''2292020''>And</span>
  <span m=''2292370''>for</span> <span m=''2292570''>most</span> <span m=''2292980''>of</span>
  <span m=''2293060''>what</span> <span m=''2293230''>we''re</span> <span m=''2293350''>going</span>
  <span m=''2293430''>to</span> <span m=''2293520''>need,</span> <span m=''2293900''>we''re</span>
  <span m=''2294040''>just</span> <span m=''2294250''>going</span> <span m=''2294350''>to</span>
  <span m=''2294420''>need</span> <span m=''2294690''>NULL</span> <span m=''2295350''>for</span>
  <span m=''2295470''>default.</span> <span m=''2295860''>We</span> <span m=''2295960''>don''t</span>
  <span m=''2296190''>need</span> <span m=''2296400''>any</span> <span m=''2296600''>special</span>
  <span m=''2297010''>things</span> <span m=''2297380''>like</span> <span m=''2297890''>changing</span>
  <span m=''2298300''>the</span> <span m=''2298390''>priority</span> <span m=''2299580''>or</span>
  <span m=''2299830''>what</span> <span m=''2300010''>have</span> <span m=''2300220''>you.</span>
  </p><p><span m=''2301720''>Then</span> <span m=''2301900''>what</span> <span m=''2302060''>you</span>
  <span m=''2302180''>pass</span> <span m=''2302630''>is</span> <span m=''2304104''>a</span>
  <span m=''2305030''>void*</span> <span m=''2305960''>pointer</span> <span m=''2306400''>to</span>
  <span m=''2306520''>a</span> <span m=''2306640''>function,</span> <span m=''2308170''>which</span>
  <span m=''2308390''>is</span> <span m=''2308500''>going</span> <span m=''2308570''>to</span>
  <span m=''2308640''>be</span> <span m=''2308720''>the</span> <span m=''2308810''>routine</span>
  <span m=''2309330''>executed</span> <span m=''2310060''>after</span> <span m=''2310410''>creation.</span>
  <span m=''2312360''>So</span> <span m=''2312470''>you</span> <span m=''2312570''>can</span>
  <span m=''2312790''>name</span> <span m=''2313140''>the</span> <span m=''2313230''>function</span>
  <span m=''2313710''>that</span> <span m=''2313850''>you</span> <span m=''2313960''>want</span>
  <span m=''2314160''>to</span> <span m=''2314990''>have</span> <span m=''2315220''>it</span>
  <span m=''2315310''>operate</span> <span m=''2315840''>on.</span> <span m=''2319220''>And</span>
  <span m=''2319540''>then</span> <span m=''2319760''>you</span> <span m=''2319880''>have</span>
  <span m=''2320090''>a</span> <span m=''2320140''>single</span> <span m=''2320910''>pointer</span>
  <span m=''2321260''>to</span> <span m=''2321550''>an</span> <span m=''2321660''>argument</span>
  <span m=''2321975''>that</span> <span m=''2322290''>you''re</span> <span m=''2322420''>going</span>
  <span m=''2322500''>to</span> <span m=''2322580''>pass</span> <span m=''2322990''>to</span>
  <span m=''2323090''>the</span> <span m=''2323210''>function.</span> </p><p><span
  m=''2326710''>So</span> <span m=''2327730''>when</span> <span m=''2327930''>you</span>
  <span m=''2328060''>call</span> <span m=''2328390''>something</span> <span m=''2328690''>with</span>
  <span m=''2328850''>Pthreads</span> <span m=''2329300''>to</span> <span m=''2329400''>create</span>
  <span m=''2329740''>them,</span> <span m=''2329860''>you</span> <span m=''2329980''>can''t</span>
  <span m=''2330260''>say,</span> <span m=''2330450''>and</span> <span m=''2330630''>here''s</span>
  <span m=''2330910''>my</span> <span m=''2331050''>list</span> <span m=''2331330''>of</span>
  <span m=''2331410''>arguments.</span> <span m=''2333070''>If</span> <span m=''2333180''>you</span>
  <span m=''2333270''>have</span> <span m=''2333380''>more</span> <span m=''2333620''>than</span>
  <span m=''2333790''>one</span> <span m=''2333970''>argument,</span> <span m=''2334780''>you</span>
  <span m=''2334920''>have</span> <span m=''2335040''>to</span> <span m=''2335150''>pack</span>
  <span m=''2335430''>it</span> <span m=''2335610''>together</span> <span m=''2336050''>into</span>
  <span m=''2336490''>a</span> <span m=''2336990''>struct</span> <span m=''2337990''>and</span>
  <span m=''2338190''>pass</span> <span m=''2338570''>the</span> <span m=''2338670''>pointer</span>
  <span m=''2339100''>to</span> <span m=''2339230''>the</span> <span m=''2339330''>struct.</span>
  <span m=''2340380''>And</span> <span m=''2340490''>this</span> <span m=''2340700''>function</span>
  <span m=''2341130''>has</span> <span m=''2341370''>to</span> <span m=''2341470''>be</span>
  <span m=''2341590''>smart</span> <span m=''2341900''>enough</span> <span m=''2342080''>to</span>
  <span m=''2342180''>understand</span> <span m=''2342680''>how</span> <span m=''2342830''>to</span>
  <span m=''2342920''>unpack</span> <span m=''2343215''>it.</span> <span m=''2344470''>We''ll</span>
  <span m=''2344610''>see</span> <span m=''2344800''>an</span> <span m=''2344850''>example</span>
  <span m=''2345300''>in</span> <span m=''2345340''>a</span> <span m=''2345380''>minute.</span>
  </p><p><span m=''2347150''>And</span> <span m=''2347310''>then,</span> <span m=''2347450''>it</span>
  <span m=''2347540''>returns</span> <span m=''2347980''>an</span> <span m=''2348090''>error</span>
  <span m=''2348330''>status.</span> <span m=''2349620''>So</span> <span m=''2349730''>the</span>
  <span m=''2349790''>most</span> <span m=''2350020''>common</span> <span m=''2350360''>thing</span>
  <span m=''2350590''>people</span> <span m=''2350910''>do</span> <span m=''2351060''>is</span>
  <span m=''2351190''>they</span> <span m=''2351300''>don''t</span> <span m=''2351530''>bother</span>
  <span m=''2351810''>to</span> <span m=''2351920''>check</span> <span m=''2352170''>the</span>
  <span m=''2352310''>error</span> <span m=''2352490''>status.</span> <span m=''2354140''>OK.</span>
  <span m=''2354610''>And</span> <span m=''2354900''>yet</span> <span m=''2355190''>sometimes,</span>
  <span m=''2355600''>you</span> <span m=''2355670''>try</span> <span m=''2355840''>to</span>
  <span m=''2355920''>create a</span> <span m=''2356330''>Pthread,</span> <span m=''2356740''>there''s</span>
  <span m=''2356890''>a</span> <span m=''2356950''>reason</span> <span m=''2357680''>it</span>
  <span m=''2357840''>can''t</span> <span m=''2358060''>create</span> <span m=''2358480''>one.</span>
  <span m=''2358810''>And</span> <span m=''2358970''>now</span> <span m=''2359100''>you</span>
  <span m=''2359270''>keep</span> <span m=''2359500''>going</span> <span m=''2359800''>thinking</span>
  <span m=''2360150''>you</span> <span m=''2360350''>have</span> <span m=''2360560''>one,</span>
  <span m=''2361150''>and</span> <span m=''2361300''>then</span> <span m=''2361900''>your</span>
  <span m=''2362110''>program</span> <span m=''2362520''>crashes</span> <span m=''2362990''>and</span>
  <span m=''2363130''>you wonder</span> <span m=''2363410''>why.</span> </p><p><span
  m=''2364640''>So</span> <span m=''2364910''>when</span> <span m=''2365090''>you</span>
  <span m=''2365170''>create</span> <span m=''2365490''>things,</span> <span m=''2365660''>you</span>
  <span m=''2365750''>should</span> <span m=''2366000''>check.</span> <span m=''2366990''>I''m</span>
  <span m=''2367130''>not</span> <span m=''2367300''>sure</span> <span m=''2367510''>in</span>
  <span m=''2367610''>my</span> <span m=''2368960''>code</span> <span m=''2369210''>here</span>
  <span m=''2369430''>whether</span> <span m=''2369660''>I</span> <span m=''2369730''>checked</span>
  <span m=''2370070''>everywhere.</span> <span m=''2371540''>But</span> <span m=''2371900''>you</span>
  <span m=''2372120''>should</span> <span m=''2372360''>check.</span> <span m=''2373700''>Do</span>
  <span m=''2373860''>as</span> <span m=''2374000''>I</span> <span m=''2374140''>say,</span>
  <span m=''2374410''>not</span> <span m=''2374670''>as</span> <span m=''2374810''>I</span>
  <span m=''2374930''>do.</span> <span m=''2376720''>OK.</span> <span m=''2377670''>So</span>
  <span m=''2377820''>the</span> <span m=''2377970''>other</span> <span m=''2378220''>key</span>
  <span m=''2378430''>function</span> <span m=''2378810''>is</span> <span m=''2379020''>join.</span>
  <span m=''2380280''>And</span> <span m=''2380440''>basically,</span> <span m=''2380900''>what</span>
  <span m=''2381080''>you</span> <span m=''2381220''>do</span> <span m=''2381360''>is</span>
  <span m=''2381480''>you</span> <span m=''2381610''>say,</span> <span m=''2382100''>you</span>
  <span m=''2382260''>name</span> <span m=''2382660''>the</span> <span m=''2382760''>thread</span>
  <span m=''2383310''>that you</span> <span m=''2383530''>want</span> <span m=''2383900''>to</span>
  <span m=''2384010''>wait</span> <span m=''2384380''>for.</span> <span m=''2384900''>This</span>
  <span m=''2385190''>is</span> <span m=''2385310''>the</span> <span m=''2385410''>name</span>
  <span m=''2385700''>that</span> <span m=''2385870''>would</span> <span m=''2386010''>be</span>
  <span m=''2386180''>returned</span> <span m=''2386680''>by</span> <span m=''2386980''>the</span>
  <span m=''2388070''>create</span> <span m=''2388620''>function.</span> </p><p><span
  m=''2389700''>And</span> <span m=''2393030''>you</span> <span m=''2393240''>also</span>
  <span m=''2393920''>give</span> <span m=''2394140''>a</span> <span m=''2395530''>place</span>
  <span m=''2395960''>where</span> <span m=''2396120''>it</span> <span m=''2396240''>can</span>
  <span m=''2396370''>store</span> <span m=''2396760''>the</span> <span m=''2397250''>status</span>
  <span m=''2397860''>of</span> <span m=''2397950''>the</span> <span m=''2398040''>thread</span>
  <span m=''2398430''>when</span> <span m=''2398580''>it</span> <span m=''2398700''>terminated.</span>
  <span m=''2401000''>It''s</span> <span m=''2401160''>allowed</span> <span m=''2401420''>to</span>
  <span m=''2401500''>say,</span> <span m=''2401800''>I</span> <span m=''2402260''>terminated</span>
  <span m=''2402840''>normally.</span> <span m=''2403290''>I</span> <span m=''2403380''>terminated</span>
  <span m=''2403960''>with</span> <span m=''2404060''>a</span> <span m=''2404160''>given</span>
  <span m=''2404540''>error</span> <span m=''2404750''>condition or</span> <span m=''2405220''>whatever.</span>
  <span m=''2405950''>But</span> <span m=''2406100''>if</span> <span m=''2406170''>you</span>
  <span m=''2406280''>don''t</span> <span m=''2406500''>care</span> <span m=''2406770''>what</span>
  <span m=''2406950''>it</span> <span m=''2407060''>is,</span> <span m=''2407310''>you</span>
  <span m=''2407430''>just</span> <span m=''2407600''>put</span> <span m=''2407740''>in</span>
  <span m=''2407950''>NULL</span> <span m=''2408110''>there.</span> <span m=''2408990''>And</span>
  <span m=''2409250''>then</span> <span m=''2409380''>it</span> <span m=''2409620''>returns</span>
  <span m=''2410080''>to the</span> <span m=''2410180''>error</span> <span m=''2410610''>status</span>
  <span m=''2411150''>of</span> <span m=''2411320''>the</span> <span m=''2411400''>join</span>
  <span m=''2411760''>function.</span> <span m=''2413230''>So</span> <span m=''2413380''>those</span>
  <span m=''2413620''>are</span> <span m=''2413820''>the</span> <span m=''2414040''>two</span>
  <span m=''2414400''>functions</span> <span m=''2414960''>that</span> <span m=''2415020''>you</span>
  <span m=''2415110''>program</span> <span m=''2415410''>with.</span> <span m=''2415560''>Question?</span>
  </p><p><span m=''2416408''>AUDIENCE: [INAUDIBLE PHRASE]?</span> </p><p><span m=''2421090''>PROFESSOR:
  It''s</span> <span m=''2421260''>different.</span> <span m=''2422170''>It''s</span>
  <span m=''2422340''>different.</span> <span m=''2422690''>So</span> <span m=''2422820''>it''s</span>
  <span m=''2423000''>basically,</span> <span m=''2424190''>if</span> <span m=''2424360''>the</span>
  <span m=''2425000''>error</span> <span m=''2425360''>status,</span> <span m=''2425730''>if</span>
  <span m=''2425820''>it</span> <span m=''2425920''>returns</span> <span m=''2426350''>NULL,</span>
  <span m=''2427440''>it</span> <span m=''2427870''>just</span> <span m=''2428070''>means</span>
  <span m=''2428300''>everything</span> <span m=''2428660''>went</span> <span m=''2428800''>OK.</span>
  <span m=''2433710''>The</span> <span m=''2433870''>handle</span> <span m=''2434310''>is</span>
  <span m=''2434790''>you</span> <span m=''2434900''>pass</span> <span m=''2435270''>a</span>
  <span m=''2435350''>name,</span> <span m=''2435750''>and</span> <span m=''2435850''>basically</span>
  <span m=''2436300''>this</span> <span m=''2436450''>is</span> <span m=''2436580''>*thread.</span>
  <span m=''2437800''>It</span> <span m=''2437970''>stuffs</span> <span m=''2438430''>the</span>
  <span m=''2438540''>name</span> <span m=''2438960''>into</span> <span m=''2439210''>whatever</span>
  <span m=''2440670''>you</span> <span m=''2440860''>give</span> <span m=''2441070''>it.</span>
  </p><p><span m=''2441790''>OK</span> <span m=''2442090''>so</span> <span m=''2442240''>you''re</span>
  <span m=''2442620''>not</span> <span m=''2442910''>saying,</span> <span m=''2443220''>here''s</span>
  <span m=''2443600''>the</span> <span m=''2443770''>name.</span> <span m=''2444070''>This</span>
  <span m=''2444230''>is</span> <span m=''2444350''>returned</span> <span m=''2446200''>as</span>
  <span m=''2446440''>an</span> <span m=''2446510''>output</span> <span m=''2446910''>parameter.</span>
  <span m=''2447430''>So</span> <span m=''2447580''>you''re</span> <span m=''2447750''>giving</span>
  <span m=''2448110''>it</span> <span m=''2449090''>an</span> <span m=''2449290''>address</span>
  <span m=''2449790''>of</span> <span m=''2449850''>some</span> <span m=''2450040''>place</span>
  <span m=''2450330''>to</span> <span m=''2450410''>put</span> <span m=''2451410''>the</span>
  <span m=''2451520''>name.</span> <span m=''2452560''>OK.</span> <span m=''2452690''>Let''s</span>
  <span m=''2452800''>see</span> <span m=''2452940''>an</span> <span m=''2452980''>example.</span>
  <span m=''2454270''>So</span> <span m=''2454390''>here''s</span> <span m=''2455270''>Fibonacci</span>
  <span m=''2457340''>with</span> <span m=''2457580''>Pthreads.</span> <span m=''2459840''>So</span>
  <span m=''2460010''>let''s</span> <span m=''2460180''>just</span> <span m=''2460400''>go</span>
  <span m=''2460560''>through</span> <span m=''2460850''>that.</span> <span m=''2462280''>So</span>
  <span m=''2462490''>the</span> <span m=''2462590''>first</span> <span m=''2462940''>part</span>
  <span m=''2463170''>is</span> <span m=''2465970''>pretty</span> <span m=''2466160''>good.</span>
  <span m=''2466330''>This</span> <span m=''2466470''>is</span> <span m=''2466520''>your</span>
  <span m=''2466640''>original</span> <span m=''2467180''>code</span> <span m=''2468960''>that</span>
  <span m=''2469540''>does</span> <span m=''2469730''>Fibonacci.</span> <span m=''2471750''>And</span>
  <span m=''2471950''>now</span> <span m=''2473050''>what</span> <span m=''2473250''>we</span>
  <span m=''2473390''>do</span> <span m=''2473720''>is</span> <span m=''2473990''>we</span>
  <span m=''2474170''>have</span> <span m=''2475140''>a</span> <span m=''2475250''>structure</span>
  <span m=''2475930''>for</span> <span m=''2476120''>the</span> <span m=''2476240''>thread</span>
  <span m=''2476570''>arguments.</span> </p><p><span m=''2477750''>And</span> <span
  m=''2477880''>so</span> <span m=''2478000''>we''re</span> <span m=''2478070''>going</span>
  <span m=''2478150''>to</span> <span m=''2478300''>have</span> <span m=''2478460''>an</span>
  <span m=''2478640''>input</span> <span m=''2479020''>argument</span> <span m=''2479430''>and</span>
  <span m=''2479630''>an</span> <span m=''2479740''>output</span> <span m=''2480110''>argument</span>
  <span m=''2480500''>in</span> <span m=''2480610''>this</span> <span m=''2480760''>example.</span>
  <span m=''2481500''>Because</span> <span m=''2481820''>Fib</span> <span m=''2482180''>takes</span>
  <span m=''2482690''>an</span> <span m=''2482860''>input</span> <span m=''2483100''>argument</span>
  <span m=''2483550''>in</span> <span m=''2483830''>and</span> <span m=''2483980''>returns</span>
  <span m=''2485095''>Fib</span> <span m=''2485690''>of</span> <span m=''2485850''>n.</span>
  <span m=''2487280''>So</span> <span m=''2487500''>we''re</span> <span m=''2487640''>going</span>
  <span m=''2487740''>to</span> <span m=''2487810''>call</span> <span m=''2488050''>those</span>
  <span m=''2488260''>input</span> <span m=''2488620''>and</span> <span m=''2488720''>output.</span>
  <span m=''2489180''>And</span> <span m=''2489320''>we''ll</span> <span m=''2489440''>call</span>
  <span m=''2489710''>them</span> <span m=''2489850''>thread_args.</span> <span m=''2491570''>And</span>
  <span m=''2491710''>now,</span> <span m=''2491870''>here</span> <span m=''2492250''>is</span>
  <span m=''2492640''>my</span> <span m=''2492870''>void*</span> <span m=''2493540''>function,</span>
  <span m=''2496350''>thread_func,</span> <span m=''2497220''>which</span> <span m=''2497660''>takes</span>
  <span m=''2498130''>a</span> <span m=''2498950''>pointer.</span> <span m=''2499790''>And</span>
  <span m=''2499900''>what</span> <span m=''2500070''>it</span> <span m=''2500200''>does</span>
  <span m=''2500710''>is</span> <span m=''2502050''>when</span> <span m=''2502400''>it</span>
  <span m=''2502570''>executes--</span> <span m=''2503980''>so what</span> <span m=''2504180''>you''re</span>
  <span m=''2504310''>going</span> <span m=''2504450''>to</span> <span m=''2504490''>be</span>
  <span m=''2504580''>able</span> <span m=''2504660''>to</span> <span m=''2504700''>do</span>
  <span m=''2504880''>is,</span> <span m=''2505510''>as</span> <span m=''2505740''>we''ll</span>
  <span m=''2505840''>see</span> <span m=''2506000''>in</span> <span m=''2506070''>a</span>
  <span m=''2506120''>minute--.</span> <span m=''2507300''>Let</span> <span m=''2507730''>me</span>
  <span m=''2507830''>just</span> <span m=''2508010''>go</span> <span m=''2508120''>through</span>
  <span m=''2508270''>this.</span> <span m=''2508910''>This is</span> <span m=''2509110''>going</span>
  <span m=''2509170''>to</span> <span m=''2509240''>be</span> <span m=''2509340''>the</span>
  <span m=''2509410''>function</span> <span m=''2509860''>called</span> <span m=''2510380''>when</span>
  <span m=''2510530''>the</span> <span m=''2510610''>thread</span> <span m=''2510940''>is</span>
  <span m=''2511090''>created.</span> </p><p><span m=''2512140''>So when</span> <span
  m=''2512370''>the</span> <span m=''2512510''>thread</span> <span m=''2512930''>is</span>
  <span m=''2513050''>created,</span> <span m=''2513160''>you''re just going to</span>
  <span m=''2513230''>call</span> <span m=''2513630''>this</span> <span m=''2513860''>function.</span>
  <span m=''2514990''>And</span> <span m=''2515410''>what</span> <span m=''2515550''>it''s</span>
  <span m=''2515710''>going</span> <span m=''2515830''>to</span> <span m=''2515870''>get</span>
  <span m=''2516430''>is</span> <span m=''2517020''>the</span> <span m=''2518240''>argument</span>
  <span m=''2518535''>that</span> <span m=''2518830''>was</span> <span m=''2519010''>passed,</span>
  <span m=''2520150''>which</span> <span m=''2520330''>is</span> <span m=''2520680''>this</span>
  <span m=''2520980''>*star</span> <span m=''2523150''>thing.</span> <span m=''2523660''>And
  what</span> <span m=''2523900''>it</span> <span m=''2524020''>does</span> <span
  m=''2524310''>in</span> <span m=''2524400''>this</span> <span m=''2524610''>case</span>
  <span m=''2525230''>is it''s</span> <span m=''2525370''>basically</span> <span m=''2525820''>going</span>
  <span m=''2525930''>to</span> <span m=''2526050''>cast</span> <span m=''2526930''>the</span>
  <span m=''2527120''>pointer</span> <span m=''2528680''>to</span> <span m=''2528850''>a</span>
  <span m=''2528900''>thread_arg</span> <span m=''2529250''>struct</span> <span m=''2531900''>and</span>
  <span m=''2532140''>dereference</span> <span m=''2533070''>the</span> <span m=''2533220''>input,</span>
  <span m=''2534290''>and</span> <span m=''2534460''>stick</span> <span m=''2534740''>that</span>
  <span m=''2534960''>into</span> <span m=''2535250''>I.</span> <span m=''2536200''>Then</span>
  <span m=''2536470''>going</span> <span m=''2536570''>to</span> <span m=''2536630''>compute</span>
  <span m=''2537170''>Fib</span> <span m=''2537380''>of</span> <span m=''2537450''>I.</span>
  <span m=''2538480''>And</span> <span m=''2538620''>then</span> <span m=''2538750''>it''s</span>
  <span m=''2538900''>going</span> <span m=''2539010''>to</span> <span m=''2539120''>take,</span>
  <span m=''2539500''>once</span> <span m=''2539710''>again,</span> <span m=''2540130''>deference</span>
  <span m=''2540920''>the</span> <span m=''2541150''>pointer</span> <span m=''2541940''>as</span>
  <span m=''2542140''>if</span> <span m=''2542240''>it''s</span> <span m=''2542420''>a</span>
  <span m=''2542490''>thread_arg,</span> <span m=''2543910''>and</span> <span m=''2544100''>store</span>
  <span m=''2544510''>into</span> <span m=''2544710''>the</span> <span m=''2545150''>output</span>
  <span m=''2545360''>field</span> <span m=''2546540''>the</span> <span m=''2546660''>result</span>
  <span m=''2547070''>of</span> <span m=''2547160''>the</span> <span m=''2547260''>Fib.</span>
  <span m=''2549190''>And</span> <span m=''2549380''>then</span> <span m=''2549530''>it</span>
  <span m=''2549650''>returns</span> <span m=''2550200''>NULL.</span> </p><p><span
  m=''2554060''>So</span> <span m=''2554230''>that''s</span> <span m=''2554500''>basically</span>
  <span m=''2555360''>the</span> <span m=''2555490''>function</span> <span m=''2555860''>that''s</span>
  <span m=''2555970''>going to</span> <span m=''2556070''>be</span> <span m=''2556170''>called</span>
  <span m=''2556490''>when</span> <span m=''2556610''>the</span> <span m=''2556700''>thread</span>
  <span m=''2556980''>is</span> <span m=''2557110''>created.</span> <span m=''2557910''>So</span>
  <span m=''2558070''>in</span> <span m=''2558270''>your</span> <span m=''2558420''>main</span>
  <span m=''2558800''>routine</span> <span m=''2560930''>now,</span> <span m=''2561840''>what</span>
  <span m=''2562030''>happens</span> <span m=''2562490''>is</span> <span m=''2562660''>we</span>
  <span m=''2562890''>initialize</span> <span m=''2563560''>a</span> <span m=''2563610''>bunch</span>
  <span m=''2563870''>of</span> <span m=''2563970''>things.</span> <span m=''2564400''>And</span>
  <span m=''2564600''>now,</span> <span m=''2565470''>if</span> <span m=''2566250''>argc</span>
  <span m=''2566460''>is</span> <span m=''2566610''>less</span> <span m=''2566880''>than</span>
  <span m=''2567040''>2,</span> <span m=''2567290''>we''ll</span> <span m=''2567460''>return</span>
  <span m=''2567860''>1.</span> <span m=''2568350''>That''s</span> <span m=''2568720''>fine.</span>
  </p><p><span m=''2570860''>Then</span> <span m=''2571140''>we''re</span> <span m=''2571270''>going</span>
  <span m=''2571370''>to</span> <span m=''2571410''>get</span> <span m=''2571740''>the</span>
  <span m=''2573690''>reading</span> <span m=''2574020''>that</span> <span m=''2574230''>we</span>
  <span m=''2574530''>fail.</span> <span m=''2574850''>That''s</span> <span m=''2575070''>actually</span>
  <span m=''2575310''>the</span> <span m=''2575420''>reading</span> <span m=''2575750''>of</span>
  <span m=''2575840''>the</span> <span m=''2575940''>input.</span> <span m=''2576280''>So</span>
  <span m=''2576430''>then,</span> <span m=''2576660''>what</span> <span m=''2576790''>we</span>
  <span m=''2577110''>do</span> <span m=''2577270''>here</span> <span m=''2577580''>is</span>
  <span m=''2577690''>we</span> <span m=''2577810''>get</span> <span m=''2578250''>n</span>
  <span m=''2578560''>from</span> <span m=''2578700''>the</span> <span m=''2578800''>command</span>
  <span m=''2579160''>line.</span> <span m=''2580220''>And</span> <span m=''2580360''>then</span>
  <span m=''2580520''>if</span> <span m=''2580680''>n</span> <span m=''2580890''>is</span>
  <span m=''2581060''>less</span> <span m=''2581360''>than</span> <span m=''2581530''>30,</span>
  <span m=''2582720''>we''re</span> <span m=''2583000''>just</span> <span m=''2583240''>going</span>
  <span m=''2583350''>to</span> <span m=''2583430''>compute</span> <span m=''2583695''>Fib</span>
  <span m=''2583960''>of</span> <span m=''2584240''>n.</span> <span m=''2585710''>This</span>
  <span m=''2585890''>is</span> <span m=''2586010''>what</span> <span m=''2586170''>I</span>
  <span m=''2586190''>evaluated</span> <span m=''2587380''>on</span> <span m=''2587510''>my</span>
  <span m=''2587650''>laptop</span> <span m=''2588310''>was</span> <span m=''2588490''>a</span>
  <span m=''2588530''>good</span> <span m=''2588760''>number.</span> </p><p><span
  m=''2590680''>So</span> <span m=''2591300''>the</span> <span m=''2591430''>idea</span>
  <span m=''2591710''>is</span> <span m=''2591800''>there''s</span> <span m=''2591970''>no</span>
  <span m=''2592180''>point</span> <span m=''2592560''>in</span> <span m=''2592700''>creating</span>
  <span m=''2593360''>the</span> <span m=''2593520''>extra</span> <span m=''2593870''>thread</span>
  <span m=''2594240''>to</span> <span m=''2594330''>do</span> <span m=''2594480''>the</span>
  <span m=''2594590''>work</span> <span m=''2596330''>if</span> <span m=''2596550''>it''s</span>
  <span m=''2596700''>going</span> <span m=''2596810''>to</span> <span m=''2596850''>be</span>
  <span m=''2596940''>more</span> <span m=''2597170''>expensive</span> <span m=''2597740''>than</span>
  <span m=''2597990''>me just</span> <span m=''2598190''>doing</span> <span m=''2598380''>the</span>
  <span m=''2598470''>work</span> <span m=''2598710''>myself.</span> <span m=''2599710''>So</span>
  <span m=''2599930''>I looked</span> <span m=''2600140''>at</span> <span m=''2600230''>the</span>
  <span m=''2600350''>overhead</span> <span m=''2600860''>of</span> <span m=''2600970''>thread</span>
  <span m=''2601270''>creation</span> <span m=''2602320''>and</span> <span m=''2602470''>discovered</span>
  <span m=''2603150''>that</span> <span m=''2603350''>if</span> <span m=''2603550''>it</span>
  <span m=''2603660''>was</span> <span m=''2604680''>smaller</span> <span m=''2605210''>than</span>
  <span m=''2605400''>30,</span> <span m=''2606560''>it''s</span> <span m=''2606720''>going
  to be</span> <span m=''2606880''>slower</span> <span m=''2607350''>to</span> <span
  m=''2607420''>create</span> <span m=''2607930''>another</span> <span m=''2608270''>thread</span>
  <span m=''2608660''>to</span> <span m=''2608740''>help</span> <span m=''2608990''>me</span>
  <span m=''2609160''>out.</span> </p><p><span m=''2610780''>It''s</span> <span m=''2610940''>sort</span>
  <span m=''2611080''>of</span> <span m=''2611170''>like</span> <span m=''2611570''>you</span>
  <span m=''2611760''>folks</span> <span m=''2612820''>when</span> <span m=''2613060''>you''re</span>
  <span m=''2613190''>doing</span> <span m=''2613490''>pair</span> <span m=''2613780''>programming,</span>
  <span m=''2614380''>which</span> <span m=''2614540''>you''re</span> <span m=''2614600''>supposed</span>
  <span m=''2614890''>to</span> <span m=''2614940''>be</span> <span m=''2615040''>doing,</span>
  <span m=''2615420''>versus</span> <span m=''2615850''>handing</span> <span m=''2616160''>it</span>
  <span m=''2616240''>off.</span> <span m=''2616990''>Sometimes,</span> <span m=''2617480''>there
  are</span> <span m=''2617640''>some</span> <span m=''2617830''>things</span> <span
  m=''2618120''>that are</span> <span m=''2618260''>too</span> <span m=''2618410''>small</span>
  <span m=''2618710''>to</span> <span m=''2618790''>ask</span> <span m=''2619130''>somebody</span>
  <span m=''2619410''>else</span> <span m=''2619600''>to</span> <span m=''2619700''>do.</span>
  <span m=''2620920''>You</span> <span m=''2620950''>might</span> <span m=''2621240''>as
  well just</span> <span m=''2621430''>do</span> <span m=''2621600''>it,</span> <span
  m=''2622660''>by time</span> <span m=''2623100''>you</span> <span m=''2623140''>explain</span>
  <span m=''2623620''>what</span> <span m=''2623760''>it is,</span> <span m=''2624650''>and</span>
  <span m=''2624760''>so</span> <span m=''2624910''>forth.</span> </p><p><span m=''2625310''>Same</span>
  <span m=''2625570''>thing</span> <span m=''2625730''>here.</span> <span m=''2627160''>What''s</span>
  <span m=''2627480''>the</span> <span m=''2627570''>point</span> <span m=''2627890''>in</span>
  <span m=''2627980''>starting</span> <span m=''2628400''>up</span> <span m=''2628520''>a</span>
  <span m=''2628600''>thread</span> <span m=''2629060''>to</span> <span m=''2629160''>do</span>
  <span m=''2629300''>something</span> <span m=''2629710''>else,</span> <span m=''2630190''>because</span>
  <span m=''2630420''>the</span> <span m=''2630510''>startup</span> <span m=''2631000''>cost</span>
  <span m=''2631380''>is</span> <span m=''2631670''>rather</span> <span m=''2632010''>substantial.</span>
  <span m=''2633630''>So</span> <span m=''2633810''>if it''s</span> <span m=''2633920''>less</span>
  <span m=''2634150''>than</span> <span m=''2634280''>30,</span> <span m=''2634630''>well,</span>
  <span m=''2634830''>we''ll</span> <span m=''2634980''>just</span> <span m=''2635200''>be</span>
  <span m=''2635320''>done.</span> <span m=''2636180''>Otherwise,</span> <span m=''2637600''>what</span>
  <span m=''2637840''>we</span> <span m=''2637970''>do</span> <span m=''2638330''>is</span>
  <span m=''2638800''>we</span> <span m=''2640530''>marshall</span> <span m=''2641000''>the</span>
  <span m=''2641120''>argument</span> <span m=''2641630''>to</span> <span m=''2641710''>the</span>
  <span m=''2641830''>thread.</span> <span m=''2642300''>We</span> <span m=''2642410''>basically</span>
  <span m=''2643090''>set</span> <span m=''2643590''>args.input</span> <span m=''2644540''>to</span>
  <span m=''2644630''>n</span> <span m=''2644800''>minus</span> <span m=''2645160''>1.</span>
  <span m=''2646370''>Because</span> <span m=''2646590''>args</span> <span m=''2646970''>is</span>
  <span m=''2647110''>going</span> <span m=''2647190''>to</span> <span m=''2647270''>be</span>
  <span m=''2647330''>what</span> <span m=''2647490''>I''m</span> <span m=''2647570''>going</span>
  <span m=''2647650''>to</span> <span m=''2647720''>pass</span> <span m=''2648130''>in.</span>
  <span m=''2648860''>So I say</span> <span m=''2649120''>the</span> <span m=''2649350''>input</span>
  <span m=''2649740''>number</span> <span m=''2650010''>is</span> <span m=''2650180''>n</span>
  <span m=''2650770''>minus</span> <span m=''2650990''>1.</span> </p><p><span m=''2651700''>And
  now</span> <span m=''2651970''>what</span> <span m=''2652130''>I</span> <span m=''2652240''>do</span>
  <span m=''2652700''>is</span> <span m=''2653080''>I</span> <span m=''2654220''>create</span>
  <span m=''2654800''>the</span> <span m=''2654860''>thread</span> <span m=''2655570''>by</span>
  <span m=''2655710''>saying,</span> <span m=''2657220''>give</span> <span m=''2657370''>me</span>
  <span m=''2657520''>the</span> <span m=''2657610''>name</span> <span m=''2657950''>of</span>
  <span m=''2658490''>the</span> <span m=''2660800''>thread</span> <span m=''2661240''>that</span>
  <span m=''2661340''>I''m</span> <span m=''2661600''>creating.</span> <span m=''2662840''>This</span>
  <span m=''2663580''>was</span> <span m=''2663830''>the</span> <span m=''2666680''>field</span>
  <span m=''2667260''>that I</span> <span m=''2667320''>said</span> <span m=''2667560''>you</span>
  <span m=''2667660''>could</span> <span m=''2667830''>put</span> <span m=''2668020''>to</span>
  <span m=''2668110''>be</span> <span m=''2668230''>NULL,</span> <span m=''2668520''>which</span>
  <span m=''2668710''>basically</span> <span m=''2669520''>lets</span> <span m=''2669750''>you</span>
  <span m=''2669860''>set</span> <span m=''2670110''>some</span> <span m=''2670230''>policy</span>
  <span m=''2670710''>parameters</span> <span m=''2671250''>and</span> <span m=''2671350''>so</span>
  <span m=''2671530''>forth.</span> <span m=''2672370''>I</span> <span m=''2672480''>say,</span>
  <span m=''2673040''>execute</span> <span m=''2673560''>the</span> <span m=''2673660''>thread_func.</span>
  <span m=''2674470''>This</span> <span m=''2674680''>guy</span> <span m=''2674880''>here.</span>
  <span m=''2676000''>And</span> <span m=''2676380''>here''s</span> <span m=''2676790''>the</span>
  <span m=''2677000''>argument</span> <span m=''2677490''>list</span> <span m=''2677810''>that
  I</span> <span m=''2677880''>want</span> <span m=''2678060''>to</span> <span m=''2678110''>provide</span>
  <span m=''2678380''>it,</span> <span m=''2678650''>which</span> <span m=''2679030''>is</span>
  <span m=''2679180''>this</span> <span m=''2679340''>args</span> <span m=''2679730''>thing.</span>
  </p><p><span m=''2682000''>Once</span> <span m=''2682350''>you</span> <span m=''2682480''>do</span>
  <span m=''2682700''>the</span> <span m=''2682840''>thread_create,</span> <span m=''2683710''>and</span>
  <span m=''2683820''>this</span> <span m=''2683970''>is</span> <span m=''2684100''>where</span>
  <span m=''2684260''>you</span> <span m=''2684410''>depart</span> <span m=''2684950''>from</span>
  <span m=''2685130''>normal</span> <span m=''2685520''>C</span> <span m=''2686500''>or</span>
  <span m=''2687340''>C++</span> <span m=''2688110''>semantics.</span> <span m=''2688420''>And</span>
  <span m=''2688730''>in</span> <span m=''2688840''>fact,</span> <span m=''2689040''>we''re</span>
  <span m=''2689120''>going</span> <span m=''2689200''>to</span> <span m=''2689290''>be</span>
  <span m=''2689470''>doing</span> <span m=''2689760''>more</span> <span m=''2690470''>moving</span>
  <span m=''2690940''>in the</span> <span m=''2691000''>direction</span> <span m=''2691400''>of</span>
  <span m=''2691470''>C++.</span> <span m=''2692260''>We''ll</span> <span m=''2692400''>have</span>
  <span m=''2692710''>some</span> <span m=''2694210''>tutorials</span> <span m=''2694770''>on</span>
  <span m=''2694920''>that.</span> </p><p><span m=''2697240''>What</span> <span m=''2697460''>happens</span>
  <span m=''2697910''>is</span> <span m=''2699120''>we</span> <span m=''2699300''>check</span>
  <span m=''2699590''>the</span> <span m=''2699680''>status.</span> <span m=''2700200''>OK,</span>
  <span m=''2700500''>I</span> <span m=''2700590''>actually</span> <span m=''2700850''>did</span>
  <span m=''2701090''>check</span> <span m=''2701340''>the</span> <span m=''2701420''>status</span>
  <span m=''2702470''>to</span> <span m=''2702590''>see</span> <span m=''2702770''>whether</span>
  <span m=''2702970''>or</span> <span m=''2703010''>not</span> <span m=''2703200''>it</span>
  <span m=''2703290''>created</span> <span m=''2703730''>it</span> <span m=''2703850''>properly.</span>
  <span m=''2705550''>But</span> <span m=''2705690''>basically</span> <span m=''2706300''>now,</span>
  <span m=''2706540''>what''s</span> <span m=''2706730''>happening</span> <span m=''2707260''>is</span>
  <span m=''2707970''>after</span> <span m=''2708390''>I</span> <span m=''2708510''>execute</span>
  <span m=''2709240''>this,</span> <span m=''2709940''>it</span> <span m=''2710120''>goes</span>
  <span m=''2710440''>off</span> <span m=''2710930''>and</span> <span m=''2711350''>all</span>
  <span m=''2711600''>the</span> <span m=''2711680''>magic</span> <span m=''2712290''>in</span>
  <span m=''2712470''>Pthreads</span> <span m=''2713110''>starts</span> <span m=''2713520''>another</span>
  <span m=''2713820''>thread</span> <span m=''2714190''>doing</span> <span m=''2714400''>that</span>
  <span m=''2714590''>computation.</span> <span m=''2716370''>And</span> <span m=''2716560''>control</span>
  <span m=''2717250''>returns</span> <span m=''2718450''>to</span> <span m=''2718580''>the</span>
  <span m=''2718650''>statement</span> <span m=''2719150''>after</span> <span m=''2719560''>the</span>
  <span m=''2719910''>pthread_create.</span> </p><p><span m=''2721850''>So</span>
  <span m=''2722040''>when</span> <span m=''2722330''>the</span> <span m=''2722530''>pthread_create</span>
  <span m=''2723530''>returns,</span> <span m=''2724670''>that</span> <span m=''2724820''>doesn''t</span>
  <span m=''2725040''>mean</span> <span m=''2725230''>it''s</span> <span m=''2725420''>done</span>
  <span m=''2725740''>computing</span> <span m=''2726530''>the</span> <span m=''2726640''>thing</span>
  <span m=''2726880''>you</span> <span m=''2727050''>told</span> <span m=''2727320''>it</span>
  <span m=''2727460''>to</span> <span m=''2727530''>do.</span> <span m=''2728150''>Then,</span>
  <span m=''2728410''>what</span> <span m=''2728660''>would</span> <span m=''2728790''>be</span>
  <span m=''2728910''>the</span> <span m=''2729010''>point?</span> <span m=''2730420''>It</span>
  <span m=''2730590''>returns</span> <span m=''2731070''>after</span> <span m=''2731360''>it''s</span>
  <span m=''2731470''>set</span> <span m=''2731750''>up</span> <span m=''2732470''>to</span>
  <span m=''2732610''>operate</span> <span m=''2732950''>in</span> <span m=''2733290''>parallel</span>
  <span m=''2734920''>the</span> <span m=''2735230''>other</span> <span m=''2735470''>thread.</span>
  <span m=''2736650''>People</span> <span m=''2736910''>follow</span> <span m=''2737220''>that?</span>
  </p><p><span m=''2738110''>So</span> <span m=''2738290''>now</span> <span m=''2738580''>at</span>
  <span m=''2738720''>this</span> <span m=''2738960''>point,</span> <span m=''2739410''>there</span>
  <span m=''2739540''>are</span> <span m=''2739630''>two</span> <span m=''2739840''>threads</span>
  <span m=''2740240''>operating.</span> <span m=''2741480''>There''s</span> <span
  m=''2741670''>the</span> <span m=''2741760''>thread</span> <span m=''2742050''>we''ve</span>
  <span m=''2742250''>called</span> <span m=''2742600''>thread.</span> <span m=''2743060''>And</span>
  <span m=''2743200''>there''s</span> <span m=''2743380''>whatever</span> <span m=''2743730''>the</span>
  <span m=''2743830''>name</span> <span m=''2744060''>of</span> <span m=''2744140''>the</span>
  <span m=''2744220''>thread</span> <span m=''2744530''>is</span> <span m=''2745030''>that</span>
  <span m=''2745150''>we</span> <span m=''2745260''>started</span> <span m=''2745710''>on.</span>
  <span m=''2748740''>So</span> <span m=''2748930''>then</span> <span m=''2749200''>we,</span>
  <span m=''2749630''>in</span> <span m=''2749810''>our</span> <span m=''2750060''>own</span>
  <span m=''2750800''>processor</span> <span m=''2751380''>here,</span> <span m=''2751740''>we</span>
  <span m=''2751890''>compute</span> <span m=''2752280''>Fib</span> <span m=''2752510''>of</span>
  <span m=''2752680''>N</span> <span m=''2752800''>minus</span> <span m=''2753190''>2.</span>
  <span m=''2754610''>And</span> <span m=''2754790''>now,</span> <span m=''2755010''>what</span>
  <span m=''2755150''>we</span> <span m=''2755250''>do</span> <span m=''2755380''>is</span>
  <span m=''2755470''>we</span> <span m=''2755580''>go</span> <span m=''2755950''>on</span>
  <span m=''2756270''>to</span> <span m=''2756400''>join</span> <span m=''2757700''>this</span>
  <span m=''2758130''>thread</span> <span m=''2758690''>with</span> <span m=''2758960''>the</span>
  <span m=''2759050''>thread</span> <span m=''2759690''>that</span> <span m=''2762580''>we</span>
  <span m=''2763020''>had</span> <span m=''2763880''>created.</span> </p><p><span
  m=''2768130''>So</span> <span m=''2768310''>let''s</span> <span m=''2768480''>see</span>
  <span m=''2768590''>here.</span> <span m=''2770740''>And</span> <span m=''2771170''>the</span>
  <span m=''2771260''>thing</span> <span m=''2771510''>that</span> <span m=''2771680''>the</span>
  <span m=''2771770''>join</span> <span m=''2772160''>does</span> <span m=''2772610''>is</span>
  <span m=''2772800''>if</span> <span m=''2773000''>the</span> <span m=''2773190''>other</span>
  <span m=''2773430''>thread</span> <span m=''2773810''>isn''t</span> <span m=''2774190''>done,</span>
  <span m=''2775240''>it</span> <span m=''2775420''>sits</span> <span m=''2775720''>there</span>
  <span m=''2775930''>and</span> <span m=''2776020''>waits</span> <span m=''2776390''>until</span>
  <span m=''2776720''>it</span> <span m=''2776810''>is</span> <span m=''2777050''>done.</span>
  <span m=''2777620''>And</span> <span m=''2777830''>it does</span> <span m=''2778070''>that</span>
  <span m=''2778270''>synchronization</span> <span m=''2779050''>automatically</span>
  <span m=''2779400''>for</span> <span m=''2779750''>you.</span> <span m=''2780420''>And</span>
  <span m=''2780480''>this</span> <span m=''2780620''>is</span> <span m=''2780690''>the</span>
  <span m=''2780780''>kind</span> <span m=''2781010''>of</span> <span m=''2781100''>thing</span>
  <span m=''2781230''>a</span> <span m=''2781530''>concurrency</span> <span m=''2781910''>platform</span>
  <span m=''2782510''>provides.</span> <span m=''2783130''>It</span> <span m=''2783390''>provides</span>
  <span m=''2784180''>the</span> <span m=''2784270''>coordination</span> <span m=''2785070''>under</span>
  <span m=''2785320''>the</span> <span m=''2785430''>covers</span> <span m=''2786690''>for</span>
  <span m=''2786840''>you</span> <span m=''2787480''>to</span> <span m=''2788070''>be</span>
  <span m=''2788250''>able</span> <span m=''2788530''>to</span> <span m=''2790100''>synchronize</span>
  <span m=''2790790''>with</span> <span m=''2790960''>it</span> <span m=''2791090''>without</span>
  <span m=''2791450''>you</span> <span m=''2791610''>having</span> <span m=''2791910''>to</span>
  <span m=''2791960''>synchronize</span> <span m=''2792520''>on</span> <span m=''2792620''>your</span>
  <span m=''2792800''>own.</span> </p><p><span m=''2794930''>And</span> <span m=''2795140''>then,</span>
  <span m=''2796240''>once</span> <span m=''2796580''>it</span> <span m=''2796740''>does</span>
  <span m=''2797000''>return,</span> <span m=''2797990''>it</span> <span m=''2798190''>adds</span>
  <span m=''2798430''>the</span> <span m=''2798670''>results</span> <span m=''2799150''>together</span>
  <span m=''2801400''>by</span> <span m=''2801750''>taking</span> <span m=''2802160''>the</span>
  <span m=''2802250''>result</span> <span m=''2802720''>which</span> <span m=''2802920''>came</span>
  <span m=''2803200''>from</span> <span m=''2804950''>the</span> <span m=''2805490''>Fib</span>
  <span m=''2805960''>of</span> <span m=''2806050''>n</span> <span m=''2806170''>minus</span>
  <span m=''2806480''>2</span> <span m=''2806710''>and</span> <span m=''2806790''>adds</span>
  <span m=''2807260''>to</span> <span m=''2807520''>it</span> <span m=''2808040''>the</span>
  <span m=''2808150''>value</span> <span m=''2808550''>that</span> <span m=''2808810''>this</span>
  <span m=''2809190''>thread</span> <span m=''2809720''>has</span> <span m=''2809930''>returned</span>
  <span m=''2810520''>in</span> <span m=''2810750''>the</span> <span m=''2810880''>args.output.</span>
  <span m=''2814660''>And</span> <span m=''2814790''>then</span> <span m=''2814920''>it</span>
  <span m=''2815020''>prints</span> <span m=''2815250''>the</span> <span m=''2815330''>result.</span>
  </p><p><span m=''2817420''>So</span> <span m=''2817590''>any</span> <span m=''2817780''>question</span>
  <span m=''2818140''>about</span> <span m=''2818400''>that?</span> <span m=''2819910''>Wouldn''t</span>
  <span m=''2820040''>this</span> <span m=''2820300''>be</span> <span m=''2820430''>fun</span>
  <span m=''2820680''>to</span> <span m=''2820780''>write</span> <span m=''2820960''>a</span>
  <span m=''2821010''>really</span> <span m=''2821260''>big</span> <span m=''2821430''>system</span>
  <span m=''2821820''>in?</span> <span m=''2822860''>People</span> <span m=''2823240''>do.</span>
  <span m=''2824230''>People</span> <span m=''2824570''>do.</span> <span m=''2825480''>Yeah,</span>
  <span m=''2825710''>question?</span> </p><p><span m=''2827928''>AUDIENCE: [INAUDIBLE
  PHRASE]</span> </p><p><span m=''2833540''>PROFESSOR: That''s</span> <span m=''2833750''>a</span>
  <span m=''2834140''>tuning</span> <span m=''2834420''>parameter.</span> <span m=''2834795''>That''s
  a</span> <span m=''2835170''>voodoo</span> <span m=''2835260''>parameter.</span>
  </p><p><span m=''2835595''>AUDIENCE: Right.</span> <span m=''2835930''>But</span>
  <span m=''2836422''>in this</span> <span m=''2836914''>particular</span> <span m=''2837406''>case,</span>
  <span m=''2837898''>it makes</span> <span m=''2838390''>no difference</span> <span
  m=''2838882''>at all.</span> <span m=''2839374''>It</span> <span m=''2839866''>would''ve</span>
  <span m=''2840358''>made</span> <span m=''2840850''>a</span> <span m=''2841342''>difference</span>
  <span m=''2841834''>if it was an</span> <span m=''2842326''>actual</span> <span
  m=''2842818''>person</span> <span m=''2843310''>[INAUDIBLE]?</span> </p><p><span
  m=''2843802''>PROFESSOR: No,</span> <span m=''2844294''>it does</span> <span m=''2844786''>make
  a difference.</span> <span m=''2845290''>For</span> <span m=''2845420''>how</span>
  <span m=''2845550''>fast</span> <span m=''2845950''>it</span> <span m=''2846020''>computes</span>
  <span m=''2846410''>this?</span> <span m=''2847080''>Absolutely</span> <span m=''2847500''>does.</span>
  </p><p><span m=''2848170''>AUDIENCE:  That''s</span> <span m=''2848623''>not</span>
  <span m=''2849076''>recursive?</span> </p><p><span m=''2849530''>PROFESSOR: No,</span>
  <span m=''2849680''>that''s</span> <span m=''2849870''>right.</span> <span m=''2850050''>This</span>
  <span m=''2850210''>is</span> <span m=''2850260''>not</span> <span m=''2850450''>recursive.</span>
  <span m=''2850920''>I''m</span> <span m=''2851030''>just</span> <span m=''2851180''>doing</span>
  <span m=''2851370''>two</span> <span m=''2851560''>things</span> <span m=''2851980''>and</span>
  <span m=''2852110''>then</span> <span m=''2852300''>quitting.</span> </p><p><span
  m=''2853238''>AUDIENCE: [INAUDIBLE]</span> <span m=''2853706''>if it''s</span> <span
  m=''2854174''>less</span> <span m=''2854642''>than</span> <span m=''2855110''>30,</span>
  <span m=''2855578''>then it''s</span> <span m=''2856046''>going to be</span> <span
  m=''2856514''>[INAUDIBLE],</span> <span m=''2856982''>right?</span> </p><p><span
  m=''2859390''>PROFESSOR: If</span> <span m=''2859740''>it''s less than</span> <span
  m=''2860170''>30,</span> <span m=''2860470''>it''s</span> <span m=''2860750''>fast</span>
  <span m=''2861130''>enough</span> <span m=''2861450''>that</span> <span m=''2861590''>I</span>
  <span m=''2861660''>might as well</span> <span m=''2862040''>just</span> <span m=''2862260''>return.</span>
  </p><p><span m=''2863175''>AUDIENCE: Then</span> <span m=''2863650''>why</span>
  <span m=''2864125''>[INAUDIBLE PHRASE]</span> <span m=''2866025''>to</span> <span
  m=''2866500''>do it.</span> <span m=''2866975''>It</span> <span m=''2867450''>would</span>
  <span m=''2867925''>return</span> <span m=''2868400''>[INAUDIBLE]</span> <span m=''2868875''>too.</span>
  </p><p><span m=''2869350''>PROFESSOR: No.</span> <span m=''2869560''>But</span>
  <span m=''2869730''>it</span> <span m=''2870090''>would</span> <span m=''2870450''>be</span>
  <span m=''2870930''>slower.</span> <span m=''2871470''>It</span> <span m=''2871530''>would
  be</span> <span m=''2871830''>wasteful</span> <span m=''2872120''>of</span> <span
  m=''2872340''>resources.</span> <span m=''2872645''>Maybe</span> <span m=''2872950''>somebody--</span>
  </p><p><span m=''2873434''>AUDIENCE: Well,</span> <span m=''2873918''>because</span>
  <span m=''2874402''>you''re</span> <span m=''2874886''>using</span> <span m=''2875370''>such
  a</span> <span m=''2875854''>bad</span> <span m=''2876338''>algorithm, I guess?</span>
  </p><p><span m=''2876822''>PROFESSOR: Yeah.</span> </p><p><span m=''2877306''>AUDIENCE:
  Oh, I see.</span> <span m=''2877790''>Oh, OK.</span> </p><p><span m=''2878280''>PROFESSOR:
  OK.</span> <span m=''2879430''>So</span> <span m=''2879610''>in</span> <span m=''2879690''>any</span>
  <span m=''2879880''>case,</span> <span m=''2881190''>that''s</span> <span m=''2881420''>Pthread''s</span>
  <span m=''2881960''>programming.</span> <span m=''2882410''>There</span> <span m=''2882520''>are</span>
  <span m=''2882540''>a</span> <span m=''2882580''>bunch</span> <span m=''2882840''>of</span>
  <span m=''2882910''>issues.</span> <span m=''2883450''>One</span> <span m=''2883750''>is</span>
  <span m=''2884010''>that</span> <span m=''2884080''>the</span> <span m=''2884180''>overhead</span>
  <span m=''2884650''>of</span> <span m=''2884740''>creating</span> <span m=''2885210''>a</span>
  <span m=''2885260''>thread</span> <span m=''2886260''>is</span> <span m=''2887640''>more</span>
  <span m=''2887910''>than</span> <span m=''2888090''>10,000</span> <span m=''2888870''>cycles.</span>
  <span m=''2890220''>So</span> <span m=''2890410''>it leaves</span> <span m=''2890770''>you
  to</span> <span m=''2891030''>only</span> <span m=''2891320''>be</span> <span m=''2891530''>able</span>
  <span m=''2891680''>to</span> <span m=''2891750''>do</span> <span m=''2891930''>very</span>
  <span m=''2892180''>coarse</span> <span m=''2892580''>grain</span> <span m=''2893130''>concurrency.</span>
  </p><p><span m=''2893760''>There</span> <span m=''2893980''>are</span> <span m=''2894110''>some</span>
  <span m=''2894310''>tricks</span> <span m=''2894760''>around</span> <span m=''2895180''>that.</span>
  <span m=''2895590''>One</span> <span m=''2895930''>is</span> <span m=''2896390''>to</span>
  <span m=''2896480''>use</span> <span m=''2896700''>what''s</span> <span m=''2896890''>called</span>
  <span m=''2897200''>thread</span> <span m=''2897520''>pools.</span> <span m=''2897870''>What</span>
  <span m=''2898010''>I</span> <span m=''2898080''>do</span> <span m=''2898290''>is</span>
  <span m=''2898430''>I</span> <span m=''2898510''>start</span> <span m=''2898900''>up,</span>
  <span m=''2899080''>and</span> <span m=''2899180''>I</span> <span m=''2899240''>create</span>
  <span m=''2899700''>a</span> <span m=''2899750''>bunch</span> <span m=''2900000''>of</span>
  <span m=''2900100''>threads.</span> <span m=''2901600''>And</span> <span m=''2901730''>I</span>
  <span m=''2901780''>have</span> <span m=''2902000''>their</span> <span m=''2902130''>names.</span>
  <span m=''2902560''>I</span> <span m=''2902620''>put</span> <span m=''2902840''>them</span>
  <span m=''2902980''>in</span> <span m=''2903090''>a</span> <span m=''2903160''>link</span>
  <span m=''2903500''>list.</span> <span m=''2903810''>And</span> <span m=''2903900''>whenever</span>
  <span m=''2904220''>I</span> <span m=''2904270''>need</span> <span m=''2904450''>to</span>
  <span m=''2904530''>create</span> <span m=''2904960''>one,</span> <span m=''2905580''>rather</span>
  <span m=''2905850''>than</span> <span m=''2905950''>actually</span> <span m=''2906270''>creating</span>
  <span m=''2906800''>one,</span> <span m=''2906970''>I</span> <span m=''2907050''>take</span>
  <span m=''2907310''>one</span> <span m=''2907450''>out of</span> <span m=''2907560''>the</span>
  <span m=''2907670''>list,</span> <span m=''2908070''>much</span> <span m=''2908330''>as</span>
  <span m=''2908800''>I</span> <span m=''2908950''>would</span> <span m=''2909090''>do</span>
  <span m=''2909210''>memory</span> <span m=''2909560''>allocation.</span> <span m=''2910820''>Which</span>
  <span m=''2911030''>you</span> <span m=''2911150''>folks</span> <span m=''2911480''>are</span>
  <span m=''2911560''>familiar</span> <span m=''2911940''>with.</span> <span m=''2915580''>OK.</span>
  <span m=''2916050''>Ha,</span> <span m=''2916538''>ha,</span> <span m=''2917026''>ha,
  ha, ha.</span> <span m=''2918490''>[MANIACAL LAUGHTER]</span> </p><p><span m=''2925340''>So</span>
  <span m=''2925570''>basically,</span> <span m=''2926240''>you</span> <span m=''2926400''>can</span>
  <span m=''2926560''>have</span> <span m=''2926680''>a</span> <span m=''2926790''>free</span>
  <span m=''2927080''>list</span> <span m=''2927480''>of</span> <span m=''2928020''>threads.</span>
  <span m=''2928960''>And</span> <span m=''2929140''>when</span> <span m=''2929280''>you</span>
  <span m=''2929380''>need</span> <span m=''2929510''>a</span> <span m=''2929630''>thread,</span>
  <span m=''2930960''>you</span> <span m=''2931110''>grab</span> <span m=''2931420''>the</span>
  <span m=''2931500''>thread.</span> <span m=''2933550''>The</span> <span m=''2933730''>second</span>
  <span m=''2934010''>thing</span> <span m=''2934220''>is</span> <span m=''2936590''>scalability.</span>
  <span m=''2937750''>So</span> <span m=''2937890''>this</span> <span m=''2938110''>code</span>
  <span m=''2938370''>gets</span> <span m=''2938540''>about</span> <span m=''2938770''>a</span>
  <span m=''2938830''>1.5</span> <span m=''2939690''>speed</span> <span m=''2939990''>up</span>
  <span m=''2940130''>for</span> <span m=''2940250''>two</span> <span m=''2940450''>cores.</span>
  <span m=''2941580''>If</span> <span m=''2941810''>I</span> <span m=''2941920''>want</span>
  <span m=''2942090''>to</span> <span m=''2942130''>use</span> <span m=''2942420''>three</span>
  <span m=''2942700''>cores</span> <span m=''2943080''>or</span> <span m=''2943290''>four</span>
  <span m=''2943470''>cores,</span> <span m=''2945300''>what</span> <span m=''2945450''>do
  I</span> <span m=''2945560''>have</span> <span m=''2945670''>to</span> <span m=''2945770''>do?</span>
  <span m=''2947470''>Rewrite</span> <span m=''2947870''>the</span> <span m=''2947940''>whole</span>
  <span m=''2948160''>program.</span> <span m=''2949210''>This</span> <span m=''2949380''>program</span>
  <span m=''2949800''>only</span> <span m=''2950130''>works</span> <span m=''2950570''>for</span>
  <span m=''2950690''>two</span> <span m=''2951045''>cores.</span> <span m=''2952490''>It
  will</span> <span m=''2952610''>also</span> <span m=''2952830''>work</span> <span
  m=''2953080''>for</span> <span m=''2953180''>one</span> <span m=''2953430''>core.</span>
  <span m=''2954780''>but</span> <span m=''2955400''>basically,</span> <span m=''2955840''>it</span>
  <span m=''2955920''>doesn''t</span> <span m=''2956180''>really</span> <span m=''2956390''>exploit</span>
  <span m=''2957600''>three</span> <span m=''2957860''>or</span> <span m=''2957920''>four</span>
  <span m=''2958190''>cores.</span> </p><p><span m=''2960550''>It''s</span> <span
  m=''2960750''>really</span> <span m=''2961020''>bad</span> <span m=''2961450''>for</span>
  <span m=''2961550''>modulatary.</span> <span m=''2962300''>The</span> <span m=''2962410''>Fibonacci</span>
  <span m=''2963000''>logic</span> <span m=''2963460''>is</span> <span m=''2963580''>no</span>
  <span m=''2963730''>longer</span> <span m=''2964100''>neatly</span> <span m=''2964660''>encapsulated</span>
  <span m=''2965530''>in</span> <span m=''2965670''>the</span> <span m=''2965770''>Fib</span>
  <span m=''2966090''>function.</span> <span m=''2968510''>So</span> <span m=''2968700''>where</span>
  <span m=''2968970''>do</span> <span m=''2969080''>we</span> <span m=''2969190''>see</span>
  <span m=''2969490''>if</span> <span m=''2969590''>we</span> <span m=''2969670''>go</span>
  <span m=''2969830''>back</span> <span m=''2970110''>to</span> <span m=''2970200''>this</span>
  <span m=''2970390''>code?</span> <span m=''2971320''>Here''s</span> <span m=''2971620''>the</span>
  <span m=''2971710''>Fib</span> <span m=''2971990''>function.</span> <span m=''2972910''>Oh,</span>
  <span m=''2973180''>but</span> <span m=''2973390''>now,</span> <span m=''2973710''>I''ve</span>
  <span m=''2973950''>kind</span> <span m=''2974120''>of</span> <span m=''2974290''>got--</span>
  <span m=''2975410''>well,</span> <span m=''2975540''>this</span> <span m=''2975690''>is</span>
  <span m=''2976030''>sort</span> <span m=''2976180''>of</span> <span m=''2976240''>just</span>
  <span m=''2976440''>marshaling</span> <span m=''2976745''>and</span> <span m=''2977050''>calling.</span>
  </p><p><span m=''2977510''>But</span> <span m=''2977640''>over</span> <span m=''2977890''>here,</span>
  <span m=''2979300''>oh</span> <span m=''2979490''>my</span> <span m=''2979630''>goodness,</span>
  <span m=''2979990''>I''ve</span> <span m=''2980130''>got</span> <span m=''2980370''>some</span>
  <span m=''2980530''>arguments</span> <span m=''2981080''>here.</span> <span m=''2981570''>If</span>
  <span m=''2981690''>n</span> <span m=''2981850''>is</span> <span m=''2981980''>less</span>
  <span m=''2982200''>than</span> <span m=''2982340''>30,</span> <span m=''2982740''>I</span>
  <span m=''2982790''>give</span> <span m=''2982990''>a</span> <span m=''2983070''>result.</span>
  <span m=''2983640''>Otherwise,</span> <span m=''2984690''>I''m</span> <span m=''2984810''>adding</span>
  <span m=''2985330''>together--</span> <span m=''2985960''>but</span> <span m=''2986130''>wait
  a minute.</span> <span m=''2986310''>I already</span> <span m=''2986700''>specified</span>
  <span m=''2987430''>Fib</span> <span m=''2987610''>up</span> <span m=''2987760''>here.</span>
  <span m=''2988730''>So</span> <span m=''2988830''>I''m</span> <span m=''2989060''>specifying</span>
  <span m=''2989710''>my</span> <span m=''2989840''>serial</span> <span m=''2990230''>implementation,</span>
  <span m=''2991080''>and</span> <span m=''2991410''>I''m</span> <span m=''2991510''>specifying</span>
  <span m=''2992150''>a</span> <span m=''2992200''>parallel</span> <span m=''2993380''>way</span>
  <span m=''2993600''>of</span> <span m=''2993740''>doing</span> <span m=''2994070''>it.</span>
  <span m=''2995000''>And</span> <span m=''2995170''>so</span> <span m=''2995310''>that''s</span>
  <span m=''2995620''>not</span> <span m=''2995880''>modular.</span> <span m=''2996410''>If</span>
  <span m=''2996540''>I</span> <span m=''2996620''>decided</span> <span m=''2997100''>I</span>
  <span m=''2997150''>wanted</span> <span m=''2997420''>to</span> <span m=''2997520''>change</span>
  <span m=''2998310''>the</span> <span m=''2999020''>Fib,</span> <span m=''2999250''>I''ve</span>
  <span m=''2999480''>got</span> <span m=''2999590''>to</span> <span m=''2999640''>change</span>
  <span m=''3000050''>things</span> <span m=''3000300''>in</span> <span m=''3000420''>two</span>
  <span m=''3000610''>places.</span> <span m=''3001860''>If</span> <span m=''3002135''>Fib</span>
  <span m=''3002410''>were</span> <span m=''3002695''>something</span> <span m=''3003630''>I</span>
  <span m=''3005230''>did.</span> </p><p><span m=''3007840''>Code</span> <span m=''3008150''>simplicity.</span>
  <span m=''3008870''>The</span> <span m=''3009420''>programmers</span> <span m=''3010020''>for</span>
  <span m=''3010100''>this are</span> <span m=''3010280''>actually</span> <span m=''3010690''>marshalling</span>
  <span m=''3011310''>arguments.</span> <span m=''3012630''>This</span> <span m=''3012840''>is</span>
  <span m=''3013000''>what</span> <span m=''3013130''>I</span> <span m=''3013220''>call</span>
  <span m=''3013500''>shades</span> <span m=''3013920''>of</span> <span m=''3013990''>1958.</span>
  <span m=''3015070''>What</span> <span m=''3015220''>happened</span> <span m=''3015560''>in</span>
  <span m=''3015670''>1958</span> <span m=''3017000''>that''s</span> <span m=''3017190''>relevant</span>
  <span m=''3017700''>to</span> <span m=''3017810''>computer</span> <span m=''3018190''>science?</span>
  <span m=''3021060''>What</span> <span m=''3021290''>was</span> <span m=''3021460''>the</span>
  <span m=''3021550''>big</span> <span m=''3021920''>innovation</span> <span m=''3022580''>in</span>
  <span m=''3022710''>1958?</span> </p><p><span m=''3025320''>Programming</span> <span
  m=''3025770''>language.</span> <span m=''3027310''>Fortran.</span> <span m=''3029380''>So,</span>
  <span m=''3029550''>Fortran.</span> <span m=''3030820''>Before</span> <span m=''3031240''>Fortran,</span>
  <span m=''3031850''>people</span> <span m=''3032210''>wrote</span> <span m=''3032490''>in</span>
  <span m=''3032770''>assembly</span> <span m=''3033250''>language.</span> <span m=''3035320''>If</span>
  <span m=''3035570''>you</span> <span m=''3035750''>wanted</span> <span m=''3036220''>to</span>
  <span m=''3036560''>put</span> <span m=''3036990''>three</span> <span m=''3037250''>arguments</span>
  <span m=''3037800''>to</span> <span m=''3037910''>a</span> <span m=''3038010''>function,</span>
  <span m=''3039520''>you</span> <span m=''3039710''>did</span> <span m=''3039950''>a</span>
  <span m=''3039980''>push,</span> <span m=''3040440''>push,</span> <span m=''3040820''>push,</span>
  <span m=''3041680''>or</span> <span m=''3041920''>passed</span> <span m=''3042320''>them</span>
  <span m=''3042770''>in</span> <span m=''3043180''>parameters.</span> </p><p><span
  m=''3043790''>Actually,</span> <span m=''3044810''>their</span> <span m=''3045180''>machines</span>
  <span m=''3045580''>were</span> <span m=''3045680''>so</span> <span m=''3045870''>much</span>
  <span m=''3046070''>more</span> <span m=''3046240''>primitive</span> <span m=''3046620''>than</span>
  <span m=''3046720''>that</span> <span m=''3046850''>it</span> <span m=''3046970''>was</span>
  <span m=''3047260''>even</span> <span m=''3047520''>more</span> <span m=''3047820''>complicated</span>
  <span m=''3048360''>than</span> <span m=''3048470''>you</span> <span m=''3048560''>could</span>
  <span m=''3048680''>imagine,</span> <span m=''3051800''>given</span> <span m=''3052030''>how</span>
  <span m=''3052270''>complicated</span> <span m=''3052890''>it</span> <span m=''3053010''>is</span>
  <span m=''3053300''>today</span> <span m=''3053810''>what</span> <span m=''3054030''>the</span>
  <span m=''3054100''>compilers</span> <span m=''3054620''>are</span> <span m=''3054690''>doing.</span>
  <span m=''3056170''>But</span> <span m=''3056330''>you</span> <span m=''3056670''>had
  marshal</span> <span m=''3057130''>the</span> <span m=''3057260''>arguments</span>
  <span m=''3057540''>yourself.</span> <span m=''3057870''>What</span> <span m=''3058070''>Fortran</span>
  <span m=''3058530''>did</span> <span m=''3058680''>was</span> <span m=''3058830''>say,</span>
  <span m=''3059000''>no,</span> <span m=''3059400''>you</span> <span m=''3059570''>can</span>
  <span m=''3059730''>actually</span> <span m=''3060150''>write</span> <span m=''3061013''>f</span>
  <span m=''3061376''>of</span> <span m=''3061740''>a,</span> <span m=''3062420''>b,</span>
  <span m=''3063000''>c.</span> <span m=''3063780''>Close</span> <span m=''3064170''>paren.</span>
  <span m=''3066320''>And</span> <span m=''3066770''>that</span> <span m=''3067100''>it</span>
  <span m=''3067410''>will</span> <span m=''3068190''>cause</span> <span m=''3069100''>a,</span>
  <span m=''3069380''>b,</span> <span m=''3069600''>and</span> <span m=''3069710''>c</span>
  <span m=''3069960''>all</span> <span m=''3070150''>to</span> <span m=''3070230''>be</span>
  <span m=''3070360''>marshalled</span> <span m=''3070820''>automatically</span> <span
  m=''3071520''>for</span> <span m=''3071770''>you.</span> </p><p><span m=''3073160''>Well,</span>
  <span m=''3073340''>Pthreads</span> <span m=''3073870''>doesn''t</span> <span m=''3074140''>have</span>
  <span m=''3074390''>that</span> <span m=''3074570''>automatic</span> <span m=''3075080''>marshalling.</span>
  <span m=''3075450''>You got</span> <span m=''3075610''>to</span> <span m=''3075760''>marshall</span>
  <span m=''3076120''>by</span> <span m=''3076270''>hand</span> <span m=''3076720''>if</span>
  <span m=''3077180''>you''re</span> <span m=''3077280''>going</span> <span m=''3077390''>to</span>
  <span m=''3077430''>use</span> <span m=''3077810''>pthreads.</span> <span m=''3081790''>And</span>
  <span m=''3081980''>of</span> <span m=''3082070''>course,</span> <span m=''3082350''>as</span>
  <span m=''3082460''>you</span> <span m=''3082560''>can</span> <span m=''3082660''>imagine,</span>
  <span m=''3083080''>that</span> <span m=''3083270''>was</span> <span m=''3083420''>error</span>
  <span m=''3083700''>prone.</span> <span m=''3084770''>Because</span> <span m=''3085310''>there</span>
  <span m=''3085470''>is</span> <span m=''3085560''>no</span> <span m=''3085910''>type</span>
  <span m=''3086240''>safety.</span> <span m=''3087800''>Are</span> <span m=''3088030''>you</span>
  <span m=''3088170''>calling</span> <span m=''3088580''>things</span> <span m=''3088880''>with</span>
  <span m=''3088960''>the</span> <span m=''3089040''>right</span> <span m=''3089310''>types</span>
  <span m=''3089630''>and</span> <span m=''3089780''>so</span> <span m=''3089930''>forth?</span>
  <span m=''3091730''>And</span> <span m=''3091920''>so</span> <span m=''3092100''>forth.</span>
  </p><p><span m=''3093940''>And</span> <span m=''3094100''>also,</span> <span m=''3097570''>one</span>
  <span m=''3097740''>of</span> <span m=''3097790''>the</span> <span m=''3097840''>things</span>
  <span m=''3098090''>here</span> <span m=''3098370''>is</span> <span m=''3098520''>that</span>
  <span m=''3098750''>we''ve</span> <span m=''3098930''>created</span> <span m=''3099320''>two</span>
  <span m=''3099460''>jobs</span> <span m=''3099820''>that</span> <span m=''3099910''>aren''t</span>
  <span m=''3100130''>the</span> <span m=''3100190''>same</span> <span m=''3100480''>size.</span>
  <span m=''3101010''>So</span> <span m=''3101220''>there''s</span> <span m=''3101400''>no</span>
  <span m=''3101570''>way</span> <span m=''3102080''>that</span> <span m=''3102280''>they</span>
  <span m=''3102760''>have</span> <span m=''3103620''>of</span> <span m=''3103720''>load</span>
  <span m=''3104030''>balancing.</span> <span m=''3106230''>So</span> <span m=''3106410''>this</span>
  <span m=''3106590''>is</span> <span m=''3106750''>why</span> <span m=''3107380''>pthreads</span>
  <span m=''3108640''>is</span> <span m=''3108860''>sort</span> <span m=''3109060''>of</span>
  <span m=''3109160''>the</span> <span m=''3109310''>assembly</span> <span m=''3109740''>language</span>
  <span m=''3110070''>level,</span> <span m=''3110320''>so</span> <span m=''3110420''>that
  you</span> <span m=''3110670''>can</span> <span m=''3110830''>do</span> <span m=''3111000''>anything</span>
  <span m=''3111410''>you</span> <span m=''3111530''>want</span> <span m=''3111940''>in</span>
  <span m=''3112140''>pthreads.</span> <span m=''3113320''>But</span> <span m=''3114050''>you</span>
  <span m=''3114180''>have</span> <span m=''3114300''>to</span> <span m=''3114410''>program</span>
  <span m=''3114910''>at</span> <span m=''3115000''>this</span> <span m=''3115160''>kind</span>
  <span m=''3115310''>of</span> <span m=''3115450''>very</span> <span m=''3115790''>protocol-laden</span>
  <span m=''3117100''>level.</span> </p><p><span m=''3119500''>Next</span> <span m=''3119900''>thing</span>
  <span m=''3120040''>I</span> <span m=''3120130''>want to talk</span> <span m=''3120340''>about</span>
  <span m=''3120520''>is</span> <span m=''3120600''>threading</span> <span m=''3121000''>building</span>
  <span m=''3121300''>blocks.</span> <span m=''3124700''>This</span> <span m=''3124920''>is</span>
  <span m=''3125650''>a</span> <span m=''3126950''>technology</span> <span m=''3127540''>developed</span>
  <span m=''3127950''>by</span> <span m=''3128200''>Intel.</span> <span m=''3129250''>It''s</span>
  <span m=''3129410''>implemented</span> <span m=''3130040''>as</span> <span m=''3130190''>a</span>
  <span m=''3130290''>C++</span> <span m=''3131210''>library</span> <span m=''3131740''>that</span>
  <span m=''3131920''>runs</span> <span m=''3132190''>on</span> <span m=''3132290''>top</span>
  <span m=''3132650''>of</span> <span m=''3132930''>the</span> <span m=''3133040''>native</span>
  <span m=''3133430''>Pthreads,</span> <span m=''3134030''>typically,</span> <span
  m=''3134460''>or</span> <span m=''3134600''>WinAPI</span> <span m=''3135240''>threads.</span>
  </p><p><span m=''3136480''>So</span> <span m=''3136640''>it''s</span> <span m=''3136810''>basically</span>
  <span m=''3137510''>a</span> <span m=''3137650''>layer</span> <span m=''3138100''>on</span>
  <span m=''3138290''>top</span> <span m=''3138730''>of</span> <span m=''3139420''>the</span>
  <span m=''3139520''>Pthread</span> <span m=''3140000''>layer.</span> <span m=''3141590''>In</span>
  <span m=''3141780''>this</span> <span m=''3142000''>case,</span> <span m=''3142290''>the</span>
  <span m=''3142370''>program</span> <span m=''3142850''>specifies</span> <span m=''3143580''>tasks</span>
  <span m=''3144400''>rather</span> <span m=''3144710''>than</span> <span m=''3144940''>threads.</span>
  <span m=''3146400''>And</span> <span m=''3146630''>tasks</span> <span m=''3147080''>are</span>
  <span m=''3147210''>automatically</span> <span m=''3147950''>load</span> <span m=''3148270''>balanced</span>
  <span m=''3148830''>across</span> <span m=''3150110''>the</span> <span m=''3150690''>threads</span>
  <span m=''3151150''>using</span> <span m=''3151530''>a</span> <span m=''3151580''>strategy</span>
  <span m=''3152120''>called</span> <span m=''3152480''>work-stealing,</span> <span
  m=''3153360''>which</span> <span m=''3153540''>we''ll</span> <span m=''3153670''>talk</span>
  <span m=''3153940''>about</span> <span m=''3154100''>a</span> <span m=''3154140''>little</span>
  <span m=''3154280''>bit</span> <span m=''3154470''>more</span> <span m=''3155480''>later.</span>
  <span m=''3156640''>And</span> <span m=''3156920''>the</span> <span m=''3157000''>focus</span>
  <span m=''3157460''>for</span> <span m=''3157540''>this</span> <span m=''3157760''>is</span>
  <span m=''3157900''>on</span> <span m=''3158070''>performance.</span> <span m=''3158610''>They</span>
  <span m=''3158710''>want</span> <span m=''3158910''>to</span> <span m=''3158960''>write</span>
  <span m=''3159250''>programs</span> <span m=''3159710''>that</span> <span m=''3159800''>actually</span>
  <span m=''3160100''>perform</span> <span m=''3160570''>well.</span> </p><p><span
  m=''3163130''>So</span> <span m=''3163350''>here''s</span> <span m=''3163680''>Fibonacci</span>
  <span m=''3164350''>in</span> <span m=''3164470''>TBB.</span> <span m=''3165700''>So</span>
  <span m=''3165840''>as</span> <span m=''3165930''>you''ll</span> <span m=''3166060''>see,</span>
  <span m=''3166630''>it''s</span> <span m=''3166830''>better.</span> <span m=''3168190''>But</span>
  <span m=''3168420''>maybe</span> <span m=''3168700''>not</span> <span m=''3169990''>ideal</span>
  <span m=''3170480''>for</span> <span m=''3170600''>what</span> <span m=''3170790''>you</span>
  <span m=''3170880''>might</span> <span m=''3171080''>like</span> <span m=''3171290''>to</span>
  <span m=''3171400''>express.</span> <span m=''3176220''>So</span> <span m=''3176400''>what</span>
  <span m=''3176620''>we</span> <span m=''3176780''>do</span> <span m=''3177040''>is</span>
  <span m=''3177410''>we</span> <span m=''3177530''>declare</span> <span m=''3179710''>the</span>
  <span m=''3180050''>computer,</span> <span m=''3180920''>the</span> <span m=''3181200''>computation,</span>
  <span m=''3182070''>it''s</span> <span m=''3182240''>going</span> <span m=''3182350''>to</span>
  <span m=''3182440''>organized</span> <span m=''3183140''>as</span> <span m=''3183430''>a</span>
  <span m=''3183480''>bunch</span> <span m=''3183710''>of</span> <span m=''3183810''>explicit</span>
  <span m=''3184410''>tasks.</span> <span m=''3185290''>So</span> <span m=''3185440''>you</span>
  <span m=''3186900''>say</span> <span m=''3187140''>that</span> <span m=''3187270''>it''s</span>
  <span m=''3187400''>going</span> <span m=''3187510''>to</span> <span m=''3187560''>be</span>
  <span m=''3188070''>a</span> <span m=''3188270''>task.</span> <span m=''3190030''>And</span>
  <span m=''3191960''>FibTask</span> <span m=''3193330''>is</span> <span m=''3193670''>going</span>
  <span m=''3193810''>to</span> <span m=''3194000''>have</span> <span m=''3194180''>an</span>
  <span m=''3194270''>input</span> <span m=''3195400''>parameter,</span> <span m=''3195690''>n,</span>
  <span m=''3198500''>and</span> <span m=''3198660''>an</span> <span m=''3199280''>output</span>
  <span m=''3199520''>parameters,</span> <span m=''3200040''>sum.</span> </p><p><span
  m=''3202720''>And</span> <span m=''3202880''>what</span> <span m=''3203030''>we''re</span>
  <span m=''3203170''>going</span> <span m=''3203260''>to</span> <span m=''3203350''>do</span>
  <span m=''3203790''>is</span> <span m=''3206640''>when</span> <span m=''3206790''>the</span>
  <span m=''3206900''>task</span> <span m=''3207340''>is</span> <span m=''3207480''>started,</span>
  <span m=''3208600''>it</span> <span m=''3208990''>automatically</span> <span m=''3209790''>executes</span>
  <span m=''3210490''>the</span> <span m=''3210650''>execute</span> <span m=''3211300''>method</span>
  <span m=''3213710''>of</span> <span m=''3213900''>this</span> <span m=''3215770''>tasking</span>
  <span m=''3216890''>object</span> <span m=''3217340''>here.</span> <span m=''3218500''>And</span>
  <span m=''3218600''>the</span> <span m=''3218650''>execute</span> <span m=''3218830''>method</span>
  <span m=''3219200''>now</span> <span m=''3219430''>starts</span> <span m=''3219750''>to</span>
  <span m=''3219820''>do</span> <span m=''3219940''>something</span> <span m=''3220250''>that</span>
  <span m=''3220350''>looks</span> <span m=''3220560''>very</span> <span m=''3220770''>much</span>
  <span m=''3221000''>like</span> <span m=''3221220''>Fibonacci.</span> <span m=''3221850''>It</span>
  <span m=''3222250''>says</span> <span m=''3222470''>if</span> <span m=''3222560''>n</span>
  <span m=''3222730''>is</span> <span m=''3222850''>less</span> <span m=''3223120''>than</span>
  <span m=''3223300''>2,</span> <span m=''3225500''>sum</span> <span m=''3225850''>is</span>
  <span m=''3225950''>equal</span> <span m=''3226210''>to</span> <span m=''3226300''>n.</span>
  <span m=''3226880''>That''s</span> <span m=''3227030''>we</span> <span m=''3227150''>had</span>
  <span m=''3227310''>before.</span> <span m=''3228200''>And</span> <span m=''3228370''>otherwise.</span>
  </p><p><span m=''3229550''>And</span> <span m=''3229740''>now</span> <span m=''3229980''>what</span>
  <span m=''3230120''>we''re</span> <span m=''3230230''>going</span> <span m=''3230320''>to</span>
  <span m=''3230410''>do</span> <span m=''3230730''>is</span> <span m=''3231870''>recursively</span>
  <span m=''3232950''>create</span> <span m=''3233390''>two</span> <span m=''3233570''>child</span>
  <span m=''3234030''>tasks,</span> <span m=''3234570''>which</span> <span m=''3234790''>we</span>
  <span m=''3234960''>basically</span> <span m=''3235480''>do</span> <span m=''3235700''>with</span>
  <span m=''3237370''>this</span> <span m=''3237630''>function,</span> <span m=''3237950''>allocate_task,</span>
  <span m=''3239050''>giving</span> <span m=''3239370''>it</span> <span m=''3240790''>the</span>
  <span m=''3240920''>fib</span> <span m=''3241170''>task</span> <span m=''3246490''>a</span>
  <span m=''3246970''>name,</span> <span m=''3247490''>where</span> <span m=''3247650''>this</span>
  <span m=''3247900''>is</span> <span m=''3248060''>basically</span> <span m=''3248680''>a</span>
  <span m=''3249910''>method</span> <span m=''3250310''>for</span> <span m=''3251060''>allocating</span>
  <span m=''3251890''>out</span> <span m=''3252140''>of</span> <span m=''3252400''>a</span>
  <span m=''3253040''>particular</span> <span m=''3253620''>type</span> <span m=''3253970''>of</span>
  <span m=''3254070''>the</span> <span m=''3255140''>pool,</span> <span m=''3255770''>which</span>
  <span m=''3256010''>is an</span> <span m=''3256150''>allocate</span> <span m=''3257540''>child</span>
  <span m=''3258020''>pool.</span> </p><p><span m=''3258760''>And</span> <span m=''3258870''>then</span>
  <span m=''3259010''>similarly</span> <span m=''3259520''>for</span> <span m=''3259670''>b,</span>
  <span m=''3260010''>we</span> <span m=''3260170''>recursively</span> <span m=''3260770''>do</span>
  <span m=''3261060''>for</span> <span m=''3261280''>n</span> <span m=''3261440''>minus</span>
  <span m=''3261850''>2.</span> <span m=''3263080''>And</span> <span m=''3263250''>then</span>
  <span m=''3263410''>what</span> <span m=''3263560''>it</span> <span m=''3263700''>does</span>
  <span m=''3264030''>is</span> <span m=''3264170''>it</span> <span m=''3264320''>sets</span>
  <span m=''3264770''>the</span> <span m=''3264880''>number</span> <span m=''3265170''>of</span>
  <span m=''3265240''>tasks</span> <span m=''3265840''>to</span> <span m=''3265960''>wait</span>
  <span m=''3266300''>for.</span> <span m=''3267630''>In</span> <span m=''3267740''>this</span>
  <span m=''3267910''>case,</span> <span m=''3268190''>it''s</span> <span m=''3268330''>basically</span>
  <span m=''3268790''>two</span> <span m=''3269040''>children</span> <span m=''3269500''>plus</span>
  <span m=''3269790''>1</span> <span m=''3270130''>for</span> <span m=''3270250''>bookkeeping.</span>
  <span m=''3272140''>So</span> <span m=''3272960''>this</span> <span m=''3273410''>ends</span>
  <span m=''3273650''>up</span> <span m=''3273740''>always</span> <span m=''3274020''>being</span>
  <span m=''3274240''>one</span> <span m=''3274450''>more</span> <span m=''3274730''>than</span>
  <span m=''3274900''>the</span> <span m=''3275000''>things</span> <span m=''3275370''>that</span>
  <span m=''3275580''>you</span> <span m=''3276460''>created</span> <span m=''3276970''>as</span>
  <span m=''3277150''>subtasks.</span> </p><p><span m=''3279240''>And</span> <span
  m=''3279470''>then</span> <span m=''3279790''>what</span> <span m=''3279970''>we</span>
  <span m=''3280100''>do</span> <span m=''3280420''>is</span> <span m=''3280690''>we</span>
  <span m=''3280850''>say,</span> <span m=''3281320''>OK,</span> <span m=''3282370''>let''s</span>
  <span m=''3283210''>spawn.</span> <span m=''3284160''>So</span> <span m=''3284450''>this
  will</span> <span m=''3284680''>only</span> <span m=''3284970''>set</span> <span
  m=''3285310''>up</span> <span m=''3285540''>the</span> <span m=''3285640''>task.</span>
  <span m=''3286050''>It</span> <span m=''3286150''>doesn''t</span> <span m=''3286440''>actually</span>
  <span m=''3286730''>say,</span> <span m=''3286970''>do</span> <span m=''3287280''>it.</span>
  <span m=''3288070''>So</span> <span m=''3288270''>the</span> <span m=''3288600''>spawn</span>
  <span m=''3289170''>command</span> <span m=''3289600''>says</span> <span m=''3289830''>actually</span>
  <span m=''3290320''>do</span> <span m=''3291400''>this</span> <span m=''3291670''>computation</span>
  <span m=''3292390''>here</span> <span m=''3292620''>that</span> <span m=''3292760''>I</span>
  <span m=''3292850''>set</span> <span m=''3293130''>up.</span> <span m=''3293870''>So</span>
  <span m=''3294000''>it</span> <span m=''3294040''>actually</span> <span m=''3294330''>does</span>
  <span m=''3294730''>b.</span> </p><p><span m=''3297000''>Start</span> <span m=''3297350''>task</span>
  <span m=''3297740''>b.</span> <span m=''3298440''>And</span> <span m=''3298650''>then</span>
  <span m=''3298840''>itself,</span> <span m=''3299330''>it</span> <span m=''3299940''>executes</span>
  <span m=''3300730''>a</span> <span m=''3301260''>and</span> <span m=''3301470''>waits</span>
  <span m=''3301800''>for</span> <span m=''3302050''>all</span> <span m=''3302360''>of</span>
  <span m=''3302420''>the</span> <span m=''3302590''>other</span> <span m=''3302760''>tasks,</span>
  <span m=''3303190''>namely</span> <span m=''3303480''>both</span> <span m=''3303780''>a</span>
  <span m=''3303950''>and</span> <span m=''3304100''>b,</span> <span m=''3304270''>to</span>
  <span m=''3304340''>finish.</span> <span m=''3305640''>And</span> <span m=''3305800''>once</span>
  <span m=''3306030''>it''s</span> <span m=''3306210''>finished,</span> <span m=''3307270''>it</span>
  <span m=''3307400''>adds</span> <span m=''3307560''>the</span> <span m=''3307710''>results</span>
  <span m=''3308120''>together</span> <span m=''3308570''>to produce</span> <span
  m=''3308950''>the</span> <span m=''3309030''>final</span> <span m=''3309740''>output.</span>
  <span m=''3313300''>So</span> <span m=''3313590''>this,</span> <span m=''3314300''>notice,</span>
  <span m=''3314690''>has</span> <span m=''3315100''>the</span> <span m=''3315670''>big</span>
  <span m=''3315980''>advantage</span> <span m=''3316640''>over</span> <span m=''3316900''>the</span>
  <span m=''3317010''>previous</span> <span m=''3317600''>implementation</span> <span
  m=''3318940''>that</span> <span m=''3319120''>this</span> <span m=''3319310''>is</span>
  <span m=''3319460''>actually</span> <span m=''3319910''>recursive.</span> <span
  m=''3322260''>So</span> <span m=''3323050''>in</span> <span m=''3323280''>doing</span>
  <span m=''3323570''>Fib,</span> <span m=''3323930''>you''re</span> <span m=''3324030''>not</span>
  <span m=''3324240''>just</span> <span m=''3324420''>getting</span> <span m=''3324730''>two</span>
  <span m=''3324960''>tasks.</span> <span m=''3326010''>You''re</span> <span m=''3326140''>recursively</span>
  <span m=''3326760''>getting</span> <span m=''3327140''>each</span> <span m=''3327400''>of</span>
  <span m=''3327470''>those</span> <span m=''3327820''>two</span> <span m=''3328020''>more,</span>
  <span m=''3328850''>and</span> <span m=''3329010''>two</span> <span m=''3329140''>more,</span>
  <span m=''3329470''>and two</span> <span m=''3329690''>more,</span> <span m=''3329920''>down</span>
  <span m=''3330180''>to</span> <span m=''3330270''>the</span> <span m=''3330360''>leaves</span>
  <span m=''3330710''>of</span> <span m=''3330770''>the</span> <span m=''3330830''>computation.</span>
  </p><p><span m=''3332630''>And</span> <span m=''3332840''>then</span> <span m=''3333040''>what</span>
  <span m=''3333500''>TBB</span> <span m=''3333940''>does</span> <span m=''3334290''>is</span>
  <span m=''3334440''>it</span> <span m=''3334540''>load</span> <span m=''3334810''>balances</span>
  <span m=''3335380''>those</span> <span m=''3335700''>across</span> <span m=''3336540''>the</span>
  <span m=''3336660''>number</span> <span m=''3336950''>of</span> <span m=''3337030''>available</span>
  <span m=''3337550''>processors</span> <span m=''3340930''>by</span> <span m=''3341130''>creating</span>
  <span m=''3341650''>these</span> <span m=''3341880''>tasks.</span> <span m=''3342450''>And</span>
  <span m=''3342580''>then,</span> <span m=''3342850''>it</span> <span m=''3343210''>automatically</span>
  <span m=''3343910''>does</span> <span m=''3344170''>all</span> <span m=''3344310''>the</span>
  <span m=''3344440''>load</span> <span m=''3344680''>balancing</span> <span m=''3345190''>of</span>
  <span m=''3345270''>the</span> <span m=''3345340''>tasks</span> <span m=''3345770''>and</span>
  <span m=''3345900''>so</span> <span m=''3346020''>forth.</span> <span m=''3347610''>Questions</span>
  <span m=''3348060''>about</span> <span m=''3348290''>that?</span> <span m=''3350180''>Any</span>
  <span m=''3350290''>questions?</span> </p><p><span m=''3351130''>I</span> <span
  m=''3351250''>don''t</span> <span m=''3351370''>expect</span> <span m=''3351720''>you</span>
  <span m=''3351810''>to</span> <span m=''3351900''>be</span> <span m=''3352070''>able</span>
  <span m=''3352220''>to</span> <span m=''3352790''>program</span> <span m=''3353470''>a</span>
  <span m=''3353930''>TBB,</span> <span m=''3355250''>unless</span> <span m=''3355680''>I</span>
  <span m=''3355720''>gave</span> <span m=''3355970''>you</span> <span m=''3356100''>a</span>
  <span m=''3356140''>book</span> <span m=''3356390''>and</span> <span m=''3356520''>said,</span>
  <span m=''3356700''>program</span> <span m=''3357060''>a TBB.</span> <span m=''3357480''>But</span>
  <span m=''3357680''>I''m not</span> <span m=''3357870''>going to</span> <span m=''3357910''>do</span>
  <span m=''3358060''>that.</span> <span m=''3360900''>This</span> <span m=''3361070''>is</span>
  <span m=''3361110''>mainly</span> <span m=''3361500''>to</span> <span m=''3361570''>give</span>
  <span m=''3361750''>you</span> <span m=''3361850''>a</span> <span m=''3361880''>flavor</span>
  <span m=''3362330''>of</span> <span m=''3362430''>what''s</span> <span m=''3362670''>in</span>
  <span m=''3362820''>there.</span> <span m=''3363320''>What</span> <span m=''3363500''>the</span>
  <span m=''3363610''>alternatives</span> <span m=''3364130''>are.</span> </p><p><span
  m=''3365500''>So</span> <span m=''3365830''>TBB</span> <span m=''3366400''>provides</span>
  <span m=''3366930''>many</span> <span m=''3367320''>C++</span> <span m=''3368090''>templates</span>
  <span m=''3368540''>that</span> <span m=''3368670''>simplify</span> <span m=''3369330''>common</span>
  <span m=''3369730''>patterns.</span> <span m=''3370150''>So</span> <span m=''3370330''>rather</span>
  <span m=''3370690''>than</span> <span m=''3370840''>having</span> <span m=''3371610''>to</span>
  <span m=''3371760''>write</span> <span m=''3372150''>that</span> <span m=''3372340''>kind</span>
  <span m=''3372510''>of</span> <span m=''3372680''>thing</span> <span m=''3372870''>for</span>
  <span m=''3373020''>everything,</span> <span m=''3373600''>for</span> <span m=''3373750''>example,</span>
  <span m=''3374890''>if</span> <span m=''3375060''>you</span> <span m=''3375190''>have</span>
  <span m=''3375320''>loop</span> <span m=''3375620''>parallelism.</span> <span m=''3376010''>If</span>
  <span m=''3376400''>you</span> <span m=''3376560''>have</span> <span m=''3376790''>n</span>
  <span m=''3377130''>things</span> <span m=''3377490''>that</span> <span m=''3377580''>you</span>
  <span m=''3377670''>want</span> <span m=''3377850''>to</span> <span m=''3378030''>have</span>
  <span m=''3378210''>that</span> <span m=''3378940''>operate</span> <span m=''3379380''>parallel,</span>
  <span m=''3380940''>you</span> <span m=''3381160''>can</span> <span m=''3381320''>do</span>
  <span m=''3381480''>a</span> <span m=''3381610''>parallel</span> <span m=''3382250''>four</span>
  <span m=''3382600''>and</span> <span m=''3382740''>not</span> <span m=''3383210''>actually</span>
  <span m=''3383520''>see</span> <span m=''3383800''>the</span> <span m=''3383910''>tasks.</span>
  <span m=''3384500''>It</span> <span m=''3384700''>covers</span> <span m=''3385050''>them</span>
  <span m=''3385120''>over</span> <span m=''3386540''>and</span> <span m=''3386720''>creates</span>
  <span m=''3387310''>the</span> <span m=''3387450''>tasks</span> <span m=''3387960''>automatically,</span>
  <span m=''3388710''>so</span> <span m=''3388850''>that you can</span> <span m=''3389040''>just</span>
  <span m=''3389250''>say,</span> <span m=''3390470''>for</span> <span m=''3390700''>I</span>
  <span m=''3390840''>gets</span> <span m=''3391060''>1 to</span> <span m=''3391380''>n,</span>
  <span m=''3392940''>do</span> <span m=''3393160''>this</span> <span m=''3393510''>to
  all</span> <span m=''3393940''>I,</span> <span m=''3394390''>and</span> <span m=''3394530''>do</span>
  <span m=''3394640''>them</span> <span m=''3394790''>at</span> <span m=''3394870''>the</span>
  <span m=''3394930''>same</span> <span m=''3395230''>time</span> <span m=''3395800''>essentially.</span>
  <span m=''3396220''>And it</span> <span m=''3396510''>then</span> <span m=''3396750''>balances</span>
  <span m=''3397310''>those</span> <span m=''3397590''>and</span> <span m=''3397710''>so</span>
  <span m=''3397830''>forth.</span> </p><p><span m=''3399920''>It</span> <span m=''3400680''>also</span>
  <span m=''3401110''>has</span> <span m=''3401450''>to</span> <span m=''3401530''>things</span>
  <span m=''3401830''>like</span> <span m=''3402020''>parallel</span> <span m=''3402530''>reduce.</span>
  <span m=''3402930''>Sometimes</span> <span m=''3403370''>what</span> <span m=''3403510''>you</span>
  <span m=''3403640''>want</span> <span m=''3403810''>to</span> <span m=''3403870''>do</span>
  <span m=''3404030''>across</span> <span m=''3404490''>an</span> <span m=''3404630''>array</span>
  <span m=''3404930''>is</span> <span m=''3405100''>not</span> <span m=''3405370''>just</span>
  <span m=''3406730''>do</span> <span m=''3406880''>something</span> <span m=''3407270''>for</span>
  <span m=''3407410''>every</span> <span m=''3407690''>element</span> <span m=''3408020''>of</span>
  <span m=''3408100''>the</span> <span m=''3408220''>array.</span> <span m=''3408530''>You</span>
  <span m=''3408630''>may</span> <span m=''3408780''>want</span> <span m=''3408930''>to</span>
  <span m=''3409000''>add</span> <span m=''3409310''>up</span> <span m=''3409500''>all</span>
  <span m=''3409680''>the</span> <span m=''3409810''>elements</span> <span m=''3410200''>into</span>
  <span m=''3410390''>a</span> <span m=''3410440''>single</span> <span m=''3410800''>value.</span>
  <span m=''3411770''>And</span> <span m=''3411930''>so</span> <span m=''3412080''>it</span>
  <span m=''3412170''>basically</span> <span m=''3412610''>has</span> <span m=''3412950''>what''s</span>
  <span m=''3413170''>called</span> <span m=''3413460''>a reduction</span> <span m=''3414480''>function.</span>
  <span m=''3414870''>It does</span> <span m=''3415370''>parallel</span> <span m=''3415740''>reduce
  to</span> <span m=''3416160''>aggregate.</span> <span m=''3416980''>And</span> <span
  m=''3417320''>it''s got various</span> <span m=''3417660''>other</span> <span m=''3417840''>things,</span>
  <span m=''3418110''>like</span> <span m=''3418280''>pipelining</span> <span m=''3418940''>and</span>
  <span m=''3419120''>filtering</span> <span m=''3419840''>for</span> <span m=''3419980''>doing</span>
  <span m=''3420480''>what''s</span> <span m=''3420740''>called</span> <span m=''3420990''>software</span>
  <span m=''3421460''>pipelining,</span> <span m=''3422250''>where</span> <span m=''3422490''>you</span>
  <span m=''3422600''>have</span> <span m=''3422700''>one</span> <span m=''3426990''>subsystem</span>
  <span m=''3427770''>that</span> <span m=''3427940''>basically</span> <span m=''3428490''>is</span>
  <span m=''3428650''>going</span> <span m=''3428770''>to</span> <span m=''3428810''>process</span>
  <span m=''3429430''>the</span> <span m=''3429520''>data</span> <span m=''3429810''>and</span>
  <span m=''3429930''>pass</span> <span m=''3430220''>it</span> <span m=''3430330''>to</span>
  <span m=''3430420''>the</span> <span m=''3430510''>next.</span> <span m=''3431230''>So
  you''re going to</span> <span m=''3431400''>process it</span> <span m=''3431900''>and</span>
  <span m=''3432060''>pass</span> <span m=''3432330''>it</span> <span m=''3432450''>to</span>
  <span m=''3432550''>the</span> <span m=''3432810''>next.</span> <span m=''3433270''>And
  it</span> <span m=''3433410''>allows</span> <span m=''3433770''>you</span> <span
  m=''3433880''>to</span> <span m=''3433940''>set</span> <span m=''3434160''>up</span>
  <span m=''3434270''>a</span> <span m=''3434320''>software</span> <span m=''3434820''>pipeline</span>
  <span m=''3437380''>of</span> <span m=''3437580''>things.</span> </p><p><span m=''3438810''>It</span>
  <span m=''3439090''>also</span> <span m=''3439430''>collides</span> <span m=''3439900''>with</span>
  <span m=''3440190''>some</span> <span m=''3440980''>container</span> <span m=''3441350''>classes,</span>
  <span m=''3441840''>such</span> <span m=''3442060''>as</span> <span m=''3442150''>hash</span>
  <span m=''3442490''>tables,</span> <span m=''3442870''>concurrent</span> <span m=''3443230''>hash</span>
  <span m=''3443500''>tables,</span> <span m=''3444220''>that</span> <span m=''3444320''>allow</span>
  <span m=''3444610''>you</span> <span m=''3444850''>to</span> <span m=''3444960''>have</span>
  <span m=''3445180''>multiple</span> <span m=''3451360''>tasks</span> <span m=''3451920''>beating</span>
  <span m=''3452260''>on</span> <span m=''3453030''>a</span> <span m=''3453070''>hash</span>
  <span m=''3453370''>table.</span> <span m=''3453670''>Inserting</span> <span m=''3454140''>and</span>
  <span m=''3454250''>deleting</span> <span m=''3454730''>from the</span> <span m=''3454770''>hash</span>
  <span m=''3455050''>table</span> <span m=''3455350''>at the</span> <span m=''3455420''>same</span>
  <span m=''3455680''>time</span> <span m=''3456560''>and</span> <span m=''3456780''>a</span>
  <span m=''3456820''>variety</span> <span m=''3457390''>of</span> <span m=''3457460''>mutual</span>
  <span m=''3457830''>exclusion</span> <span m=''3458360''>library</span> <span m=''3458820''>functions,</span>
  <span m=''3459790''>including</span> <span m=''3460220''>locks</span> <span m=''3460750''>and</span>
  <span m=''3460910''>atomic</span> <span m=''3461330''>updates.</span> <span m=''3462630''>So</span>
  <span m=''3462860''>it</span> <span m=''3462900''>has</span> <span m=''3463160''>a</span>
  <span m=''3463260''>bunch</span> <span m=''3463570''>of</span> <span m=''3463680''>other</span>
  <span m=''3463870''>facilities</span> <span m=''3464890''>that</span> <span m=''3465860''>make</span>
  <span m=''3466170''>it</span> <span m=''3467960''>much</span> <span m=''3468230''>easier</span>
  <span m=''3468590''>to</span> <span m=''3468640''>use</span> <span m=''3469110''>than</span>
  <span m=''3469330''>just</span> <span m=''3469550''>using</span> <span m=''3469850''>the</span>
  <span m=''3469930''>raw</span> <span m=''3470230''>task</span> <span m=''3470670''>interface.</span>
  </p><p><span m=''3474360''>OpenMP.</span> <span m=''3477220''>So</span> <span m=''3477710''>OpenMP</span>
  <span m=''3478120''>is</span> <span m=''3478280''>a</span> <span m=''3478350''>specification</span>
  <span m=''3479070''>produced</span> <span m=''3479410''>by</span> <span m=''3479530''>an</span>
  <span m=''3479620''>industry</span> <span m=''3480100''>consortium</span> <span
  m=''3481900''>of</span> <span m=''3482070''>which</span> <span m=''3482840''>the</span>
  <span m=''3483030''>principal</span> <span m=''3483500''>players--</span> <span
  m=''3484290''>the</span> <span m=''3484660''>original</span> <span m=''3485020''>principal</span>
  <span m=''3485410''>player</span> <span m=''3485750''>was</span> <span m=''3485950''>Silicon</span>
  <span m=''3486330''>Graphics,</span> <span m=''3487430''>which</span> <span m=''3489780''>essentially</span>
  <span m=''3490470''>has</span> <span m=''3490950''>become</span> <span m=''3492170''>less</span>
  <span m=''3492490''>important</span> <span m=''3492930''>in</span> <span m=''3493050''>the</span>
  <span m=''3493160''>industry,</span> <span m=''3493600''>let''s</span> <span m=''3493840''>say.</span>
  <span m=''3494080''>Put</span> <span m=''3494200''>it</span> <span m=''3494280''>that</span>
  <span m=''3494490''>way.</span> <span m=''3495820''>And</span> <span m=''3496350''>for</span>
  <span m=''3496430''>the</span> <span m=''3496630''>most</span> <span m=''3496820''>part,</span>
  <span m=''3497090''>recently,</span> <span m=''3497640''>it''s</span> <span m=''3497880''>been</span>
  <span m=''3498850''>players</span> <span m=''3499270''>from</span> <span m=''3499680''>Intel</span>
  <span m=''3500790''>and</span> <span m=''3501020''>Sun,</span> <span m=''3501500''>which</span>
  <span m=''3501740''>is</span> <span m=''3501850''>now</span> <span m=''3503020''>no</span>
  <span m=''3503170''>longer</span> <span m=''3503520''>Sun,</span> <span m=''3503880''>except</span>
  <span m=''3504180''>that</span> <span m=''3504290''>it</span> <span m=''3504420''>is</span>
  <span m=''3505200''>Sun</span> <span m=''3505700''>part</span> <span m=''3505910''>of</span>
  <span m=''3506120''>Oracle,</span> <span m=''3509431''>and</span> <span m=''3509820''>of</span>
  <span m=''3510140''>IBM,</span> <span m=''3510790''>and</span> <span m=''3511600''>variety</span>
  <span m=''3511950''>of</span> <span m=''3512040''>other</span> <span m=''3513160''>industry</span>
  <span m=''3514880''>players.</span> </p><p><span m=''3517200''>There''s</span> <span
  m=''3517390''>several</span> <span m=''3517720''>compilers</span> <span m=''3518320''>available.</span>
  <span m=''3519430''>Both</span> <span m=''3519770''>open</span> <span m=''3520110''>source</span>
  <span m=''3520590''>and</span> <span m=''3521010''>proprietary,</span> <span m=''3522130''>including</span>
  <span m=''3522770''>gcc,</span> <span m=''3523860''>has</span> <span m=''3524090''>OpenMP</span>
  <span m=''3524790''>built-in.</span> <span m=''3526190''>And</span> <span m=''3526410''>also,</span>
  <span m=''3526940''>Visual</span> <span m=''3527350''>Studio</span> <span m=''3528100''>has</span>
  <span m=''3528530''>OpenMP</span> <span m=''3529100''>built-in.</span> <span m=''3531370''>These</span>
  <span m=''3531890''>are a set of</span> <span m=''3532650''>linguistic</span> <span
  m=''3533150''>extensions</span> <span m=''3533830''>to</span> <span m=''3533950''>C</span>
  <span m=''3534410''>and</span> <span m=''3535040''>C++</span> <span m=''3535360''>or</span>
  <span m=''3535460''>Fortran</span> <span m=''3536770''>in</span> <span m=''3537010''>the</span>
  <span m=''3537100''>form</span> <span m=''3537480''>of</span> <span m=''3538050''>compiler</span>
  <span m=''3538120''>practice</span> <span m=''3538830''>pragmas.</span> <span m=''3539710''>So</span>
  <span m=''3540180''>who</span> <span m=''3540310''>knows</span> <span m=''3540540''>what</span>
  <span m=''3540640''>a</span> <span m=''3540700''>pragma</span> <span m=''3541260''>is?</span>
  <span m=''3543460''>OK.</span> <span m=''3545150''>Good.</span> <span m=''3545350''>Can
  you</span> <span m=''3545530''>tell</span> <span m=''3545740''>us</span> <span m=''3545890''>what
  a</span> <span m=''3545950''>pragma is?</span> </p><p><span m=''3546490''>AUDIENCE:
  [INAUDIBLE PHRASE]</span> </p><p><span m=''3552140''>PROFESSOR: Yeah,</span> <span
  m=''3552450''>it''s</span> <span m=''3552570''>kind</span> <span m=''3552750''>of</span>
  <span m=''3552930''>like</span> <span m=''3553130''>a</span> <span m=''3553220''>compiler</span>
  <span m=''3553780''>hint.</span> <span m=''3555390''>It''s</span> <span m=''3555530''>a</span>
  <span m=''3555590''>way</span> <span m=''3555880''>of</span> <span m=''3555970''>saying</span>
  <span m=''3556980''>to</span> <span m=''3557100''>the</span> <span m=''3557190''>compiler,</span>
  <span m=''3557720''>here''s</span> <span m=''3557990''>something</span> <span m=''3558370''>I</span>
  <span m=''3558420''>want</span> <span m=''3558590''>to</span> <span m=''3558670''>tell</span>
  <span m=''3558920''>you</span> <span m=''3559110''>about</span> <span m=''3559920''>the</span>
  <span m=''3560050''>code</span> <span m=''3560330''>that</span> <span m=''3560450''>I''m</span>
  <span m=''3560550''>writing.</span> <span m=''3561970''>And</span> <span m=''3563140''>it</span>
  <span m=''3563340''>basically</span> <span m=''3564060''>is</span> <span m=''3564220''>a</span>
  <span m=''3564290''>hint.</span> <span m=''3565150''>So</span> <span m=''3565330''>technically,</span>
  <span m=''3565930''>it''s</span> <span m=''3566090''>not</span> <span m=''3566340''>supposed</span>
  <span m=''3566700''>to</span> <span m=''3566770''>have</span> <span m=''3567030''>any</span>
  <span m=''3567280''>semantic</span> <span m=''3567920''>impact,</span> <span m=''3568480''>but</span>
  <span m=''3568620''>rather</span> <span m=''3568980''>suggest</span> <span m=''3569950''>how</span>
  <span m=''3570120''>something</span> <span m=''3570560''>might</span> <span m=''3570810''>be</span>
  <span m=''3570950''>implemented</span> <span m=''3571490''>by</span> <span m=''3571700''>the</span>
  <span m=''3571810''>compiler.</span> </p><p><span m=''3573810''>However,</span>
  <span m=''3573990''>in</span> <span m=''3574255''>OpenMP''s</span> <span m=''3574990''>case,</span>
  <span m=''3576060''>they</span> <span m=''3576160''>actually</span> <span m=''3576420''>have</span>
  <span m=''3576680''>a</span> <span m=''3577260''>compiler--</span> <span m=''3579110''>it</span>
  <span m=''3579300''>does</span> <span m=''3579540''>change</span> <span m=''3579820''>the</span>
  <span m=''3579910''>semantics</span> <span m=''3580470''>in</span> <span m=''3580570''>certain</span>
  <span m=''3580950''>cases.</span> <span m=''3582570''>It</span> <span m=''3582760''>runs</span>
  <span m=''3583020''>on</span> <span m=''3583120''>top</span> <span m=''3583410''>of</span>
  <span m=''3583500''>native</span> <span m=''3583910''>threads</span> <span m=''3584340''>and
  it</span> <span m=''3584510''>supports,</span> <span m=''3584990''>especially,</span>
  <span m=''3585500''>loop</span> <span m=''3585770''>parallelism.</span> <span m=''3586700''>And</span>
  <span m=''3586880''>then,</span> <span m=''3587010''>in</span> <span m=''3587100''>the</span>
  <span m=''3587190''>latest</span> <span m=''3587680''>version,</span> <span m=''3588070''>it</span>
  <span m=''3588180''>supports</span> <span m=''3588640''>a</span> <span m=''3588720''>kind</span>
  <span m=''3588980''>of</span> <span m=''3589050''>task</span> <span m=''3589440''>parallelism</span>
  <span m=''3589950''>like</span> <span m=''3592580''>we</span> <span m=''3592670''>saw</span>
  <span m=''3592910''>with</span> <span m=''3593120''>TBB.</span> </p><p><span m=''3594560''>So,</span>
  <span m=''3594910''>in</span> <span m=''3595090''>fact,</span> <span m=''3595420''>their</span>
  <span m=''3595550''>task</span> <span m=''3595890''>parallelism</span> <span m=''3596270''>is</span>
  <span m=''3596410''>fairly</span> <span m=''3597010''>to</span> <span m=''3597100''>specify.</span>
  <span m=''3598750''>So</span> <span m=''3598920''>here''s</span> <span m=''3599310''>the</span>
  <span m=''3599730''>Fib</span> <span m=''3600130''>code.</span> <span m=''3600420''>So</span>
  <span m=''3600560''>now,</span> <span m=''3600800''>this</span> <span m=''3600980''>is</span>
  <span m=''3601130''>not</span> <span m=''3601460''>looking</span> <span m=''3601770''>too</span>
  <span m=''3601920''>bad.</span> <span m=''3603710''>We</span> <span m=''3603810''>basically</span>
  <span m=''3604310''>inserted</span> <span m=''3605410''>a</span> <span m=''3605500''>few</span>
  <span m=''3605750''>lines</span> <span m=''3606170''>here.</span> <span m=''3606960''>And</span>
  <span m=''3607140''>otherwise,</span> <span m=''3607710''>we</span> <span m=''3607830''>actually</span>
  <span m=''3608070''>have</span> <span m=''3608310''>the</span> <span m=''3608440''>original</span>
  <span m=''3611000''>Fibonacci</span> <span m=''3611710''>code.</span> <span m=''3613530''>So</span>
  <span m=''3615460''>the</span> <span m=''3615630''>sharp</span> <span m=''3616090''>pragma</span>
  <span m=''3616410''>says,</span> <span m=''3616670''>here''s</span> <span m=''3616890''>a</span>
  <span m=''3616990''>compiler</span> <span m=''3617550''>directive.</span> <span
  m=''3618520''>And</span> <span m=''3618690''>it says, the</span> <span m=''3619080''>OMP</span>
  <span m=''3619700''>says</span> <span m=''3620160''>it</span> <span m=''3620330''>is</span>
  <span m=''3620690''>an</span> <span m=''3621450''>OpenMP</span> <span m=''3622100''>compiler</span>
  <span m=''3622570''>directive.</span> </p><p><span m=''3624210''>The</span> <span
  m=''3624330''>task</span> <span m=''3624820''>says,</span> <span m=''3625140''>oh,</span>
  <span m=''3625290''>the</span> <span m=''3625390''>following</span> <span m=''3625800''>things</span>
  <span m=''3626070''>should</span> <span m=''3626210''>be</span> <span m=''3626850''>interpreted</span>
  <span m=''3627360''>as</span> <span m=''3627480''>an</span> <span m=''3627570''>independent</span>
  <span m=''3628100''>task.</span> <span m=''3630000''>And</span> <span m=''3630190''>now,</span>
  <span m=''3631180''>the</span> <span m=''3631400''>sharing</span> <span m=''3631800''>of</span>
  <span m=''3631910''>memory</span> <span m=''3632460''>in</span> <span m=''3632750''>OpenMP</span>
  <span m=''3633300''>is</span> <span m=''3633410''>managed</span> <span m=''3633760''>explicitly,</span>
  <span m=''3634470''>because</span> <span m=''3634780''>they''re</span> <span m=''3634900''>trying</span>
  <span m=''3635210''>to</span> <span m=''3635320''>allow</span> <span m=''3635600''>for</span>
  <span m=''3635760''>programming</span> <span m=''3636360''>both</span> <span m=''3636800''>of</span>
  <span m=''3637450''>distributed</span> <span m=''3638010''>memory</span> <span m=''3638330''>clusters,</span>
  <span m=''3639360''>as</span> <span m=''3639570''>well</span> <span m=''3639950''>as</span>
  <span m=''3640070''>shared</span> <span m=''3640460''>memory</span> <span m=''3640730''>machines.</span>
  </p><p><span m=''3643000''>And</span> <span m=''3643150''>so,</span> <span m=''3644970''>you</span>
  <span m=''3645110''>have</span> <span m=''3645250''>to</span> <span m=''3645330''>explicitly</span>
  <span m=''3645890''>name</span> <span m=''3646330''>the</span> <span m=''3647010''>shared</span>
  <span m=''3647360''>variables</span> <span m=''3647900''>that</span> <span m=''3648020''>you''re</span>
  <span m=''3648110''>using.</span> <span m=''3650000''>And</span> <span m=''3650690''>here,</span>
  <span m=''3651060''>we''re</span> <span m=''3651180''>basically</span> <span m=''3651650''>saying,</span>
  <span m=''3651940''>wait</span> <span m=''3652280''>for</span> <span m=''3652410''>the</span>
  <span m=''3652550''>two</span> <span m=''3652740''>things</span> <span m=''3653110''>that</span>
  <span m=''3653190''>we</span> <span m=''3653360''>spawned</span> <span m=''3654090''>off</span>
  <span m=''3654410''>here</span> <span m=''3654750''>to</span> <span m=''3655040''>complete.</span>
  <span m=''3656180''>So</span> <span m=''3656360''>pretty</span> <span m=''3656630''>simple</span>
  <span m=''3659140''>code.</span> </p><p><span m=''3660430''>It</span> <span m=''3662160''>provides</span>
  <span m=''3662540''>many</span> <span m=''3662760''>pragma</span> <span m=''3663210''>directives</span>
  <span m=''3663730''>to</span> <span m=''3663830''>express</span> <span m=''3664300''>common</span>
  <span m=''3665250''>patterns,</span> <span m=''3666090''>such</span> <span m=''3666390''>as</span>
  <span m=''3666510''>a</span> <span m=''3666620''>parallel</span> <span m=''3667480''>for</span>
  <span m=''3667920''>parallelization.</span> <span m=''3668990''>It</span> <span
  m=''3669100''>also</span> <span m=''3669360''>has</span> <span m=''3669530''>reduction.</span>
  <span m=''3670230''>It</span> <span m=''3670350''>also</span> <span m=''3670630''>has</span>
  <span m=''3670780''>directives</span> <span m=''3671620''>for</span> <span m=''3671820''>scheduling</span>
  <span m=''3672630''>and</span> <span m=''3673170''>data</span> <span m=''3673650''>sharing.</span>
  <span m=''3674490''>And</span> <span m=''3674640''>it</span> <span m=''3674680''>has</span>
  <span m=''3674900''>a</span> <span m=''3674960''>whole</span> <span m=''3675170''>bunch</span>
  <span m=''3675490''>of</span> <span m=''3675600''>synchronization</span> <span m=''3676360''>constructs</span>
  <span m=''3676990''>and</span> <span m=''3677140''>so</span> <span m=''3677290''>forth.</span>
  <span m=''3678010''>So</span> <span m=''3678200''>it''s</span> <span m=''3678330''>another</span>
  <span m=''3679080''>interesting</span> <span m=''3680410''>one</span> <span m=''3681060''>to</span>
  <span m=''3681190''>do.</span> </p><p><span m=''3681650''>The</span> <span m=''3681780''>main</span>
  <span m=''3682160''>downside,</span> <span m=''3682700''>I</span> <span m=''3682790''>would</span>
  <span m=''3682880''>say,</span> <span m=''3683060''>of</span> <span m=''3683180''>OpenMP</span>
  <span m=''3683850''>is</span> <span m=''3684140''>that</span> <span m=''3684280''>the</span>
  <span m=''3684370''>performance</span> <span m=''3685050''>is</span> <span m=''3685240''>not</span>
  <span m=''3685530''>really</span> <span m=''3685820''>very</span> <span m=''3686140''>composable.</span>
  <span m=''3687990''>So</span> <span m=''3688170''>if</span> <span m=''3688260''>you</span>
  <span m=''3688500''>have</span> <span m=''3688820''>a</span> <span m=''3688960''>program</span>
  <span m=''3689460''>you''ve</span> <span m=''3689660''>written</span> <span m=''3689860''>with</span>
  <span m=''3690000''>OpenMP</span> <span m=''3690660''>over</span> <span m=''3690880''>here,</span>
  <span m=''3691540''>another</span> <span m=''3691890''>one here,</span> <span m=''3692340''>and</span>
  <span m=''3692420''>you</span> <span m=''3692500''>want</span> <span m=''3692650''>to</span>
  <span m=''3692690''>put</span> <span m=''3692940''>them</span> <span m=''3693090''>together,</span>
  <span m=''3694560''>they</span> <span m=''3694780''>fight</span> <span m=''3695130''>with</span>
  <span m=''3695290''>each</span> <span m=''3695490''>other.</span> <span m=''3697380''>You</span>
  <span m=''3697830''>have</span> <span m=''3698040''>to</span> <span m=''3698150''>have</span>
  <span m=''3698440''>your</span> <span m=''3698960''>concept</span> <span m=''3699650''>of</span>
  <span m=''3699830''>what</span> <span m=''3700130''>are</span> <span m=''3700310''>going</span>
  <span m=''3700460''>to</span> <span m=''3700530''>be</span> <span m=''3701220''>the</span>
  <span m=''3701700''>programs.</span> </p><p><span m=''3702350''>The</span> <span
  m=''3702450''>task</span> <span m=''3702800''>parallelism</span> <span m=''3703570''>helps</span>
  <span m=''3703920''>a</span> <span m=''3703980''>bit</span> <span m=''3704310''>with</span>
  <span m=''3704870''>that.</span> <span m=''3705250''>But</span> <span m=''3705430''>the</span>
  <span m=''3705520''>basic</span> <span m=''3706090''>OpenMP</span> <span m=''3707170''>is</span>
  <span m=''3707330''>very</span> <span m=''3707560''>much</span> <span m=''3707930''>of</span>
  <span m=''3708120''>the</span> <span m=''3708210''>model,</span> <span m=''3708910''>I</span>
  <span m=''3709020''>know</span> <span m=''3709220''>how</span> <span m=''3709410''>many</span>
  <span m=''3709590''>cores</span> <span m=''3709960''>I''m</span> <span m=''3710080''>running</span>
  <span m=''3710360''>on.</span> <span m=''3710800''>I</span> <span m=''3710920''>can</span>
  <span m=''3711100''>set</span> <span m=''3711450''>that.</span> <span m=''3712350''>And</span>
  <span m=''3712520''>then</span> <span m=''3712690''>I</span> <span m=''3712810''>can</span>
  <span m=''3713520''>have</span> <span m=''3713880''>it</span> <span m=''3714200''>automatically</span>
  <span m=''3714840''>parse</span> <span m=''3715180''>up</span> <span m=''3715330''>the</span>
  <span m=''3715430''>work</span> <span m=''3715760''>for</span> <span m=''3715890''>those</span>
  <span m=''3716540''>many.</span> </p><p><span m=''3716820''>But</span> <span m=''3717000''>once</span>
  <span m=''3717210''>you''ve</span> <span m=''3717370''>done</span> <span m=''3717620''>that,</span>
  <span m=''3718610''>some</span> <span m=''3718870''>other</span> <span m=''3719170''>job,</span>
  <span m=''3719940''>some</span> <span m=''3720090''>other</span> <span m=''3720310''>part</span>
  <span m=''3720600''>of</span> <span m=''3720650''>the</span> <span m=''3720730''>system</span>
  <span m=''3721070''>that</span> <span m=''3721160''>wants</span> <span m=''3721390''>to</span>
  <span m=''3721450''>do</span> <span m=''3721540''>the</span> <span m=''3721650''>same</span>
  <span m=''3721920''>thing,</span> <span m=''3722680''>then</span> <span m=''3723040''>you</span>
  <span m=''3723170''>get</span> <span m=''3723300''>oversubscription</span> <span
  m=''3724190''>and</span> <span m=''3724470''>perhaps</span> <span m=''3726930''>some</span>
  <span m=''3727240''>[UNINTELLIGIBLE].</span> <span m=''3727490''>Nevertheless,</span>
  <span m=''3728040''>a</span> <span m=''3728100''>very</span> <span m=''3728420''>interesting</span>
  <span m=''3730600''>system.</span> <span m=''3730970''>And</span> <span m=''3731140''>very</span>
  <span m=''3731380''>accessible,</span> <span m=''3732000''>because</span> <span
  m=''3732520''>it''s</span> <span m=''3733530''>in</span> <span m=''3734110''>most</span>
  <span m=''3734460''>of</span> <span m=''3734510''>the</span> <span m=''3734590''>standard</span>
  <span m=''3734960''>compilers</span> <span m=''3735520''>these</span> <span m=''3735720''>days.</span>
  </p><p><span m=''3739090''>What</span> <span m=''3739290''>we''re</span> <span m=''3739450''>going</span>
  <span m=''3739540''>to</span> <span m=''3739630''>look</span> <span m=''3739900''>at</span>
  <span m=''3740190''>is</span> <span m=''3740460''>Cilk++.</span> <span m=''3743130''>So</span>
  <span m=''3743500''>this</span> <span m=''3743650''>is</span> <span m=''3743820''>actually</span>
  <span m=''3744510''>a</span> <span m=''3745300''>small</span> <span m=''3745740''>set</span>
  <span m=''3745950''>of</span> <span m=''3746030''>linguistics</span> <span m=''3746720''>extensions</span>
  <span m=''3748740''>to</span> <span m=''3748880''>C++</span> <span m=''3749145''>to
  support</span> <span m=''3749410''>fork-join</span> <span m=''3750090''>parallelism.</span>
  <span m=''3751320''>And</span> <span m=''3751480''>it</span> <span m=''3751520''>was</span>
  <span m=''3751670''>developed</span> <span m=''3752130''>by</span> <span m=''3752350''>Cilk</span>
  <span m=''3752630''>Arts,</span> <span m=''3753060''>which</span> <span m=''3753220''>is</span>
  <span m=''3753320''>an</span> <span m=''3753390''>MIT</span> <span m=''3753890''>spin-off,</span>
  <span m=''3755420''>which</span> <span m=''3755670''>was</span> <span m=''3755810''>acquired</span>
  <span m=''3756250''>by</span> <span m=''3756400''>Intel</span> <span m=''3757180''>last</span>
  <span m=''3757800''>year.</span> <span m=''3758050''>So</span> <span m=''3758170''>this</span>
  <span m=''3758320''>is</span> <span m=''3758450''>now</span> <span m=''3758660''>an</span>
  <span m=''3758760''>Intel</span> <span m=''3759140''>technology.</span> </p><p><span
  m=''3760790''>And</span> <span m=''3761430''>the</span> <span m=''3761680''>reason</span>
  <span m=''3762110''>I</span> <span m=''3762220''>know</span> <span m=''3762400''>about</span>
  <span m=''3762640''>it</span> <span m=''3762740''>is</span> <span m=''3762850''>because</span>
  <span m=''3763040''>I</span> <span m=''3763120''>was</span> <span m=''3763270''>the</span>
  <span m=''3763350''>founder</span> <span m=''3763770''>of</span> <span m=''3763830''>Cilk</span>
  <span m=''3764040''>Arts.</span> <span m=''3764680''>It was</span> <span m=''3764840''>based</span>
  <span m=''3765160''>on</span> <span m=''3765290''>15</span> <span m=''3765750''>years</span>
  <span m=''3766010''>of</span> <span m=''3766100''>research</span> <span m=''3766550''>at</span>
  <span m=''3766600''>MIT</span> <span m=''3767890''>out</span> <span m=''3768080''>of</span>
  <span m=''3768150''>my</span> <span m=''3768300''>research</span> <span m=''3768760''>group.</span>
  <span m=''3770940''>And</span> <span m=''3771300''>we</span> <span m=''3771560''>won</span>
  <span m=''3773270''>a</span> <span m=''3773360''>bunch</span> <span m=''3773590''>of</span>
  <span m=''3773660''>awards,</span> <span m=''3774080''>actually,</span> <span m=''3774430''>for</span>
  <span m=''3774540''>this</span> <span m=''3774690''>work.</span> </p><p><span m=''3775850''>In</span>
  <span m=''3775970''>fact,</span> <span m=''3776240''>the</span> <span m=''3776320''>work-stealing</span>
  <span m=''3776950''>scheduler</span> <span m=''3777650''>that''s</span> <span m=''3777940''>in</span>
  <span m=''3778120''>it</span> <span m=''3779150''>is</span> <span m=''3779490''>provably</span>
  <span m=''3780040''>efficient.</span> <span m=''3780500''>In</span> <span m=''3780560''>other</span>
  <span m=''3780680''>words,</span> <span m=''3780800''>it''s</span> <span m=''3780940''>not</span>
  <span m=''3781130''>just</span> <span m=''3781350''>a</span> <span m=''3781410''>heuristic</span>
  <span m=''3781870''>scheduler.</span> <span m=''3782440''>It''s</span> <span m=''3782570''>actually</span>
  <span m=''3782860''>got</span> <span m=''3783690''>a</span> <span m=''3783760''>mathematical</span>
  <span m=''3784440''>proof</span> <span m=''3784820''>that</span> <span m=''3784940''>it''s</span>
  <span m=''3785080''>an</span> <span m=''3785140''>effective</span> <span m=''3785580''>scheduler.</span>
  <span m=''3786480''>And</span> <span m=''3786920''>in</span> <span m=''3787080''>fact,</span>
  <span m=''3788030''>was</span> <span m=''3788430''>the</span> <span m=''3788530''>inspiration</span>
  <span m=''3789220''>for</span> <span m=''3789350''>things</span> <span m=''3789670''>like</span>
  <span m=''3790200''>the</span> <span m=''3790360''>work-stealing</span> <span m=''3790810''>in</span>
  <span m=''3791080''>TBB</span> <span m=''3791800''>and</span> <span m=''3792100''>the</span>
  <span m=''3792180''>new</span> <span m=''3792380''>task</span> <span m=''3793200''>mechanisms</span>
  <span m=''3793790''>and</span> <span m=''3793880''>so</span> <span m=''3794090''>forth</span>
  <span m=''3794500''>in</span> <span m=''3796520''>OpenMP,</span> <span m=''3798000''>as</span>
  <span m=''3798370''>well</span> <span m=''3798580''>as</span> <span m=''3798680''>a</span>
  <span m=''3798720''>bunch</span> <span m=''3798960''>of</span> <span m=''3799070''>other</span>
  <span m=''3799260''>people</span> <span m=''3799530''>who''ve</span> <span m=''3799640''>done</span>
  <span m=''3799880''>work-stealing.</span> </p><p><span m=''3801360''>It in</span>
  <span m=''3801520''>addition</span> <span m=''3801930''>provides</span> <span m=''3802500''>a</span>
  <span m=''3803085''>hyperobject</span> <span m=''3803710''>library</span> <span
  m=''3804360''>for</span> <span m=''3804520''>parallelizing</span> <span m=''3805190''>code</span>
  <span m=''3805500''>with</span> <span m=''3805660''>global</span> <span m=''3806020''>variables,</span>
  <span m=''3806620''>which</span> <span m=''3806780''>we''ll</span> <span m=''3806890''>talk</span>
  <span m=''3807140''>about</span> <span m=''3807410''>later.</span> <span m=''3808120''>And
  it</span> <span m=''3808260''>includes</span> <span m=''3808870''>two</span> <span
  m=''3809550''>tools</span> <span m=''3810100''>that</span> <span m=''3810220''>you''ll</span>
  <span m=''3811550''>come</span> <span m=''3811750''>to</span> <span m=''3811870''>know</span>
  <span m=''3812070''>and</span> <span m=''3812130''>love.</span> <span m=''3812720''>One</span>
  <span m=''3813060''>is</span> <span m=''3813230''>the</span> <span m=''3813310''>Cilkscreen</span>
  <span m=''3813960''>race</span> <span m=''3814250''>detector,</span> <span m=''3814900''>and</span>
  <span m=''3815050''>the</span> <span m=''3815160''>other</span> <span m=''3815380''>is</span>
  <span m=''3815490''>the</span> <span m=''3815570''>Cilkview</span> <span m=''3816490''>scalability</span>
  <span m=''3817320''>analyzer.</span> </p><p><span m=''3819460''>Now,</span> <span
  m=''3819720''>what</span> <span m=''3820000''>we''re</span> <span m=''3820150''>going</span>
  <span m=''3820230''>to</span> <span m=''3820270''>be</span> <span m=''3820380''>using</span>
  <span m=''3820690''>in</span> <span m=''3820760''>this</span> <span m=''3820980''>class</span>
  <span m=''3821510''>is</span> <span m=''3821760''>going</span> <span m=''3821890''>to</span>
  <span m=''3821960''>be</span> <span m=''3824000''>the</span> <span m=''3824300''>Cilk++</span>
  <span m=''3827940''>technology</span> <span m=''3828530''>that</span> <span m=''3828630''>was</span>
  <span m=''3828800''>developed</span> <span m=''3829240''>at</span> <span m=''3829350''>Cilk</span>
  <span m=''3829580''>Arts</span> <span m=''3829980''>and then</span> <span m=''3830460''>massaged</span>
  <span m=''3830970''>a</span> <span m=''3831020''>little</span> <span m=''3831220''>bit</span>
  <span m=''3831400''>when</span> <span m=''3831520''>it</span> <span m=''3831560''>got</span>
  <span m=''3831820''>to</span> <span m=''3831920''>Intel.</span> <span m=''3832630''>There</span>
  <span m=''3832810''>is</span> <span m=''3832910''>a</span> <span m=''3833000''>brand</span>
  <span m=''3833460''>new</span> <span m=''3833640''>Intel</span> <span m=''3834130''>technology</span>
  <span m=''3835060''>with</span> <span m=''3835320''>Cilk</span> <span m=''3835640''>built</span>
  <span m=''3835990''>into</span> <span m=''3836220''>their</span> <span m=''3836430''>compiler.</span>
  <span m=''3838030''>And</span> <span m=''3838300''>it</span> <span m=''3838450''>is</span>
  <span m=''3838640''>due</span> <span m=''3838780''>to</span> <span m=''3838870''>come</span>
  <span m=''3839090''>out</span> <span m=''3840310''>in</span> <span m=''3840550''>like,</span>
  <span m=''3841550''>two</span> <span m=''3841740''>weeks.</span> </p><p><span m=''3845480''>So</span>
  <span m=''3845710''>our</span> <span m=''3845880''>timing</span> <span m=''3846390''>for</span>
  <span m=''3846510''>this</span> <span m=''3846730''>was</span> <span m=''3846970''>it</span>
  <span m=''3847070''>would''ve</span> <span m=''3847250''>been</span> <span m=''3847430''>nice</span>
  <span m=''3847810''>to</span> <span m=''3848480''>have</span> <span m=''3848720''>you</span>
  <span m=''3848830''>folks</span> <span m=''3849280''>on</span> <span m=''3849710''>the</span>
  <span m=''3850370''>new</span> <span m=''3851200''>Intel</span> <span m=''3851660''>Cilk+</span>
  <span m=''3852430''>technology.</span> <span m=''3853510''>But</span> <span m=''3853850''>we''re</span>
  <span m=''3854020''>going</span> <span m=''3854120''>to</span> <span m=''3854810''>go</span>
  <span m=''3854990''>with</span> <span m=''3855160''>this</span> <span m=''3855340''>one</span>
  <span m=''3855600''>for</span> <span m=''3855770''>now.</span> <span m=''3856950''>It''s</span>
  <span m=''3857180''>not</span> <span m=''3857330''>going</span> <span m=''3857410''>to</span>
  <span m=''3857450''>make</span> <span m=''3857670''>too</span> <span m=''3857800''>big</span>
  <span m=''3858000''>a</span> <span m=''3858060''>difference</span> <span m=''3859170''>to</span>
  <span m=''3859250''>you</span> <span m=''3859420''>folks.</span> <span m=''3859690''>But
  you</span> <span m=''3859830''>should</span> <span m=''3859970''>just</span> <span
  m=''3860150''>be</span> <span m=''3860250''>aware</span> <span m=''3860830''>that</span>
  <span m=''3861220''>coming</span> <span m=''3861510''>down</span> <span m=''3861730''>the</span>
  <span m=''3861810''>pike,</span> <span m=''3862190''>there''s</span> <span m=''3862360''>actually</span>
  <span m=''3862760''>some</span> <span m=''3865250''>much</span> <span m=''3865700''>more</span>
  <span m=''3865910''>cleanly</span> <span m=''3866310''>integrated</span> <span m=''3867430''>technology</span>
  <span m=''3869140''>that</span> <span m=''3869330''>you</span> <span m=''3869490''>can</span>
  <span m=''3869630''>use</span> <span m=''3870310''>that''s</span> <span m=''3870540''>in</span>
  <span m=''3870690''>the</span> <span m=''3871010''>Intel</span> <span m=''3871370''>compiler.</span>
  </p><p><span m=''3873120''>So</span> <span m=''3873270''>here''s</span> <span m=''3873600''>how</span>
  <span m=''3873810''>we</span> <span m=''3873920''>do</span> <span m=''3874120''>nested</span>
  <span m=''3874520''>parallelism</span> <span m=''3875120''>in</span> <span m=''3875220''>Cilk++.</span>
  <span m=''3876670''>So</span> <span m=''3876840''>basically,</span> <span m=''3877320''>this</span>
  <span m=''3877490''>is</span> <span m=''3877640''>Fibonacci.</span> <span m=''3878420''>And</span>
  <span m=''3878660''>now,</span> <span m=''3878930''>what</span> <span m=''3879090''>I</span>
  <span m=''3879210''>have</span> <span m=''3879660''>here</span> <span m=''3880020''>is,</span>
  <span m=''3881050''>if</span> <span m=''3881240''>you</span> <span m=''3881350''>notice,</span>
  <span m=''3881780''>I''ve</span> <span m=''3881910''>got</span> <span m=''3882170''>two</span>
  <span m=''3882580''>keywords,</span> <span m=''3883420''>cilk_spawn</span> <span
  m=''3883780''>and</span> <span m=''3884250''>cilk_sync.</span> <span m=''3886430''>And</span>
  <span m=''3886700''>this</span> <span m=''3886900''>is</span> <span m=''3887090''>how</span>
  <span m=''3887280''>you</span> <span m=''3887460''>write</span> <span m=''3888210''>parallel</span>
  <span m=''3888485''>Fibonacci</span> <span m=''3889440''>in</span> <span m=''3889650''>Cilk.</span>
  <span m=''3890160''>This</span> <span m=''3890320''>is</span> <span m=''3890460''>it.</span>
  </p><p><span m=''3891825''>I''ve</span> <span m=''3892860''>inserted</span> <span
  m=''3893340''>two</span> <span m=''3893500''>key</span> <span m=''3893690''>words,</span>
  <span m=''3893990''>and</span> <span m=''3894110''>my</span> <span m=''3894230''>program</span>
  <span m=''3894620''>is</span> <span m=''3894740''>parallel.</span> <span m=''3896200''>The</span>
  <span m=''3896650''>cilk_spawn</span> <span m=''3896940''>keyword</span> <span m=''3897530''>says</span>
  <span m=''3897920''>that</span> <span m=''3898070''>the</span> <span m=''3898150''>named</span>
  <span m=''3898640''>child</span> <span m=''3899460''>function</span> <span m=''3900350''>can</span>
  <span m=''3900510''>execute</span> <span m=''3901120''>in</span> <span m=''3901320''>parallel</span>
  <span m=''3901900''>with</span> <span m=''3902030''>the</span> <span m=''3902100''>parent</span>
  <span m=''3902490''>caller.</span> <span m=''3903260''>So</span> <span m=''3903430''>when</span>
  <span m=''3903600''>you</span> <span m=''3903700''>say</span> <span m=''3903900''>x</span>
  <span m=''3904180''>equals</span> <span m=''3904480''>cilk_spawn</span> <span m=''3905130''>or</span>
  <span m=''3905200''>Fib</span> <span m=''3905490''>of</span> <span m=''3905580''>n</span>
  <span m=''3905710''>minus</span> <span m=''3906070''>1,</span> <span m=''3906510''>it</span>
  <span m=''3906990''>does</span> <span m=''3907270''>the</span> <span m=''3907360''>same</span>
  <span m=''3907640''>thing</span> <span m=''3907840''>that you</span> <span m=''3908040''>normally</span>
  <span m=''3908440''>think.</span> <span m=''3908660''>It</span> <span m=''3908800''>calls</span>
  <span m=''3909330''>the</span> <span m=''3909440''>child.</span> <span m=''3912810''>But</span>
  <span m=''3913020''>after</span> <span m=''3913330''>it calls</span> <span m=''3913750''>the</span>
  <span m=''3913860''>child,</span> <span m=''3914240''>rather</span> <span m=''3914650''>than</span>
  <span m=''3915470''>waiting</span> <span m=''3915980''>for</span> <span m=''3916210''>it
  to</span> <span m=''3916340''>return,</span> <span m=''3918150''>it</span> <span
  m=''3918370''>goes</span> <span m=''3918640''>on</span> <span m=''3918830''>to</span>
  <span m=''3918930''>the</span> <span m=''3919100''>next</span> <span m=''3919270''>statement.</span>
  </p><p><span m=''3921360''>So</span> <span m=''3921550''>then,</span> <span m=''3922300''>the</span>
  <span m=''3922550''>statement</span> <span m=''3923020''>y</span> <span m=''3923280''>equals</span>
  <span m=''3923690''>Fib of n</span> <span m=''3923970''>minus</span> <span m=''3924290''>2</span>
  <span m=''3924510''>is</span> <span m=''3924650''>going</span> <span m=''3924920''>on</span>
  <span m=''3925050''>at</span> <span m=''3925130''>the</span> <span m=''3925200''>same</span>
  <span m=''3925560''>time</span> <span m=''3925930''>as</span> <span m=''3926050''>the</span>
  <span m=''3926130''>calculation</span> <span m=''3926860''>of</span> <span m=''3926960''>Fib</span>
  <span m=''3927230''>of n</span> <span m=''3927420''>minus</span> <span m=''3927730''>1.</span>
  <span m=''3930730''>And</span> <span m=''3930900''>then,</span> <span m=''3931060''>the</span>
  <span m=''3931150''>cilk_sync</span> <span m=''3931880''>says,</span> <span m=''3932820''>don''t</span>
  <span m=''3933030''>go</span> <span m=''3933210''>past</span> <span m=''3933600''>this</span>
  <span m=''3933810''>point</span> <span m=''3934100''>until</span> <span m=''3934560''>all</span>
  <span m=''3934740''>the</span> <span m=''3934870''>children</span> <span m=''3935200''>you''ve</span>
  <span m=''3935320''>spawned</span> <span m=''3935760''>off</span> <span m=''3935970''>have</span>
  <span m=''3936110''>returned.</span> </p><p><span m=''3939530''>And</span> <span
  m=''3939700''>since</span> <span m=''3939910''>this</span> <span m=''3940100''>is</span>
  <span m=''3940240''>a</span> <span m=''3940290''>recursive</span> <span m=''3940810''>program,</span>
  <span m=''3942472''>it</span> <span m=''3942920''>generates</span> <span m=''3944170''>gobs</span>
  <span m=''3944510''>of</span> <span m=''3944580''>parallelism,</span> <span m=''3944885''>if</span>
  <span m=''3945190''>it''s</span> <span m=''3945570''>a</span> <span m=''3945620''>big</span>
  <span m=''3946040''>thing.</span> <span m=''3947130''>So</span> <span m=''3947290''>one</span>
  <span m=''3947480''>of</span> <span m=''3947550''>the</span> <span m=''3947620''>key</span>
  <span m=''3947890''>things</span> <span m=''3948190''>about</span> <span m=''3948480''>Cilk++,</span>
  <span m=''3949360''>is</span> <span m=''3949620''>unlike</span> <span m=''3950110''>Pthreads--</span>
  <span m=''3950720''>Pthreads,</span> <span m=''3951300''>when</span> <span m=''3951450''>you</span>
  <span m=''3951540''>say,</span> <span m=''3951790''>pthread_create,</span> <span
  m=''3954040''>it</span> <span m=''3954190''>actually</span> <span m=''3954490''>goes</span>
  <span m=''3954820''>and</span> <span m=''3954920''>creates</span> <span m=''3955450''>a</span>
  <span m=''3955510''>piece</span> <span m=''3955780''>of</span> <span m=''3955870''>work.</span>
  </p><p><span m=''3957080''>In</span> <span m=''3957970''>Cilk++,</span> <span m=''3959050''>these</span>
  <span m=''3959310''>keywords</span> <span m=''3959940''>only</span> <span m=''3960470''>grant</span>
  <span m=''3960920''>permission.</span> <span m=''3962630''>They</span> <span m=''3962790''>say</span>
  <span m=''3962970''>you</span> <span m=''3963140''>may</span> <span m=''3963720''>execute</span>
  <span m=''3964370''>these</span> <span m=''3964580''>things</span> <span m=''3964820''>in</span>
  <span m=''3964940''>parallel.</span> <span m=''3966050''>It</span> <span m=''3966170''>doesn''t</span>
  <span m=''3966440''>insist</span> <span m=''3966910''>that</span> <span m=''3967050''>they</span>
  <span m=''3967200''>be</span> <span m=''3967340''>executed</span> <span m=''3967830''>in</span>
  <span m=''3967910''>parallel.</span> <span m=''3968630''>The</span> <span m=''3968770''>program</span>
  <span m=''3969200''>may</span> <span m=''3969360''>decide,</span> <span m=''3969770''>no,</span>
  <span m=''3970050''>in</span> <span m=''3970160''>fact,</span> <span m=''3970480''>I''m</span>
  <span m=''3970760''>going</span> <span m=''3971080''>to</span> <span m=''3971270''>just</span>
  <span m=''3971520''>call</span> <span m=''3971880''>this,</span> <span m=''3972830''>and</span>
  <span m=''3973050''>then</span> <span m=''3973220''>return,</span> <span m=''3973880''>and</span>
  <span m=''3974100''>then</span> <span m=''3974360''>execute</span> <span m=''3974830''>this.</span>
  </p><p><span m=''3978320''>So</span> <span m=''3979210''>it</span> <span m=''3979430''>only</span>
  <span m=''3979800''>grants</span> <span m=''3980280''>permission,</span> <span m=''3981170''>and</span>
  <span m=''3983150''>the</span> <span m=''3983640''>Cilk++</span> <span m=''3984320''>runtime</span>
  <span m=''3984850''>system</span> <span m=''3985550''>figures</span> <span m=''3985880''>out</span>
  <span m=''3986040''>how</span> <span m=''3986170''>to</span> <span m=''3986290''>load</span>
  <span m=''3986580''>balance</span> <span m=''3987020''>it</span> <span m=''3987330''>and</span>
  <span m=''3988160''>schedule</span> <span m=''3988425''>it.</span> <span m=''3991260''>Cilk++</span>
  <span m=''3992000''>also</span> <span m=''3993710''>supports</span> <span m=''3994230''>loop</span>
  <span m=''3994510''>parallelism.</span> <span m=''3996590''>So</span> <span m=''3996740''>here''s</span>
  <span m=''3997000''>an</span> <span m=''3997040''>example</span> <span m=''3997520''>of</span>
  <span m=''3997600''>an</span> <span m=''3997770''>in-place</span> <span m=''3998280''>matrix</span>
  <span m=''3998710''>transpose.</span> <span m=''3999360''>So</span> <span m=''3999440''>I</span>
  <span m=''3999470''>want</span> <span m=''3999630''>to</span> <span m=''3999710''>take</span>
  <span m=''3999950''>this</span> <span m=''4000120''>matrix</span> <span m=''4000970''>and</span>
  <span m=''4001200''>flip</span> <span m=''4001470''>it</span> <span m=''4001590''>on</span>
  <span m=''4001770''>its</span> <span m=''4002120''>major</span> <span m=''4002520''>axis.</span>
  </p><p><span m=''4005330''>And</span> <span m=''4006090''>we</span> <span m=''4006270''>can</span>
  <span m=''4006400''>do</span> <span m=''4006600''>it</span> <span m=''4006700''>with
  for</span> <span m=''4006990''>loops.</span> <span m=''4007480''>As you know,</span>
  <span m=''4007780''>for</span> <span m=''4008050''>loops</span> <span m=''4008270''>are</span>
  <span m=''4008320''>not</span> <span m=''4008530''>the</span> <span m=''4008610''>best</span>
  <span m=''4008930''>way</span> <span m=''4009040''>to</span> <span m=''4009140''>do</span>
  <span m=''4009270''>matrix</span> <span m=''4009660''>transpose.</span> <span m=''4010270''>Right?</span>
  <span m=''4013070''>It''s</span> <span m=''4013230''>better</span> <span m=''4013490''>to</span>
  <span m=''4013600''>do</span> <span m=''4013760''>divide</span> <span m=''4014110''>and</span>
  <span m=''4014210''>conquer.</span> <span m=''4016090''>But</span> <span m=''4016840''>here''s</span>
  <span m=''4017100''>how</span> <span m=''4017230''>you</span> <span m=''4017430''>could</span>
  <span m=''4017680''>do</span> <span m=''4017820''>it.</span> <span m=''4020640''>And</span>
  <span m=''4020980''>here,</span> <span m=''4021190''>I</span> <span m=''4021240''>made</span>
  <span m=''4021460''>the</span> <span m=''4021550''>indices</span> <span m=''4021970''>run</span>
  <span m=''4022200''>from</span> <span m=''4022370''>0,</span> <span m=''4022730''>not</span>
  <span m=''4023030''>1,</span> <span m=''4023340''>because</span> <span m=''4024240''>that''s</span>
  <span m=''4024470''>the</span> <span m=''4024560''>way</span> <span m=''4024710''>you</span>
  <span m=''4024790''>do</span> <span m=''4024950''>it in</span> <span m=''4025090''>programming.</span>
  </p><p><span m=''4025610''>But</span> <span m=''4025730''>if</span> <span m=''4025840''>I</span>
  <span m=''4025920''>did</span> <span m=''4026170''>it up</span> <span m=''4026340''>here,</span>
  <span m=''4026560''>then</span> <span m=''4026820''>these</span> <span m=''4027150''>things</span>
  <span m=''4027390''>get</span> <span m=''4027550''>to</span> <span m=''4027620''>be</span>
  <span m=''4027760''>n</span> <span m=''4027890''>minus</span> <span m=''4028150''>1,</span>
  <span m=''4028320''>n</span> <span m=''4028430''>minus</span> <span m=''4028670''>1,</span>
  <span m=''4029160''>and</span> <span m=''4029280''>then it</span> <span m=''4029560''>gets
  too</span> <span m=''4029710''>crowded</span> <span m=''4030130''>on</span> <span
  m=''4030220''>the</span> <span m=''4030300''>slide.</span> <span m=''4030810''>And</span>
  <span m=''4030950''>I</span> <span m=''4031040''>said,</span> <span m=''4031500''>OK,</span>
  <span m=''4032290''>I''ll</span> <span m=''4032420''>just</span> <span m=''4032550''>put</span>
  <span m=''4032660''>a</span> <span m=''4032710''>comment</span> <span m=''4033110''>there</span>
  <span m=''4034590''>rather</span> <span m=''4034900''>than</span> <span m=''4035030''>try</span>
  <span m=''4035270''>to</span> <span m=''4035830''>sort it</span> <span m=''4036050''>out.</span>
  <span m=''4037450''>So</span> <span m=''4037700''>here''s</span> <span m=''4037980''>what</span>
  <span m=''4038200''>I''m</span> <span m=''4038310''>saying,</span> <span m=''4038640''>is</span>
  <span m=''4038880''>this</span> <span m=''4039080''>outer</span> <span m=''4039380''>loop</span>
  <span m=''4039600''>is</span> <span m=''4039770''>parallel.</span> <span m=''4041150''>It''s</span>
  <span m=''4041240''>going</span> <span m=''4041530''>from</span> <span m=''4041730''>1</span>
  <span m=''4042120''>to</span> <span m=''4042540''>n</span> <span m=''4042720''>minus</span>
  <span m=''4043050''>1.</span> <span m=''4044340''>And</span> <span m=''4044540''>saying,</span>
  <span m=''4044830''>do</span> <span m=''4045060''>all</span> <span m=''4045300''>those</span>
  <span m=''4045590''>things</span> <span m=''4045870''>in</span> <span m=''4046000''>parallel.</span>
  <span m=''4046620''>And</span> <span m=''4046790''>each</span> <span m=''4047010''>one</span>
  <span m=''4047240''>is</span> <span m=''4047390''>going</span> <span m=''4047700''>through</span>
  <span m=''4048190''>a</span> <span m=''4048280''>different</span> <span m=''4048750''>number</span>
  <span m=''4049130''>of</span> <span m=''4049290''>iterations</span> <span m=''4049600''>of</span>
  <span m=''4049910''>j.</span> </p><p><span m=''4050390''>So</span> <span m=''4050520''>you
  can</span> <span m=''4050630''>see</span> <span m=''4050820''>you</span> <span m=''4050930''>actually</span>
  <span m=''4051270''>need</span> <span m=''4051640''>some</span> <span m=''4051810''>load</span>
  <span m=''4052050''>balancing</span> <span m=''4052520''>here,</span> <span m=''4053240''>because</span>
  <span m=''4053460''>some</span> <span m=''4053700''>of</span> <span m=''4053770''>these</span>
  <span m=''4054070''>are</span> <span m=''4054150''>going</span> <span m=''4054420''>through</span>
  <span m=''4055120''>just</span> <span m=''4055350''>one</span> <span m=''4055600''>step,</span>
  <span m=''4056760''>and</span> <span m=''4056900''>some</span> <span m=''4057120''>are</span>
  <span m=''4057210''>going</span> <span m=''4057550''>through</span> <span m=''4057910''>n</span>
  <span m=''4058120''>minus</span> <span m=''4058450''>1</span> <span m=''4058720''>steps.</span>
  <span m=''4059520''>It''s</span> <span m=''4059670''>basically</span> <span m=''4060470''>the</span>
  <span m=''4060820''>amount</span> <span m=''4061130''>of</span> <span m=''4061260''>work</span>
  <span m=''4062040''>in</span> <span m=''4062230''>every</span> <span m=''4062610''>iteration</span>
  <span m=''4063220''>of</span> <span m=''4063300''>the</span> <span m=''4063440''>outer</span>
  <span m=''4063720''>loop</span> <span m=''4063980''>here</span> <span m=''4064520''>is</span>
  <span m=''4064720''>different.</span> <span m=''4067310''>I''m</span> <span m=''4067430''>sorry?</span>
  </p><p><span m=''4067810''>AUDIENCE: [INAUDIBLE PHRASE].</span> </p><p><span m=''4070130''>PROFESSOR:
  No.</span> <span m=''4070410''>i</span> <span m=''4070680''>equals</span> <span
  m=''4070970''>1</span> <span m=''4071170''>is where</span> <span m=''4071310''>you
  want to</span> <span m=''4071350''>start.</span> <span m=''4073610''>Because</span>
  <span m=''4073790''>you</span> <span m=''4073870''>don''t</span> <span m=''4074030''>have</span>
  <span m=''4074200''>to</span> <span m=''4074310''>move</span> <span m=''4074580''>the</span>
  <span m=''4074670''>diagonal.</span> <span m=''4078170''>You</span> <span m=''4078390''>only</span>
  <span m=''4078580''>have</span> <span m=''4078740''>to</span> <span m=''4078830''>go</span>
  <span m=''4079020''>across</span> <span m=''4079530''>the</span> <span m=''4080120''>top</span>
  <span m=''4080450''>here.</span> <span m=''4081750''>And</span> <span m=''4082020''>for</span>
  <span m=''4082170''>each</span> <span m=''4082430''>of</span> <span m=''4082520''>those,</span>
  <span m=''4083590''>copy</span> <span m=''4083990''>it</span> <span m=''4084240''>into</span>
  <span m=''4085800''>the</span> <span m=''4085980''>appropriate</span> <span m=''4086340''>column.</span>
  <span m=''4087170''>Flip</span> <span m=''4087300''>it</span> <span m=''4087440''>into
  the</span> <span m=''4087680''>appropriate</span> <span m=''4088040''>column.</span>
  <span m=''4088790''>Flip</span> <span m=''4089010''>the</span> <span m=''4089110''>two</span>
  <span m=''4089280''>things.</span> </p><p><span m=''4091030''>Actually,</span> <span
  m=''4091290''>transpose</span> <span m=''4091820''>is</span> <span m=''4091920''>one</span>
  <span m=''4092060''>of</span> <span m=''4092100''>these</span> <span m=''4092330''>functions.</span>
  <span m=''4092720''>I</span> <span m=''4092800''>remember</span> <span m=''4093110''>writing</span>
  <span m=''4093380''>my</span> <span m=''4093500''>first</span> <span m=''4093840''>transpose</span>
  <span m=''4094410''>functions.</span> <span m=''4095220''>And when I was</span>
  <span m=''4095640''>done,</span> <span m=''4095880''>I</span> <span m=''4095960''>somehow</span>
  <span m=''4096340''>had</span> <span m=''4096540''>the</span> <span m=''4096649''>identity.</span>
  <span m=''4099569''>Because</span> <span m=''4099830''>I</span> <span m=''4099899''>basically</span>
  <span m=''4100450''>made</span> <span m=''4100700''>the</span> <span m=''4100790''>loops</span>
  <span m=''4101120''>go</span> <span m=''4101330''>from</span> <span m=''4102340''>1</span>
  <span m=''4102569''>to</span> <span m=''4102740''>n</span> <span m=''4102850''>and</span>
  <span m=''4103180''>1</span> <span m=''4103399''>to</span> <span m=''4104520''>n</span>
  <span m=''4104890''>and</span> <span m=''4105330''>swapped</span> <span m=''4105810''>them.</span>
  <span m=''4107260''>So</span> <span m=''4107540''>I swapped</span> <span m=''4107720''>them.</span>
  <span m=''4107819''>So I said,</span> <span m=''4108090''>oh,</span> <span m=''4108770''>that</span>
  <span m=''4109050''>was</span> <span m=''4109200''>a</span> <span m=''4109250''>lot</span>
  <span m=''4109450''>of</span> <span m=''4109510''>work</span> <span m=''4109720''>to</span>
  <span m=''4109819''>compute</span> <span m=''4110120''>the</span> <span m=''4110250''>identity.</span>
  </p><p><span m=''4112979''>No,</span> <span m=''4113170''>you''ve</span> <span m=''4113330''>got</span>
  <span m=''4113450''>to</span> <span m=''4113510''>make</span> <span m=''4113680''>sure</span>
  <span m=''4113819''>you</span> <span m=''4113910''>only</span> <span m=''4114189''>go</span>
  <span m=''4114380''>through</span> <span m=''4114569''>a</span> <span m=''4114630''>triangular</span>
  <span m=''4115859''>iteration</span> <span m=''4116380''>space</span> <span m=''4118120''>in</span>
  <span m=''4118240''>order</span> <span m=''4118420''>to</span> <span m=''4118460''>make</span>
  <span m=''4118640''>sure</span> <span m=''4118790''>you</span> <span m=''4118899''>swap--</span>
  <span m=''4119210''>and</span> <span m=''4119540''>then</span> <span m=''4119840''>swap.</span>
  <span m=''4123670''>This</span> <span m=''4124160''>is</span> <span m=''4124220''>an</span>
  <span m=''4124319''>in-place</span> <span m=''4124479''>swap.</span> <span m=''4125450''>So</span>
  <span m=''4125590''>that''s</span> <span m=''4125840''>cilk_for.</span> <span m=''4126970''>That''s</span>
  <span m=''4127420''>basically</span> <span m=''4128069''>it.</span> <span m=''4128490''>There</span>
  <span m=''4128710''>are</span> <span m=''4128840''>some</span> <span m=''4129010''>more</span>
  <span m=''4129200''>facilities</span> <span m=''4129779''>we''ll</span> <span m=''4129910''>talk</span>
  <span m=''4130189''>about.</span> <span m=''4130470''>But</span> <span m=''4130590''>that''s</span>
  <span m=''4130880''>basically</span> <span m=''4131410''>it</span> <span m=''4131660''>for</span>
  <span m=''4131779''>parallel</span> <span m=''4132630''>programming</span> <span
  m=''4133229''>in</span> <span m=''4133540''>Cilk++.</span> <span m=''4134210''>The</span>
  <span m=''4134359''>other</span> <span m=''4134609''>part</span> <span m=''4135149''>is,</span>
  <span m=''4135270''>how</span> <span m=''4135399''>do</span> <span m=''4135470''>you</span>
  <span m=''4135560''>do</span> <span m=''4135720''>it</span> <span m=''4135859''>so</span>
  <span m=''4135950''>you</span> <span m=''4136100''>get</span> <span m=''4136290''>fast</span>
  <span m=''4136710''>code?</span> <span m=''4138000''>Which</span> <span m=''4138180''>we''ll</span>
  <span m=''4138290''>talk</span> <span m=''4138510''>about.</span> </p><p><span m=''4139920''>Now,</span>
  <span m=''4141720''>Cilk</span> <span m=''4142479''>has</span> <span m=''4143380''>serial</span>
  <span m=''4143810''>semantics.</span> <span m=''4144670''>And</span> <span m=''4144880''>what</span>
  <span m=''4145069''>that</span> <span m=''4145370''>means</span> <span m=''4145760''>is</span>
  <span m=''4147000''>unlike</span> <span m=''4147460''>some</span> <span m=''4147630''>of</span>
  <span m=''4147689''>the</span> <span m=''4148160''>other</span> <span m=''4148380''>ones,</span>
  <span m=''4148720''>it''s</span> <span m=''4149060''>kind</span> <span m=''4149279''>of</span>
  <span m=''4149609''>what</span> <span m=''4150200''>OpenMP</span> <span m=''4151020''>was</span>
  <span m=''4151279''>aspiring</span> <span m=''4151890''>to</span> <span m=''4152000''>do.</span>
  <span m=''4153220''>The</span> <span m=''4153550''>idea</span> <span m=''4153859''>is</span>
  <span m=''4154180''>that</span> <span m=''4154279''>if</span> <span m=''4154550''>I,</span>
  <span m=''4155270''>for</span> <span m=''4155380''>example</span> <span m=''4155720''>here,</span>
  <span m=''4156020''>delete</span> <span m=''4156800''>these</span> <span m=''4157040''>two</span>
  <span m=''4157240''>keywords,</span> <span m=''4158950''>I</span> <span m=''4159069''>get</span>
  <span m=''4159390''>a</span> <span m=''4159790''>C++</span> <span m=''4160720''>code.</span>
  <span m=''4162510''>And</span> <span m=''4162649''>that</span> <span m=''4162890''>code</span>
  <span m=''4163149''>is</span> <span m=''4163270''>always</span> <span m=''4163649''>a</span>
  <span m=''4163720''>legal</span> <span m=''4164180''>way</span> <span m=''4164660''>to</span>
  <span m=''4164800''>execute</span> <span m=''4165420''>this</span> <span m=''4165600''>parallel</span>
  <span m=''4166020''>code.</span> </p><p><span m=''4167560''>So</span> <span m=''4167670''>the</span>
  <span m=''4167729''>parallel</span> <span m=''4168090''>code</span> <span m=''4168310''>may</span>
  <span m=''4168460''>have</span> <span m=''4168600''>more</span> <span m=''4168850''>behaviors</span>
  <span m=''4169560''>of</span> <span m=''4169660''>its</span> <span m=''4169840''>nondeterministic</span>
  <span m=''4170649''>code.</span> <span m=''4171630''>But</span> <span m=''4172210''>always,</span>
  <span m=''4172770''>it''s</span> <span m=''4172939''>legal</span> <span m=''4173290''>to</span>
  <span m=''4174689''>treat</span> <span m=''4174930''>it</span> <span m=''4175060''>as</span>
  <span m=''4175220''>if</span> <span m=''4175310''>it''s</span> <span m=''4175450''>just</span>
  <span m=''4175609''>straight</span> <span m=''4175950''>C++.</span> <span m=''4178939''>And</span>
  <span m=''4179410''>the</span> <span m=''4179490''>reason</span> <span m=''4179819''>for</span>
  <span m=''4179920''>that</span> <span m=''4180180''>is</span> <span m=''4180390''>that,</span>
  <span m=''4180590''>really,</span> <span m=''4180920''>we''re</span> <span m=''4181069''>only</span>
  <span m=''4181270''>granting</span> <span m=''4181710''>permission</span> <span
  m=''4182220''>for</span> <span m=''4182390''>parallel</span> <span m=''4182850''>execution.</span>
  <span m=''4184439''>So</span> <span m=''4184560''>even</span> <span m=''4184779''>though</span>
  <span m=''4184880''>I</span> <span m=''4184960''>put</span> <span m=''4185170''>in</span>
  <span m=''4185260''>these</span> <span m=''4185500''>keywords,</span> <span m=''4185970''>I</span>
  <span m=''4186080''>still</span> <span m=''4186490''>can</span> <span m=''4186630''>execute</span>
  <span m=''4187149''>it</span> <span m=''4187450''>serially</span> <span m=''4187770''>if</span>
  <span m=''4187920''>I</span> <span m=''4188020''>wish.</span> <span m=''4190779''>They</span>
  <span m=''4190890''>don''t</span> <span m=''4191090''>command</span> <span m=''4191430''>parallel</span>
  <span m=''4191680''>execution.</span> </p><p><span m=''4192420''>To</span> <span
  m=''4192609''>obtain</span> <span m=''4192890''>this</span> <span m=''4193220''>serialization,</span>
  <span m=''4194020''>you</span> <span m=''4194120''>can</span> <span m=''4194270''>do</span>
  <span m=''4194390''>it</span> <span m=''4194480''>by</span> <span m=''4194680''>hand</span>
  <span m=''4195080''>by</span> <span m=''4195210''>just</span> <span m=''4195430''>defining</span>
  <span m=''4195900''>a</span> <span m=''4195950''>cilk_for</span> <span m=''4196160''>to</span>
  <span m=''4196536''>be</span> <span m=''4196912''>for,</span> <span m=''4197510''>and</span>
  <span m=''4197770''>the</span> <span m=''4197840''>cilk_spawn</span> <span m=''4198570''>and
  cilk_sync</span> <span m=''4199130''>to</span> <span m=''4199220''>be</span> <span
  m=''4199390''>empty.</span> <span m=''4201420''>Or</span> <span m=''4202190''>there''s</span>
  <span m=''4202360''>a</span> <span m=''4202410''>switch</span> <span m=''4202820''>to</span>
  <span m=''4202890''>the</span> <span m=''4202970''>Cilk++</span> <span m=''4204230''>composite</span>
  <span m=''4204505''>that</span> <span m=''4204780''>does</span> <span m=''4204950''>that</span>
  <span m=''4205170''>for</span> <span m=''4205320''>you</span> <span m=''4205420''>automatically.</span>
  <span m=''4206340''>And it''s</span> <span m=''4206590''>probably</span> <span m=''4206840''>the</span>
  <span m=''4206940''>preferred</span> <span m=''4207400''>way</span> <span m=''4207550''>of</span>
  <span m=''4207660''>doing</span> <span m=''4207950''>it.</span> </p><p><span m=''4210750''>But</span>
  <span m=''4210980''>the</span> <span m=''4211130''>idea</span> <span m=''4211380''>is</span>
  <span m=''4211490''>conceptually,</span> <span m=''4214330''>you</span> <span m=''4214510''>can</span>
  <span m=''4214620''>sprinkle</span> <span m=''4215150''>in</span> <span m=''4215240''>these</span>
  <span m=''4215440''>keywords,</span> <span m=''4215610''>and</span> <span m=''4215830''>if</span>
  <span m=''4215940''>you</span> <span m=''4216010''>don''t</span> <span m=''4216180''>want</span>
  <span m=''4216380''>it</span> <span m=''4216490''>anymore,</span> <span m=''4217070''>fine.</span>
  <span m=''4218140''>If</span> <span m=''4218300''>you</span> <span m=''4218390''>want</span>
  <span m=''4218510''>to</span> <span m=''4218550''>compile</span> <span m=''4218920''>it</span>
  <span m=''4219010''>with</span> <span m=''4219160''>the</span> <span m=''4220240''>straight</span>
  <span m=''4220630''>c</span> <span m=''4220940''>compilers,</span> <span m=''4221205''>it''s</span>
  <span m=''4221470''>better</span> <span m=''4221700''>to</span> <span m=''4221760''>use</span>
  <span m=''4222060''>the</span> <span m=''4222140''>Cilk++</span> <span m=''4222830''>compiler</span>
  <span m=''4223220''>to</span> <span m=''4223290''>do</span> <span m=''4223450''>it.</span>
  <span m=''4223600''>But</span> <span m=''4224170''>if</span> <span m=''4224310''>you</span>
  <span m=''4224400''>wanted</span> <span m=''4224680''>to</span> <span m=''4226050''>ship</span>
  <span m=''4226330''>it</span> <span m=''4226420''>off</span> <span m=''4226610''>to</span>
  <span m=''4226730''>somebody</span> <span m=''4227130''>else,</span> <span m=''4227820''>you</span>
  <span m=''4227970''>could</span> <span m=''4228090''>just</span> <span m=''4228520''>do</span>
  <span m=''4228670''>these</span> <span m=''4228810''>sharp</span> <span m=''4229150''>defines,</span>
  <span m=''4229730''>and</span> <span m=''4230010''>they</span> <span m=''4230280''>could</span>
  <span m=''4230440''>compile</span> <span m=''4230800''>it</span> <span m=''4230890''>with</span>
  <span m=''4231010''>their</span> <span m=''4231170''>compilers,</span> <span m=''4231430''>and</span>
  <span m=''4231690''>it</span> <span m=''4231780''>would</span> <span m=''4231920''>be</span>
  <span m=''4232040''>the</span> <span m=''4232120''>same</span> <span m=''4232750''>as</span>
  <span m=''4232930''>a</span> <span m=''4232990''>serial</span> <span m=''4233390''>C++</span>
  <span m=''4234090''>code.</span> </p><p><span m=''4236870''>So</span> <span m=''4237180''>the</span>
  <span m=''4238270''>Cilk++</span> <span m=''4239000''>concurrency</span> <span m=''4239600''>platform</span>
  <span m=''4240190''>allows</span> <span m=''4240650''>the</span> <span m=''4240730''>program</span>
  <span m=''4241070''>to</span> <span m=''4241180''>express</span> <span m=''4241620''>potential</span>
  <span m=''4242140''>parallelism</span> <span m=''4242700''>in</span> <span m=''4242900''>application.</span>
  <span m=''4245290''>So</span> <span m=''4245470''>it</span> <span m=''4245570''>says,</span>
  <span m=''4245840''>where</span> <span m=''4246180''>is</span> <span m=''4246450''>the</span>
  <span m=''4246540''>parallelism?</span> <span m=''4247110''>It</span> <span m=''4247200''>doesn''t</span>
  <span m=''4247520''>say</span> <span m=''4247680''>how</span> <span m=''4248040''>to</span>
  <span m=''4248750''>schedule it.</span> <span m=''4249240''>It</span> <span m=''4249360''>says,</span>
  <span m=''4249620''>where</span> <span m=''4249940''>is</span> <span m=''4250060''>it?</span>
  <span m=''4250910''>And</span> <span m=''4251130''>then,</span> <span m=''4251290''>it</span>
  <span m=''4251380''>gets</span> <span m=''4251570''>mapped</span> <span m=''4252050''>onto,</span>
  <span m=''4254856''>at</span> <span m=''4255270''>runtime,</span> <span m=''4255740''>dynamically</span>
  <span m=''4256430''>mapped</span> <span m=''4256800''>onto</span> <span m=''4257070''>the</span>
  <span m=''4257170''>processor</span> <span m=''4257750''>cores.</span> </p><p><span
  m=''4261680''>And</span> <span m=''4262410''>the</span> <span m=''4262570''>way</span>
  <span m=''4262840''>that</span> <span m=''4262950''>it</span> <span m=''4263070''>does</span>
  <span m=''4263300''>the</span> <span m=''4263390''>mapping</span> <span m=''4264420''>is</span>
  <span m=''4264720''>mathematically</span> <span m=''4265510''>provably</span> <span
  m=''4266140''>a</span> <span m=''4266260''>good</span> <span m=''4266490''>way</span>
  <span m=''4266730''>of</span> <span m=''4266850''>doing</span> <span m=''4267140''>it.</span>
  <span m=''4269130''>And</span> <span m=''4270050''>if</span> <span m=''4270190''>you</span>
  <span m=''4270310''>take</span> <span m=''4270590''>one</span> <span m=''4270820''>of</span>
  <span m=''4270860''>my</span> <span m=''4271000''>graduate</span> <span m=''4271460''>courses,</span>
  <span m=''4271930''>I</span> <span m=''4272030''>can</span> <span m=''4272250''>teach</span>
  <span m=''4272530''>you</span> <span m=''4272670''>how</span> <span m=''4272900''>that</span>
  <span m=''4273100''>works.</span> <span m=''4275840''>We''ll</span> <span m=''4276180''>do</span>
  <span m=''4276340''>a</span> <span m=''4276410''>little</span> <span m=''4276740''>bit</span>
  <span m=''4276900''>of</span> <span m=''4277000''>study</span> <span m=''4277490''>of</span>
  <span m=''4277790''>simple</span> <span m=''4278500''>scheduling.</span> <span m=''4279120''>But</span>
  <span m=''4279600''>the</span> <span m=''4279840''>actual</span> <span m=''4280650''>schedule</span>
  <span m=''4281110''>it</span> <span m=''4281210''>uses</span> <span m=''4281650''>is</span>
  <span m=''4281780''>more</span> <span m=''4283090''>involved.</span> <span m=''4283380''>But</span>
  <span m=''4283480''>we''ll</span> <span m=''4283920''>cover</span> <span m=''4284190''>it
  a</span> <span m=''4284240''>little</span> <span m=''4284360''>bit.</span> </p><p><span
  m=''4285680''>Here''s</span> <span m=''4286050''>the</span> <span m=''4286310''>components</span>
  <span m=''4286850''>of</span> <span m=''4286930''>the</span> <span m=''4287010''>Cilk++</span>
  <span m=''4288280''>platform</span> <span m=''4288860''>on</span> <span m=''4289010''>a</span>
  <span m=''4289090''>single</span> <span m=''4289440''>slide.</span> <span m=''4291330''>So</span>
  <span m=''4291480''>let</span> <span m=''4291570''>me</span> <span m=''4291670''>just</span>
  <span m=''4291850''>say</span> <span m=''4291990''>what</span> <span m=''4292130''>they</span>
  <span m=''4292260''>are.</span> <span m=''4292380''>The</span> <span m=''4292470''>first</span>
  <span m=''4292830''>one</span> <span m=''4292990''>is</span> <span m=''4293220''>the</span>
  <span m=''4293330''>keywords.</span> <span m=''4294600''>So you</span> <span m=''4294660''>get</span>
  <span m=''4294820''>to</span> <span m=''4295170''>put</span> <span m=''4295410''>things</span>
  <span m=''4295680''>in</span> <span m=''4295820''>there.</span> <span m=''4296630''>And</span>
  <span m=''4296840''>if</span> <span m=''4296930''>you</span> <span m=''4297140''>elide</span>
  <span m=''4298350''>or</span> <span m=''4299930''>create</span> <span m=''4300250''>the</span>
  <span m=''4300410''>serialization,</span> <span m=''4301620''>then</span> <span
  m=''4301910''>you</span> <span m=''4302700''>get</span> <span m=''4302900''>the</span>
  <span m=''4303510''>C++</span> <span m=''4303800''>code</span> <span m=''4304090''>or</span>
  <span m=''4304190''>C</span> <span m=''4304420''>code,</span> <span m=''4305340''>for</span>
  <span m=''4305500''>which</span> <span m=''4305730''>then</span> <span m=''4305960''>you</span>
  <span m=''4306180''>can</span> <span m=''4306420''>run</span> <span m=''4306730''>your</span>
  <span m=''4307700''>regression</span> <span m=''4308270''>test</span> <span m=''4308930''>and</span>
  <span m=''4309390''>demonstrate</span> <span m=''4309900''>you</span> <span m=''4310010''>have</span>
  <span m=''4310210''>some</span> <span m=''4310500''>good</span> <span m=''4310780''>single-threaded</span>
  <span m=''4311860''>program.</span> </p><p><span m=''4313170''>Alternatively,</span>
  <span m=''4313800''>you</span> <span m=''4313920''>can</span> <span m=''4314030''>send</span>
  <span m=''4314310''>it</span> <span m=''4314490''>through</span> <span m=''4314750''>the</span>
  <span m=''4314980''>Cilk++</span> <span m=''4315660''>compiler,</span> <span m=''4316270''>which</span>
  <span m=''4316460''>is</span> <span m=''4316560''>based</span> <span m=''4316920''>on</span>
  <span m=''4317060''>a</span> <span m=''4317110''>conventional</span> <span m=''4317660''>compiler.</span>
  <span m=''4318120''>In</span> <span m=''4318210''>our</span> <span m=''4318360''>case,</span>
  <span m=''4318630''>it will</span> <span m=''4318710''>be</span> <span m=''4318820''>GCC.</span>
  <span m=''4320520''>You</span> <span m=''4320660''>can</span> <span m=''4320770''>link</span>
  <span m=''4321130''>that</span> <span m=''4321360''>with</span> <span m=''4321470''>the</span>
  <span m=''4321910''>hyperobject</span> <span m=''4322270''>library,</span> <span
  m=''4322730''>which</span> <span m=''4322920''>we''ll</span> <span m=''4323020''>talk</span>
  <span m=''4323290''>about</span> <span m=''4323500''>when</span> <span m=''4323630''>we</span>
  <span m=''4323740''>start</span> <span m=''4324000''>talking</span> <span m=''4324280''>about</span>
  <span m=''4324580''>synchronization.</span> <span m=''4325780''>It</span> <span
  m=''4326100''>produces</span> <span m=''4326560''>a</span> <span m=''4326610''>binary.</span>
  <span m=''4327515''>If</span> <span m=''4327780''>you</span> <span m=''4327990''>run</span>
  <span m=''4328170''>that</span> <span m=''4328400''>binary</span> <span m=''4328960''>on</span>
  <span m=''4329190''>the</span> <span m=''4329290''>runtime</span> <span m=''4329830''>system,</span>
  <span m=''4330530''>you</span> <span m=''4330670''>can</span> <span m=''4330770''>also</span>
  <span m=''4331090''>run it</span> <span m=''4331360''>to</span> <span m=''4331460''>the</span>
  <span m=''4331550''>regression</span> <span m=''4331990''>test.</span> </p><p><span
  m=''4332300''>And in</span> <span m=''4332390''>particular,</span> <span m=''4332810''>if</span>
  <span m=''4332920''>you</span> <span m=''4333060''>run</span> <span m=''4333280''>it</span>
  <span m=''4333360''>on</span> <span m=''4333470''>the</span> <span m=''4333560''>runtime</span>
  <span m=''4334020''>system,</span> <span m=''4334980''>running</span> <span m=''4335250''>on</span>
  <span m=''4335490''>one</span> <span m=''4335840''>core,</span> <span m=''4336810''>it</span>
  <span m=''4337020''>should</span> <span m=''4337260''>behave</span> <span m=''4337810''>identically</span>
  <span m=''4339270''>to</span> <span m=''4340440''>having</span> <span m=''4340780''>run</span>
  <span m=''4340950''>it</span> <span m=''4341090''>through</span> <span m=''4341350''>this</span>
  <span m=''4341590''>path</span> <span m=''4342590''>with</span> <span m=''4342910''>just</span>
  <span m=''4343160''>the</span> <span m=''4343240''>serial</span> <span m=''4343630''>code.</span>
  <span m=''4346670''>And</span> <span m=''4346820''>of</span> <span m=''4346880''>course,</span>
  <span m=''4347110''>you</span> <span m=''4347180''>get</span> <span m=''4347310''>exceptional</span>
  <span m=''4347790''>performance.</span> <span m=''4349080''>These,</span> <span
  m=''4349420''>I</span> <span m=''4349590''>think,</span> <span m=''4349750''>were</span>
  <span m=''4349890''>originally</span> <span m=''4350300''>marketing</span> <span
  m=''4350740''>slides.</span> </p><p><span m=''4354290''>However,</span> <span m=''4354690''>there''s</span>
  <span m=''4354890''>also</span> <span m=''4355370''>the</span> <span m=''4355480''>fact</span>
  <span m=''4356560''>that</span> <span m=''4357890''>you</span> <span m=''4358090''>may</span>
  <span m=''4358370''>get</span> <span m=''4358680''>what</span> <span m=''4358790''>are</span>
  <span m=''4358900''>called</span> <span m=''4359240''>races</span> <span m=''4359800''>in</span>
  <span m=''4359920''>your</span> <span m=''4360080''>code,</span> <span m=''4360610''>which</span>
  <span m=''4361020''>are</span> <span m=''4361890''>bugs</span> <span m=''4362310''>that</span>
  <span m=''4362420''>will</span> <span m=''4362640''>come</span> <span m=''4362910''>up</span>
  <span m=''4363110''>that</span> <span m=''4363250''>won''t</span> <span m=''4363520''>occur</span>
  <span m=''4363830''>in</span> <span m=''4363920''>your</span> <span m=''4364080''>serial</span>
  <span m=''4364480''>code,</span> <span m=''4364790''>but</span> <span m=''4365000''>will</span>
  <span m=''4365300''>occur</span> <span m=''4365670''>in</span> <span m=''4365870''>your</span>
  <span m=''4366020''>parallel</span> <span m=''4366490''>code.</span> <span m=''4368680''>Cilk</span>
  <span m=''4369000''>has</span> <span m=''4369180''>a</span> <span m=''4369240''>race</span>
  <span m=''4369570''>detector to</span> <span m=''4370020''>detect</span> <span m=''4370570''>those,</span>
  <span m=''4370950''>for</span> <span m=''4371070''>which</span> <span m=''4371230''>you</span>
  <span m=''4371330''>can</span> <span m=''4371510''>run</span> <span m=''4371740''>parallel</span>
  <span m=''4372210''>regression</span> <span m=''4372710''>tests</span> <span m=''4373350''>to</span>
  <span m=''4373490''>produce</span> <span m=''4373850''>your</span> <span m=''4373980''>reliable</span>
  <span m=''4374450''>multi-threaded</span> <span m=''4375080''>code.</span> </p><p><span
  m=''4375960''>And</span> <span m=''4376130''>then,</span> <span m=''4376300''>the</span>
  <span m=''4376380''>final</span> <span m=''4376810''>piece</span> <span m=''4377100''>of</span>
  <span m=''4377210''>it</span> <span m=''4377370''>is</span> <span m=''4377660''>there''s</span>
  <span m=''4377910''>this</span> <span m=''4378090''>thing</span> <span m=''4378270''>called</span>
  <span m=''4378560''>Cilkview,</span> <span m=''4379440''>which</span> <span m=''4379680''>allows</span>
  <span m=''4380080''>you</span> <span m=''4380240''>to</span> <span m=''4380460''>analyze</span>
  <span m=''4381320''>the</span> <span m=''4381390''>scalability</span> <span m=''4382250''>of</span>
  <span m=''4382340''>your</span> <span m=''4382490''>software.</span> <span m=''4383410''>So
  you</span> <span m=''4383530''>can</span> <span m=''4383680''>run,</span> <span
  m=''4383850''>in</span> <span m=''4383950''>fact,</span> <span m=''4384370''>on</span>
  <span m=''4384550''>a</span> <span m=''4385280''>single</span> <span m=''4386140''>core</span>
  <span m=''4386560''>or</span> <span m=''4386810''>on</span> <span m=''4386940''>a</span>
  <span m=''4387020''>small</span> <span m=''4387370''>number</span> <span m=''4387620''>of</span>
  <span m=''4387710''>cores.</span> <span m=''4388550''>And</span> <span m=''4388740''>then,</span>
  <span m=''4388880''>you</span> <span m=''4389020''>can</span> <span m=''4389160''>predict</span>
  <span m=''4389620''>how</span> <span m=''4389830''>it''s</span> <span m=''4389970''>going</span>
  <span m=''4390070''>to</span> <span m=''4390110''>behave</span> <span m=''4390530''>on</span>
  <span m=''4390620''>a</span> <span m=''4390680''>large</span> <span m=''4391030''>number</span>
  <span m=''4391260''>of</span> <span m=''4391350''>cores.</span> </p><p><span m=''4394320''>So</span>
  <span m=''4394490''>let''s</span> <span m=''4394770''>just,</span> <span m=''4396140''>to</span>
  <span m=''4396450''>conclude</span> <span m=''4396850''>here,</span> <span m=''4397060''>talk</span>
  <span m=''4397330''>about</span> <span m=''4397590''>races.</span> <span m=''4398450''>Because</span>
  <span m=''4398680''>they''re</span> <span m=''4398910''>the</span> <span m=''4399650''>nasty,</span>
  <span m=''4400130''>nasty,</span> <span m=''4400550''>nasty</span> <span m=''4400960''>thing</span>
  <span m=''4401160''>we</span> <span m=''4401250''>get</span> <span m=''4401380''>into</span>
  <span m=''4401590''>parallel</span> <span m=''4401970''>programming.</span> <span
  m=''4402820''>And</span> <span m=''4402970''>then</span> <span m=''4403100''>next</span>
  <span m=''4403360''>time,</span> <span m=''4403550''>we''ll</span> <span m=''4403650''>get</span>
  <span m=''4403840''>deeper</span> <span m=''4404180''>into</span> <span m=''4404420''>the</span>
  <span m=''4405340''>Cilk</span> <span m=''4405620''>technology</span> <span m=''4406190''>itself.</span>
  </p><p><span m=''4409400''>So</span> <span m=''4409630''>the</span> <span m=''4409750''>most</span>
  <span m=''4410230''>basic</span> <span m=''4410810''>kind</span> <span m=''4411130''>of</span>
  <span m=''4411260''>race</span> <span m=''4411610''>there</span> <span m=''4412160''>is</span>
  <span m=''4412300''>what''s</span> <span m=''4412520''>called</span> <span m=''4412830''>a</span>
  <span m=''4412930''>determinacy</span> <span m=''4413890''>race.</span> <span m=''4415330''>Because</span>
  <span m=''4415960''>if</span> <span m=''4416100''>you</span> <span m=''4416320''>have</span>
  <span m=''4416540''>one</span> <span m=''4416700''>of</span> <span m=''4416870''>these</span>
  <span m=''4417030''>things,</span> <span m=''4417310''>your</span> <span m=''4417460''>program</span>
  <span m=''4418710''>becomes</span> <span m=''4419220''>nondeterministic.</span>
  <span m=''4421350''>It</span> <span m=''4421560''>doesn''t</span> <span m=''4421920''>do</span>
  <span m=''4422060''>the</span> <span m=''4422150''>same</span> <span m=''4422470''>thing</span>
  <span m=''4422730''>every</span> <span m=''4423020''>time.</span> </p><p><span m=''4424400''>A</span>
  <span m=''4424560''>determinacy</span> <span m=''4425110''>race</span> <span m=''4425550''>occurs</span>
  <span m=''4426040''>when</span> <span m=''4426220''>two</span> <span m=''4426390''>logically</span>
  <span m=''4427080''>parallel</span> <span m=''4427570''>instructions</span> <span
  m=''4428790''>access</span> <span m=''4429440''>the</span> <span m=''4429540''>same</span>
  <span m=''4429910''>memory</span> <span m=''4430230''>location,</span> <span m=''4431390''>and</span>
  <span m=''4431590''>at</span> <span m=''4431650''>least</span> <span m=''4431990''>one</span>
  <span m=''4432540''>of</span> <span m=''4432730''>the</span> <span m=''4432880''>instructions</span>
  <span m=''4433600''>performs</span> <span m=''4434240''>a</span> <span m=''4434430''>write,</span>
  <span m=''4434950''>performs</span> <span m=''4435450''>a</span> <span m=''4435500''>store,</span>
  <span m=''4435970''>to</span> <span m=''4436090''>that</span> <span m=''4436310''>location.</span>
  <span m=''4438190''>So</span> <span m=''4438340''>here''s</span> <span m=''4438650''>an</span>
  <span m=''4438720''>example.</span> </p><p><span m=''4441030''>I</span> <span m=''4441170''>have</span>
  <span m=''4441300''>a</span> <span m=''4441420''>cilk_for</span> <span m=''4442160''>here,</span>
  <span m=''4444420''>both</span> <span m=''4444950''>branches</span> <span m=''4445510''>of</span>
  <span m=''4445610''>which</span> <span m=''4445870''>are</span> <span m=''4446050''>incrementing</span>
  <span m=''4446700''>x.</span> <span m=''4448540''>This</span> <span m=''4448710''>is</span>
  <span m=''4448820''>basically</span> <span m=''4449220''>going.</span> <span m=''4449560''>The</span>
  <span m=''4449670''>index is</span> <span m=''4450170''>going.</span> <span m=''4450740''>i</span>
  <span m=''4450910''>equals</span> <span m=''4451170''>0</span> <span m=''4451580''>and</span>
  <span m=''4451730''>i</span> <span m=''4451800''>equals</span> <span m=''4452110''>1.</span>
  <span m=''4453010''>And then,</span> <span m=''4453310''>it''s</span> <span m=''4453350''>asserting</span>
  <span m=''4453780''>that</span> <span m=''4453930''>x</span> <span m=''4454210''>equals</span>
  <span m=''4454570''>2.</span> <span m=''4455640''>If</span> <span m=''4455870''>I</span>
  <span m=''4455990''>run</span> <span m=''4456290''>this</span> <span m=''4456630''>serially,</span>
  <span m=''4458240''>the</span> <span m=''4458350''>assertion</span> <span m=''4458820''>passes.</span>
  <span m=''4462200''>But</span> <span m=''4462400''>when</span> <span m=''4462560''>I</span>
  <span m=''4462640''>run</span> <span m=''4462850''>it</span> <span m=''4462900''>in</span>
  <span m=''4463020''>parallel,</span> <span m=''4464190''>it</span> <span m=''4464360''>may</span>
  <span m=''4464520''>not</span> <span m=''4465910''>produce</span> <span m=''4466310''>a</span>
  <span m=''4466390''>2.</span> <span m=''4467230''>It</span> <span m=''4467380''>can</span>
  <span m=''4467530''>produce</span> <span m=''4467890''>a</span> <span m=''4467960''>1.</span>
  </p><p><span m=''4468730''>And</span> <span m=''4469060''>let''s</span> <span m=''4469320''>see</span>
  <span m=''4469440''>why</span> <span m=''4469690''>that</span> <span m=''4469910''>is.</span>
  <span m=''4471000''>So</span> <span m=''4471210''>the</span> <span m=''4471320''>way</span>
  <span m=''4471630''>to</span> <span m=''4471650''>understand</span> <span m=''4472300''>this</span>
  <span m=''4472530''>code</span> <span m=''4472860''>is</span> <span m=''4473090''>to</span>
  <span m=''4473220''>think</span> <span m=''4473480''>about</span> <span m=''4474180''>its</span>
  <span m=''4474350''>execution</span> <span m=''4475270''>in</span> <span m=''4475460''>terms</span>
  <span m=''4475800''>of</span> <span m=''4475950''>a</span> <span m=''4476170''>dependency</span>
  <span m=''4476820''>[? dag ?].</span> <span m=''4477520''>So</span> <span m=''4477670''>here</span>
  <span m=''4477950''>I</span> <span m=''4478060''>have</span> <span m=''4478350''>my</span>
  <span m=''4478520''>initialization</span> <span m=''4479330''>of</span> <span m=''4479390''>x.</span>
  <span m=''4481650''>Then</span> <span m=''4482270''>once</span> <span m=''4482660''>that''s</span>
  <span m=''4483010''>done,</span> <span m=''4483690''>the</span> <span m=''4483930''>cilk_for</span>
  <span m=''4484330''>loop</span> <span m=''4484520''>allows</span> <span m=''4484900''>me</span>
  <span m=''4485030''>to</span> <span m=''4485140''>do</span> <span m=''4485330''>two</span>
  <span m=''4485620''>things</span> <span m=''4485970''>at</span> <span m=''4486020''>a</span>
  <span m=''4486100''>time,</span> <span m=''4486940''>b</span> <span m=''4487730''>and</span>
  <span m=''4487910''>c,</span> <span m=''4488450''>which</span> <span m=''4488630''>are</span>
  <span m=''4488700''>both</span> <span m=''4489290''>incrementing</span> <span m=''4489860''>x.</span>
  </p><p><span m=''4492030''>And</span> <span m=''4492250''>then,</span> <span m=''4492470''>I</span>
  <span m=''4492630''>assert</span> <span m=''4493030''>that</span> <span m=''4493290''>x</span>
  <span m=''4493390''>equals</span> <span m=''4493770''>2</span> <span m=''4495240''>when</span>
  <span m=''4495440''>they''re</span> <span m=''4495590''>both</span> <span m=''4495950''>done.</span>
  <span m=''4498340''>Because</span> <span m=''4498510''>that''s</span> <span m=''4498730''>the</span>
  <span m=''4498800''>semantics</span> <span m=''4499310''>of the</span> <span m=''4499490''>cilk_for.</span>
  <span m=''4501970''>So</span> <span m=''4502110''>let''s</span> <span m=''4502430''>see</span>
  <span m=''4503010''>where</span> <span m=''4503460''>the</span> <span m=''4503670''>race</span>
  <span m=''4503960''>occurs.</span> <span m=''4504400''>So remember</span> <span
  m=''4504730''>that it</span> <span m=''4504870''>occurs</span> <span m=''4505370''>when</span>
  <span m=''4505530''>I</span> <span m=''4505630''>have</span> <span m=''4505720''>two</span>
  <span m=''4506010''>logically</span> <span m=''4506580''>parallel</span> <span m=''4507090''>instructions</span>
  <span m=''4507840''>that</span> <span m=''4507980''>access</span> <span m=''4508550''>the</span>
  <span m=''4508620''>same</span> <span m=''4508950''>memory</span> <span m=''4509320''>location.</span>
  <span m=''4510390''>Here,</span> <span m=''4510560''>it''s</span> <span m=''4510660''>going</span>
  <span m=''4510740''>to</span> <span m=''4510810''>be</span> <span m=''4510930''>the</span>
  <span m=''4511150''>location</span> <span m=''4511670''>x.</span> <span m=''4512350''>And
  at</span> <span m=''4512470''>least</span> <span m=''4512790''>one</span> <span
  m=''4512990''>of</span> <span m=''4513100''>them</span> <span m=''4513350''>performs</span>
  <span m=''4513740''>a</span> <span m=''4513810''>write</span> <span m=''4516020''>execution.</span>
  </p><p><span m=''4518750''>So</span> <span m=''4519020''>if</span> <span m=''4519110''>we</span>
  <span m=''4519240''>actually</span> <span m=''4519560''>looked</span> <span m=''4519790''>closer,</span>
  <span m=''4521530''>I</span> <span m=''4521620''>want</span> <span m=''4521780''>to</span>
  <span m=''4521820''>expand</span> <span m=''4522410''>this</span> <span m=''4522630''>into</span>
  <span m=''4522890''>this</span> <span m=''4523220''>larger</span> <span m=''4523590''>thing.</span>
  <span m=''4523910''>Because</span> <span m=''4524170''>as</span> <span m=''4524380''>you
  know,</span> <span m=''4524840''>X++</span> <span m=''4525710''>is</span> <span
  m=''4525840''>not</span> <span m=''4526180''>done</span> <span m=''4526490''>on</span>
  <span m=''4526690''>a</span> <span m=''4527050''>memory</span> <span m=''4527510''>location.</span>
  <span m=''4528040''>It''s</span> <span m=''4528150''>not</span> <span m=''4528390''>done</span>
  <span m=''4528560''>as</span> <span m=''4528710''>a</span> <span m=''4528760''>single</span>
  <span m=''4529100''>instruction.</span> <span m=''4530120''>It''s</span> <span m=''4530320''>done</span>
  <span m=''4530530''>as</span> <span m=''4530740''>a</span> <span m=''4530950''>load,</span>
  <span m=''4531930''>x</span> <span m=''4532200''>into</span> <span m=''4532380''>a</span>
  <span m=''4532450''>register.</span> <span m=''4533480''>Increment</span> <span
  m=''4534030''>the</span> <span m=''4534130''>register,</span> <span m=''4534750''>and</span>
  <span m=''4534940''>then</span> <span m=''4535110''>store</span> <span m=''4535490''>the</span>
  <span m=''4535600''>value</span> <span m=''4535960''>back</span> <span m=''4536280''>in.</span>
  </p><p><span m=''4538470''>And</span> <span m=''4538700''>meanwhile,</span> <span
  m=''4539140''>there''s</span> <span m=''4539340''>another</span> <span m=''4539660''>register</span>
  <span m=''4540140''>on</span> <span m=''4540210''>another</span> <span m=''4540530''>processor,</span>
  <span m=''4541140''>presumably,</span> <span m=''4541810''>that''s</span> <span
  m=''4542130''>doing</span> <span m=''4542850''>the</span> <span m=''4542960''>same</span>
  <span m=''4543270''>thing.</span> <span m=''4545030''>So</span> <span m=''4545190''>this</span>
  <span m=''4545390''>is</span> <span m=''4545540''>the</span> <span m=''4545630''>one</span>
  <span m=''4545840''>I</span> <span m=''4545900''>want</span> <span m=''4546070''>to</span>
  <span m=''4546120''>look</span> <span m=''4546360''>at.</span> <span m=''4546590''>This
  is</span> <span m=''4546700''>just</span> <span m=''4546990''>a</span> <span m=''4547960''>zooming</span>
  <span m=''4548420''>in,</span> <span m=''4548600''>if</span> <span m=''4548710''>you</span>
  <span m=''4548840''>will,</span> <span m=''4549530''>on</span> <span m=''4549700''>this</span>
  <span m=''4549890''>dependency</span> <span m=''4550390''>graph</span> <span m=''4550720''>to</span>
  <span m=''4550850''>look</span> <span m=''4551180''>a</span> <span m=''4551330''>little</span>
  <span m=''4551490''>bit</span> <span m=''4551720''>finer</span> <span m=''4552050''>grain</span>
  <span m=''4552420''>at</span> <span m=''4552530''>what''s</span> <span m=''4552760''>actually</span>
  <span m=''4553070''>happening</span> <span m=''4554040''>one</span> <span m=''4554240''>step</span>
  <span m=''4554520''>at</span> <span m=''4554600''>a</span> <span m=''4554680''>time.</span>
  </p><p><span m=''4556570''>So</span> <span m=''4556760''>the</span> <span m=''4556880''>determinacy</span>
  <span m=''4557610''>race,</span> <span m=''4558010''>recall,</span> <span m=''4558480''>occurs--</span>
  <span m=''4559980''>this</span> <span m=''4560160''>is</span> <span m=''4560250''>by</span>
  <span m=''4560510''>something,</span> <span m=''4560960''>I''m</span> <span m=''4561000''>going
  to say</span> <span m=''4561210''>again,</span> <span m=''4561620''>you</span> <span
  m=''4561820''>should</span> <span m=''4562040''>memorize.</span> <span m=''4564420''>So</span>
  <span m=''4564600''>you</span> <span m=''4564780''>should</span> <span m=''4564990''>know</span>
  <span m=''4565180''>what</span> <span m=''4565400''>this</span> <span m=''4565600''>is.</span>
  <span m=''4565850''>You</span> <span m=''4565970''>should</span> <span m=''4566110''>be</span>
  <span m=''4566260''>able</span> <span m=''4566390''>to</span> <span m=''4566690''>say</span>
  <span m=''4566980''>what</span> <span m=''4567220''>a</span> <span m=''4567310''>determinacy</span>
  <span m=''4567950''>race</span> <span m=''4568270''>is.</span> </p><p><span m=''4569750''>It''s</span>
  <span m=''4569870''>when</span> <span m=''4570100''>you</span> <span m=''4570220''>have</span>
  <span m=''4570330''>two</span> <span m=''4571290''>instructions</span> <span m=''4571950''>that</span>
  <span m=''4572030''>are</span> <span m=''4572100''>both</span> <span m=''4572430''>accessing</span>
  <span m=''4572990''>the</span> <span m=''4573060''>same</span> <span m=''4573300''>location,</span>
  <span m=''4574180''>and</span> <span m=''4574360''>one</span> <span m=''4574500''>of</span>
  <span m=''4574540''>them</span> <span m=''4574670''>performs</span> <span m=''4575050''>write.</span>
  <span m=''4575230''>And</span> <span m=''4575360''>here,</span> <span m=''4575610''>I</span>
  <span m=''4575700''>have</span> <span m=''4575960''>that.</span> <span m=''4576160''>This</span>
  <span m=''4576370''>guy</span> <span m=''4576590''>is</span> <span m=''4576730''>in</span>
  <span m=''4576850''>parallel.</span> <span m=''4577780''>He''s</span> <span m=''4577980''>being</span>
  <span m=''4578170''>stored</span> <span m=''4578620''>to</span> <span m=''4579760''>here.</span>
  <span m=''4580360''>This</span> <span m=''4580530''>is</span> <span m=''4580710''>also</span>
  <span m=''4581060''>a</span> <span m=''4581150''>race.</span> <span m=''4582160''>He''s</span>
  <span m=''4582340''>been</span> <span m=''4582590''>reading</span> <span m=''4582930''>it,</span>
  <span m=''4583180''>and</span> <span m=''4583300''>this</span> <span m=''4583450''>guy
  is</span> <span m=''4583750''>writing it.</span> </p><p><span m=''4586080''>So</span>
  <span m=''4586220''>let''s</span> <span m=''4586410''>see</span> <span m=''4586520''>what</span>
  <span m=''4586700''>can</span> <span m=''4586840''>happen</span> <span m=''4587260''>and</span>
  <span m=''4587910''>what</span> <span m=''4588100''>can</span> <span m=''4588260''>go</span>
  <span m=''4588430''>wrong</span> <span m=''4588740''>here.</span> <span m=''4589470''>So</span>
  <span m=''4589640''>here''s</span> <span m=''4589940''>my</span> <span m=''4590110''>value,</span>
  <span m=''4590500''>x,</span> <span m=''4590760''>in</span> <span m=''4590860''>memory.</span>
  <span m=''4591650''>And</span> <span m=''4591800''>here''s</span> <span m=''4592520''>my</span>
  <span m=''4592800''>two</span> <span m=''4593030''>registers</span> <span m=''4593620''>on,</span>
  <span m=''4593800''>presumably,</span> <span m=''4594390''>two</span> <span m=''4594530''>different</span>
  <span m=''4594820''>processors.</span> <span m=''4596020''>So</span> <span m=''4596220''>one</span>
  <span m=''4596490''>thing</span> <span m=''4597140''>is</span> <span m=''4597420''>that</span>
  <span m=''4597570''>you</span> <span m=''4597680''>can</span> <span m=''4597890''>typically--</span>
  <span m=''4598690''>and</span> <span m=''4598860''>this</span> <span m=''4598990''>is</span>
  <span m=''4599110''>not</span> <span m=''4599340''>quite</span> <span m=''4600880''>the</span>
  <span m=''4600990''>case</span> <span m=''4601290''>with</span> <span m=''4601440''>real</span>
  <span m=''4601800''>hardware--</span> <span m=''4602220''>but</span> <span m=''4602430''>an</span>
  <span m=''4602580''>abstraction</span> <span m=''4603240''>of</span> <span m=''4603310''>the</span>
  <span m=''4603400''>hardware</span> <span m=''4604020''>is</span> <span m=''4604410''>that</span>
  <span m=''4604720''>you</span> <span m=''4604970''>can</span> <span m=''4605110''>treat</span>
  <span m=''4605530''>the</span> <span m=''4605620''>parallel</span> <span m=''4606150''>execution</span>
  <span m=''4607430''>from</span> <span m=''4607610''>a</span> <span m=''4607660''>logical</span>
  <span m=''4608270''>point</span> <span m=''4608540''>of</span> <span m=''4608620''>view</span>
  <span m=''4608960''>as</span> <span m=''4609200''>if</span> <span m=''4609320''>you''re</span>
  <span m=''4609500''>interleaving</span> <span m=''4610220''>instructions</span>
  <span m=''4611430''>from</span> <span m=''4611600''>the</span> <span m=''4611690''>different</span>
  <span m=''4612070''>processors.</span> </p><p><span m=''4613190''>OK.</span> <span
  m=''4613680''>We''re</span> <span m=''4613800''>going</span> <span m=''4613890''>to</span>
  <span m=''4613960''>talk</span> <span m=''4614790''>in</span> <span m=''4615670''>three</span>
  <span m=''4615940''>or</span> <span m=''4616000''>four</span> <span m=''4616250''>lectures</span>
  <span m=''4616750''>about</span> <span m=''4617340''>where</span> <span m=''4617850''>that</span>
  <span m=''4618280''>isn''t</span> <span m=''4618880''>the</span> <span m=''4618990''>right</span>
  <span m=''4619310''>abstraction.</span> <span m=''4620000''>But</span> <span m=''4620210''>it</span>
  <span m=''4620380''>is</span> <span m=''4620550''>close</span> <span m=''4621290''>to</span>
  <span m=''4621410''>the</span> <span m=''4621500''>right</span> <span m=''4621700''>abstraction.</span>
  <span m=''4623480''>So</span> <span m=''4623660''>here,</span> <span m=''4623910''>basically,</span>
  <span m=''4624360''>we</span> <span m=''4624540''>execute</span> <span m=''4625030''>statement</span>
  <span m=''4625510''>one,</span> <span m=''4625850''>which</span> <span m=''4626020''>causes</span>
  <span m=''4626420''>x</span> <span m=''4626690''>to</span> <span m=''4626780''>become</span>
  <span m=''4627120''>0.</span> </p><p><span m=''4629430''>Now</span> <span m=''4629650''>let''s</span>
  <span m=''4629890''>execute</span> <span m=''4630310''>statement</span> <span m=''4630840''>two.</span>
  <span m=''4631300''>That</span> <span m=''4631520''>causes</span> <span m=''4632030''>r1</span>
  <span m=''4633130''>to</span> <span m=''4633260''>become</span> <span m=''4633850''>0.</span>
  <span m=''4636730''>Then,</span> <span m=''4636900''>I</span> <span m=''4636990''>can</span>
  <span m=''4637170''>increment</span> <span m=''4637660''>that.</span> <span m=''4638130''>It
  becomes</span> <span m=''4638500''>a</span> <span m=''4638560''>1.</span> <span
  m=''4639310''>All</span> <span m=''4639590''>well</span> <span m=''4639830''>and</span>
  <span m=''4639950''>good.</span> <span m=''4641130''>But</span> <span m=''4641260''>now</span>
  <span m=''4641480''>if</span> <span m=''4641670''>the</span> <span m=''4641770''>next</span>
  <span m=''4642180''>logical</span> <span m=''4642820''>thing</span> <span m=''4643050''>that</span>
  <span m=''4643150''>happens</span> <span m=''4643680''>is</span> <span m=''4643890''>that</span>
  <span m=''4644020''>r2</span> <span m=''4645670''>is</span> <span m=''4646550''>set</span>
  <span m=''4646880''>to</span> <span m=''4646960''>the</span> <span m=''4647040''>value</span>
  <span m=''4647440''>x,</span> <span m=''4649190''>then</span> <span m=''4649430''>it</span>
  <span m=''4649680''>becomes</span> <span m=''4650100''>0.</span> <span m=''4651390''>Then</span>
  <span m=''4651540''>we</span> <span m=''4651670''>increment</span> <span m=''4652160''>it.</span>
  </p><p><span m=''4653360''>And</span> <span m=''4653540''>now,</span> <span m=''4654640''>he</span>
  <span m=''4654750''>stores</span> <span m=''4655220''>back</span> <span m=''4655510''>1</span>
  <span m=''4655780''>into</span> <span m=''4656010''>x.</span> <span m=''4656900''>And</span>
  <span m=''4657070''>now,</span> <span m=''4657220''>this</span> <span m=''4657450''>guy</span>
  <span m=''4657630''>stores</span> <span m=''4658050''>1</span> <span m=''4658270''>back</span>
  <span m=''4658550''>into</span> <span m=''4658740''>x.</span> <span m=''4659530''>And</span>
  <span m=''4659720''>notice</span> <span m=''4660180''>that</span> <span m=''4660490''>now,</span>
  <span m=''4660860''>we</span> <span m=''4661260''>[UNINTELLIGIBLE]</span> <span
  m=''4661770''>go</span> <span m=''4662000''>to</span> <span m=''4662160''>the</span>
  <span m=''4662310''>assertion.</span> <span m=''4663320''>And we</span> <span m=''4663590''>assert</span>
  <span m=''4664010''>that</span> <span m=''4664110''>it''s</span> <span m=''4664310''>2,</span>
  <span m=''4664650''>and</span> <span m=''4665010''>it''s</span> <span m=''4665210''>not</span>
  <span m=''4665450''>the</span> <span m=''4665540''>2.</span> <span m=''4667630''>It''s
  a</span> <span m=''4667780''>1.</span> <span m=''4669660''>Because</span> <span
  m=''4669980''>we</span> <span m=''4670100''>lost</span> <span m=''4670580''>one</span>
  <span m=''4670730''>of</span> <span m=''4670800''>the</span> <span m=''4670940''>updates.</span>
  </p><p><span m=''4671870''>Now</span> <span m=''4671970''>the</span> <span m=''4672060''>reason</span>
  <span m=''4672430''>race</span> <span m=''4672770''>bugs</span> <span m=''4673060''>are</span>
  <span m=''4673170''>really</span> <span m=''4673810''>pernicious</span> <span m=''4674430''>is,</span>
  <span m=''4674640''>notice</span> <span m=''4675090''>that</span> <span m=''4675330''>if</span>
  <span m=''4675600''>I</span> <span m=''4675790''>had</span> <span m=''4675970''>executed</span>
  <span m=''4676490''>this</span> <span m=''4676650''>whole</span> <span m=''4676910''>branch,</span>
  <span m=''4677880''>and</span> <span m=''4678060''>then</span> <span m=''4678250''>this</span>
  <span m=''4678570''>whole</span> <span m=''4678800''>branch,</span> <span m=''4680250''>I</span>
  <span m=''4680380''>get</span> <span m=''4680590''>the</span> <span m=''4680680''>right</span>
  <span m=''4680900''>answer.</span> <span m=''4682510''>Or</span> <span m=''4682840''>if</span>
  <span m=''4682960''>I</span> <span m=''4683080''>executed</span> <span m=''4683800''>this</span>
  <span m=''4684030''>whole</span> <span m=''4684270''>branch,</span> <span m=''4685030''>and</span>
  <span m=''4685220''>then</span> <span m=''4685560''>this</span> <span m=''4685860''>whole</span>
  <span m=''4686100''>branch,</span> <span m=''4687030''>I</span> <span m=''4687140''>get</span>
  <span m=''4687370''>the</span> <span m=''4687450''>right</span> <span m=''4687680''>answer.</span>
  <span m=''4688600''>The</span> <span m=''4688730''>only</span> <span m=''4689080''>time</span>
  <span m=''4689420''>I</span> <span m=''4689490''>don''t</span> <span m=''4689720''>get</span>
  <span m=''4689880''>the</span> <span m=''4689970''>right</span> <span m=''4690180''>answer</span>
  <span m=''4690580''>is</span> <span m=''4690670''>when</span> <span m=''4690860''>those</span>
  <span m=''4691130''>two</span> <span m=''4691310''>things</span> <span m=''4691880''>happen</span>
  <span m=''4692310''>to</span> <span m=''4692690''>interleave</span> <span m=''4693090''>just</span>
  <span m=''4693370''>so.</span> </p><p><span m=''4694490''>And</span> <span m=''4694660''>that''s</span>
  <span m=''4695130''>what</span> <span m=''4695310''>happens</span> <span m=''4695770''>with</span>
  <span m=''4696500''>race</span> <span m=''4696840''>conditions</span> <span m=''4697380''>generally,</span>
  <span m=''4698190''>is</span> <span m=''4698370''>that</span> <span m=''4699040''>you</span>
  <span m=''4699310''>can</span> <span m=''4699570''>run</span> <span m=''4699780''>your</span>
  <span m=''4699980''>code</span> <span m=''4700280''>a</span> <span m=''4700380''>million</span>
  <span m=''4701020''>times</span> <span m=''4701460''>and</span> <span m=''4701540''>not</span>
  <span m=''4701780''>see</span> <span m=''4701950''>the</span> <span m=''4702050''>bug,</span>
  <span m=''4703050''>and</span> <span m=''4703250''>then</span> <span m=''4703460''>run</span>
  <span m=''4703700''>it</span> <span m=''4703790''>once,</span> <span m=''4704120''>and</span>
  <span m=''4704230''>it</span> <span m=''4704340''>crashes</span> <span m=''4706680''>out</span>
  <span m=''4706910''>in</span> <span m=''4706980''>the</span> <span m=''4707040''>field.</span>
  <span m=''4707670''>Or</span> <span m=''4708170''>what''s</span> <span m=''4708480''>happened</span>
  <span m=''4708910''>is</span> <span m=''4709330''>there</span> <span m=''4709460''>have
  been</span> <span m=''4709630''>race</span> <span m=''4709920''>bugs</span> <span
  m=''4711400''>responsible</span> <span m=''4711930''>for</span> <span m=''4712780''>failure</span>
  <span m=''4713050''>of</span> <span m=''4713320''>space</span> <span m=''4713610''>shuttle</span>
  <span m=''4713950''>to</span> <span m=''4714050''>launch.</span> <span m=''4715640''>You
  have</span> <span m=''4715750''>the</span> <span m=''4715840''>North</span> <span
  m=''4716110''>American</span> <span m=''4716580''>blackout</span> <span m=''4717370''>of</span>
  <span m=''4721150''>2001?</span> <span m=''4722042''>2003?</span> </p><p><span m=''4723505''>It
  wasn''t</span> <span m=''4723950''>that</span> <span m=''4724280''>long</span> <span
  m=''4724520''>ago.</span> <span m=''4724890''>It was like,</span> <span m=''4725050''>10</span>
  <span m=''4725230''>years</span> <span m=''4725450''>ago.</span> <span m=''4725680''>We</span>
  <span m=''4725800''>had</span> <span m=''4725950''>big</span> <span m=''4726170''>black</span>
  <span m=''4726510''>out</span> <span m=''4726670''>caused</span> <span m=''4726930''>by
  a</span> <span m=''4727060''>race</span> <span m=''4727370''>condition</span> <span
  m=''4728010''>in</span> <span m=''4728560''>the</span> <span m=''4728680''>code</span>
  <span m=''4728970''>run</span> <span m=''4729150''>by</span> <span m=''4730520''>the</span>
  <span m=''4730650''>power</span> <span m=''4730970''>companies.</span> <span m=''4731840''>There</span>
  <span m=''4732030''>been</span> <span m=''4732250''>medical</span> <span m=''4733110''>instruments</span>
  <span m=''4733730''>that</span> <span m=''4733890''>have</span> <span m=''4734420''>fried</span>
  <span m=''4735270''>people,</span> <span m=''4736310''>killed</span> <span m=''4736600''>them</span>
  <span m=''4737120''>and</span> <span m=''4737300''>maimed</span> <span m=''4737670''>them,</span>
  <span m=''4738180''>because</span> <span m=''4738520''>of</span> <span m=''4738610''>race</span>
  <span m=''4738850''>conditions.</span> <span m=''4740030''>These</span> <span m=''4740240''>are</span>
  <span m=''4740330''>really</span> <span m=''4740740''>serious</span> <span m=''4741200''>bugs.</span>
  <span m=''4742890''>Question?</span> </p><p><span m=''4743835''>AUDIENCE: [INAUDIBLE]</span>
  <span m=''4744330''>when</span> <span m=''4744825''>you</span> <span m=''4745320''>said,</span>
  <span m=''4745815''>the</span> <span m=''4746310''>only</span> <span m=''4747300''>time</span>
  <span m=''4747795''>that that</span> <span m=''4748290''>code</span> <span m=''4748785''>is</span>
  <span m=''4749280''>actually execute</span> <span m=''4749775''>serially?</span>
  </p><p><span m=''4752260''>PROFESSOR: It</span> <span m=''4752645''>could</span>
  <span m=''4753030''>execute</span> <span m=''4753500''>in</span> <span m=''4753670''>parallel</span>
  <span m=''4754550''>if</span> <span m=''4754750''>it</span> <span m=''4754830''>happened</span>
  <span m=''4755240''>that</span> <span m=''4755380''>these</span> <span m=''4755640''>guys</span>
  <span m=''4755950''>executed</span> <span m=''4756480''>before</span> <span m=''4756810''>these</span>
  <span m=''4757090''>guys.</span> <span m=''4757330''>If</span> <span m=''4757460''>you</span>
  <span m=''4757570''>think</span> <span m=''4757760''>of</span> <span m=''4757820''>a</span>
  <span m=''4757890''>larger</span> <span m=''4758430''>context,</span> <span m=''4760100''>a</span>
  <span m=''4760140''>whole</span> <span m=''4760370''>bunch</span> <span m=''4760610''>of</span>
  <span m=''4760690''>these</span> <span m=''4760910''>things,</span> <span m=''4761190''>and</span>
  <span m=''4761350''>I</span> <span m=''4761450''>have</span> <span m=''4761630''>two</span>
  <span m=''4762260''>routines</span> <span m=''4762800''>where</span> <span m=''4762950''>they''re</span>
  <span m=''4763090''>both</span> <span m=''4763350''>incrementing</span> <span m=''4763980''>x</span>
  <span m=''4764270''>in</span> <span m=''4764340''>the</span> <span m=''4764750''>middle</span>
  <span m=''4765090''>of</span> <span m=''4765290''>great</span> <span m=''4765620''>big</span>
  <span m=''4765840''>parallel</span> <span m=''4766210''>programs,</span> <span m=''4767980''>it</span>
  <span m=''4768150''>could</span> <span m=''4768340''>be</span> <span m=''4768530''>that</span>
  <span m=''4768670''>they''re</span> <span m=''4768810''>executing</span> <span m=''4769260''>perfectly</span>
  <span m=''4769710''>well</span> <span m=''4769980''>in</span> <span m=''4770090''>parallel.</span>
  </p><p><span m=''4771280''>But</span> <span m=''4771540''>if</span> <span m=''4772300''>those</span>
  <span m=''4772790''>two</span> <span m=''4773400''>small</span> <span m=''4773830''>sections</span>
  <span m=''4774260''>of</span> <span m=''4774350''>code</span> <span m=''4774630''>happen
  to</span> <span m=''4774910''>execute</span> <span m=''4775480''>like</span> <span
  m=''4775710''>this</span> <span m=''4776380''>or</span> <span m=''4776700''>like</span>
  <span m=''4776910''>this,</span> <span m=''4779630''>then</span> <span m=''4780040''>you''re</span>
  <span m=''4780230''>going</span> <span m=''4780320''>to</span> <span m=''4780400''>end</span>
  <span m=''4780670''>up</span> <span m=''4780960''>with it</span> <span m=''4781330''>executing</span>
  <span m=''4781870''>correctly.</span> <span m=''4782360''>But</span> <span m=''4782510''>if</span>
  <span m=''4782600''>they</span> <span m=''4782700''>execute</span> <span m=''4783260''>sort</span>
  <span m=''4783430''>of</span> <span m=''4783500''>at</span> <span m=''4783660''>the</span>
  <span m=''4783750''>same</span> <span m=''4784070''>time,</span> <span m=''4785460''>it</span>
  <span m=''4785780''>would</span> <span m=''4785930''>not</span> <span m=''4786170''>necessarily</span>
  <span m=''4786700''>behave</span> <span m=''4786990''>correctly.</span> </p><p><span
  m=''4789710''>So</span> <span m=''4790310''>there</span> <span m=''4790780''>are</span>
  <span m=''4792540''>two</span> <span m=''4792750''>types</span> <span m=''4793100''>of</span>
  <span m=''4793230''>races</span> <span m=''4793700''>that</span> <span m=''4793790''>people</span>
  <span m=''4794070''>talk</span> <span m=''4794340''>about,</span> <span m=''4794500''>a</span>
  <span m=''4794540''>read</span> <span m=''4794890''>race</span> <span m=''4795260''>and</span>
  <span m=''4795350''>a</span> <span m=''4795420''>write</span> <span m=''4795720''>race.</span>
  <span m=''4796900''>So</span> <span m=''4797060''>suppose</span> <span m=''4797440''>you</span>
  <span m=''4797550''>have</span> <span m=''4797650''>two</span> <span m=''4797850''>instructions</span>
  <span m=''4798550''>that</span> <span m=''4798640''>access</span> <span m=''4799180''>a</span>
  <span m=''4799580''>location,</span> <span m=''4799845''>x.</span> <span m=''4800880''>And</span>
  <span m=''4801030''>suppose</span> <span m=''4801400''>that</span> <span m=''4801530''>a</span>
  <span m=''4801710''>is</span> <span m=''4801860''>parallel</span> <span m=''4802330''>to</span>
  <span m=''4802430''>b.</span> <span m=''4803405''>Both</span> <span m=''4803770''>a</span>
  <span m=''4803960''>and</span> <span m=''4804080''>b</span> <span m=''4804260''>are</span>
  <span m=''4804310''>both</span> <span m=''4804590''>reads,</span> <span m=''4805290''>you</span>
  <span m=''4805400''>get</span> <span m=''4805610''>no</span> <span m=''4805800''>race.</span>
  <span m=''4806170''>That''s</span> <span m=''4806460''>good.</span> <span m=''4808920''>Because</span>
  <span m=''4809130''>there''s</span> <span m=''4809310''>no</span> <span m=''4809470''>way.</span>
  </p><p><span m=''4809950''>But</span> <span m=''4810070''>if</span> <span m=''4810150''>one</span>
  <span m=''4810360''>is</span> <span m=''4810460''>a</span> <span m=''4810530''>read</span>
  <span m=''4810890''>and one</span> <span m=''4811060''>is</span> <span m=''4811170''>a</span>
  <span m=''4811230''>write,</span> <span m=''4811760''>then</span> <span m=''4812670''>one</span>
  <span m=''4812910''>of</span> <span m=''4812970''>them</span> <span m=''4813130''>is</span>
  <span m=''4813240''>going</span> <span m=''4813350''>to</span> <span m=''4813410''>see</span>
  <span m=''4813630''>a</span> <span m=''4813650''>different</span> <span m=''4814070''>value,</span>
  <span m=''4814480''>depending</span> <span m=''4814750''>upon</span> <span m=''4815020''>whether</span>
  <span m=''4815330''>it</span> <span m=''4815380''>occurred</span> <span m=''4815710''>before</span>
  <span m=''4816060''>and</span> <span m=''4816130''>after</span> <span m=''4816410''>the</span>
  <span m=''4816500''>write.</span> <span m=''4816930''>Or</span> <span m=''4817160''>if</span>
  <span m=''4817240''>they</span> <span m=''4817410''>both</span> <span m=''4817800''>are</span>
  <span m=''4817860''>writing,</span> <span m=''4818250''>one</span> <span m=''4818440''>can</span>
  <span m=''4818590''>lose</span> <span m=''4818850''>a</span> <span m=''4818890''>value.</span>
  <span m=''4822190''>So</span> <span m=''4822390''>these</span> <span m=''4822670''>are</span>
  <span m=''4824770''>read</span> <span m=''4825030''>races.</span> <span m=''4825490''>And</span>
  <span m=''4825600''>this</span> <span m=''4825760''>is</span> <span m=''4825880''>a</span>
  <span m=''4825940''>write</span> <span m=''4826220''>race.</span> </p><p><span m=''4827210''>So</span>
  <span m=''4827360''>we</span> <span m=''4827460''>say</span> <span m=''4827650''>that
  the</span> <span m=''4827830''>two</span> <span m=''4827990''>sections</span> <span
  m=''4828370''>of</span> <span m=''4828440''>code are</span> <span m=''4828760''>independent</span>
  <span m=''4829420''>if</span> <span m=''4829540''>they</span> <span m=''4829660''>have</span>
  <span m=''4829770''>no</span> <span m=''4829990''>determinacy</span> <span m=''4830630''>races</span>
  <span m=''4831050''>between</span> <span m=''4831450''>them.</span> <span m=''4832480''>So</span>
  <span m=''4832660''>for</span> <span m=''4832750''>example,</span> <span m=''4833090''>this</span>
  <span m=''4833260''>piece</span> <span m=''4833470''>of</span> <span m=''4833550''>code</span>
  <span m=''4833840''>is</span> <span m=''4834310''>incrementing</span> <span m=''4834880''>y,</span>
  <span m=''4835280''>and</span> <span m=''4835490''>this</span> <span m=''4835630''>is</span>
  <span m=''4835840''>incrementing</span> <span m=''4836220''>x.</span> <span m=''4837050''>And</span>
  <span m=''4837400''>y</span> <span m=''4837670''>is</span> <span m=''4837810''>not</span>
  <span m=''4837990''>equal</span> <span m=''4838270''>to</span> <span m=''4838350''>x.</span>
  <span m=''4839050''>Those</span> <span m=''4839270''>are</span> <span m=''4839330''>independent</span>
  <span m=''4839870''>pieces</span> <span m=''4840220''>of</span> <span m=''4840320''>code.</span>
  </p><p><span m=''4841240''>So</span> <span m=''4841420''>to</span> <span m=''4841590''>avoid</span>
  <span m=''4842010''>races,</span> <span m=''4843680''>you</span> <span m=''4843790''>want</span>
  <span m=''4843930''>to</span> <span m=''4843980''>make</span> <span m=''4844230''>sure</span>
  <span m=''4844660''>that</span> <span m=''4845110''>the</span> <span m=''4845280''>iterations</span>
  <span m=''4845970''>of</span> <span m=''4846090''>your</span> <span m=''4846390''>cilk_for</span>
  <span m=''4847110''>are</span> <span m=''4847320''>independent.</span> <span m=''4848720''>So</span>
  <span m=''4848890''>what''s</span> <span m=''4849050''>going</span> <span m=''4849300''>on</span>
  <span m=''4849490''>in</span> <span m=''4849580''>one</span> <span m=''4850520''>iteration</span>
  <span m=''4851110''>is</span> <span m=''4851440''>different</span> <span m=''4851830''>from</span>
  <span m=''4851970''>what''s</span> <span m=''4852160''>going</span> <span m=''4852420''>on</span>
  <span m=''4852600''>in</span> <span m=''4852690''>another.</span> <span m=''4852990''>That</span>
  <span m=''4853290''>you''re</span> <span m=''4853380''>not</span> <span m=''4853610''>writing</span>
  <span m=''4853950''>something</span> <span m=''4854360''>in</span> <span m=''4854460''>one</span>
  <span m=''4854680''>that</span> <span m=''4854800''>you''re</span> <span m=''4854910''>using</span>
  <span m=''4855360''>in</span> <span m=''4855500''>the</span> <span m=''4855580''>next,</span>
  <span m=''4855980''>for</span> <span m=''4856100''>example.</span> </p><p><span
  m=''4858740''>Between</span> <span m=''4859160''>a cilk_spawn</span> <span m=''4860000''>and</span>
  <span m=''4860090''>the</span> <span m=''4860170''>corresponding</span> <span m=''4860870''>cilk_sync,</span>
  <span m=''4862340''>the</span> <span m=''4862460''>code</span> <span m=''4862800''>of</span>
  <span m=''4862910''>the</span> <span m=''4862990''>spawn</span> <span m=''4863450''>child</span>
  <span m=''4863920''>should</span> <span m=''4864060''>be</span> <span m=''4864180''>independent</span>
  <span m=''4864700''>of</span> <span m=''4864770''>the</span> <span m=''4864860''>code</span>
  <span m=''4865140''>of</span> <span m=''4865230''>the</span> <span m=''4865320''>parent.</span>
  <span m=''4866360''>OK?</span> <span m=''4866630''>Including</span> <span m=''4867090''>any</span>
  <span m=''4867340''>code</span> <span m=''4868210''>executed</span> <span m=''4868700''>by</span>
  <span m=''4868880''>additional</span> <span m=''4869400''>spawned</span> <span m=''4869700''>or</span>
  <span m=''4870000''>called</span> <span m=''4870340''>children.</span> <span m=''4871430''>So
  it''s</span> <span m=''4871570''>basically</span> <span m=''4871950''>saying,</span>
  <span m=''4872100''>when you</span> <span m=''4872250''>spawn</span> <span m=''4872610''>something</span>
  <span m=''4872970''>off,</span> <span m=''4873550''>don''t</span> <span m=''4873800''>then</span>
  <span m=''4874010''>go</span> <span m=''4874270''>and</span> <span m=''4874390''>do</span>
  <span m=''4874550''>something</span> <span m=''4874970''>that''s</span> <span m=''4875160''>going</span>
  <span m=''4875260''>to</span> <span m=''4875750''>modify</span> <span m=''4876740''>the</span>
  <span m=''4876840''>same</span> <span m=''4877130''>locations.</span> <span m=''4878140''>You</span>
  <span m=''4878240''>really</span> <span m=''4878430''>want</span> <span m=''4878590''>to</span>
  <span m=''4878630''>modify</span> <span m=''4879150''>different</span> <span m=''4879560''>locations.</span>
  </p><p><span m=''4882530''>It''s</span> <span m=''4882800''>fine</span> <span m=''4883010''>if</span>
  <span m=''4883120''>they</span> <span m=''4883240''>both</span> <span m=''4883590''>read</span>
  <span m=''4883780''>the</span> <span m=''4883860''>same</span> <span m=''4884150''>locations.</span>
  <span m=''4884730''>But</span> <span m=''4884840''>it''s</span> <span m=''4884970''>not</span>
  <span m=''4885210''>fine</span> <span m=''4885810''>for</span> <span m=''4885920''>one</span>
  <span m=''4886100''>of</span> <span m=''4886170''>them</span> <span m=''4886310''>to</span>
  <span m=''4886430''>read</span> <span m=''4886680''>and one</span> <span m=''4886850''>of</span>
  <span m=''4886960''>them</span> <span m=''4887070''>to</span> <span m=''4887200''>write.</span>
  <span m=''4889730''>One</span> <span m=''4890150''>thing here</span> <span m=''4890380''>to</span>
  <span m=''4890460''>understand</span> <span m=''4891170''>is</span> <span m=''4891520''>that</span>
  <span m=''4891660''>when</span> <span m=''4891890''>you</span> <span m=''4892020''>spawn</span>
  <span m=''4892810''>a</span> <span m=''4893350''>function,</span> <span m=''4894120''>the</span>
  <span m=''4894270''>arguments</span> <span m=''4894840''>are</span> <span m=''4894910''>actually</span>
  <span m=''4895250''>executed</span> <span m=''4895780''>serially</span> <span m=''4896540''>before</span>
  <span m=''4896900''>the</span> <span m=''4897050''>actual</span> <span m=''4897400''>spawn</span>
  <span m=''4897840''>occurs.</span> </p><p><span m=''4898880''>So you</span> <span
  m=''4899040''>evaluate</span> <span m=''4899600''>the</span> <span m=''4899720''>arguments,</span>
  <span m=''4900040''>and</span> <span m=''4900360''>you</span> <span m=''4900470''>set</span>
  <span m=''4900720''>it</span> <span m=''4900790''>all</span> <span m=''4901040''>up,</span>
  <span m=''4901570''>then</span> <span m=''4901900''>you</span> <span m=''4903100''>spawn</span>
  <span m=''4903520''>the</span> <span m=''4903600''>function.</span> <span m=''4905070''>So</span>
  <span m=''4905290''>the</span> <span m=''4905410''>actual</span> <span m=''4905700''>spawn</span>
  <span m=''4906100''>occurs</span> <span m=''4906430''>after</span> <span m=''4906840''>the</span>
  <span m=''4906950''>evaluation</span> <span m=''4907540''>of</span> <span m=''4907640''>arguments.</span>
  <span m=''4908260''>So</span> <span m=''4908430''>they''re</span> <span m=''4908660''>evaluated</span>
  <span m=''4909240''>in</span> <span m=''4909340''>the</span> <span m=''4909410''>parent.</span>
  </p><p><span m=''4912350''>Machine</span> <span m=''4912860''>word</span> <span
  m=''4913110''>size</span> <span m=''4913480''>matters.</span> <span m=''4914690''>So</span>
  <span m=''4915010''>this</span> <span m=''4915220''>is</span> <span m=''4915430''>generally</span>
  <span m=''4915910''>the</span> <span m=''4916060''>case</span> <span m=''4917640''>for</span>
  <span m=''4917810''>races.</span> <span m=''4918250''>By</span> <span m=''4918350''>the</span>
  <span m=''4918450''>way,</span> <span m=''4918540''>races</span> <span m=''4918970''>are</span>
  <span m=''4919040''>not</span> <span m=''4919650''>just</span> <span m=''4919890''>Cilk</span>
  <span m=''4920220''>stuff.</span> <span m=''4920640''>These</span> <span m=''4920800''>races</span>
  <span m=''4921250''>occur</span> <span m=''4921540''>in</span> <span m=''4921610''>all</span>
  <span m=''4921910''>of</span> <span m=''4922130''>these</span> <span m=''4922700''>concurrency</span>
  <span m=''4923240''>platforms.</span> <span m=''4925600''>I''m</span> <span m=''4925740''>illustrating</span>
  <span m=''4926270''>Cilk</span> <span m=''4926570''>because</span> <span m=''4926750''>that''s</span>
  <span m=''4926950''>what</span> <span m=''4927070''>we''re</span> <span m=''4927190''>going</span>
  <span m=''4927290''>to</span> <span m=''4927330''>be</span> <span m=''4927430''>using</span>
  <span m=''4927770''>in</span> <span m=''4927860''>our</span> <span m=''4929000''>labs</span>
  <span m=''4929370''>and</span> <span m=''4929510''>so</span> <span m=''4929640''>forth.</span>
  </p><p><span m=''4930480''>So</span> <span m=''4930610''>it</span> <span m=''4930660''>turns</span>
  <span m=''4930880''>out</span> <span m=''4931050''>machine</span> <span m=''4931390''>word</span>
  <span m=''4931630''>size</span> <span m=''4931890''>matters.</span> <span m=''4932430''>And</span>
  <span m=''4932820''>you</span> <span m=''4932950''>can</span> <span m=''4933420''>have</span>
  <span m=''4933720''>races</span> <span m=''4934350''>in</span> <span m=''4935030''>packed</span>
  <span m=''4935380''>data</span> <span m=''4935600''>structures.</span> <span m=''4936370''>So</span>
  <span m=''4936540''>for</span> <span m=''4936640''>example,</span> <span m=''4937850''>on</span>
  <span m=''4938050''>some</span> <span m=''4938310''>machines,</span> <span m=''4939330''>if</span>
  <span m=''4939490''>you</span> <span m=''4939950''>declare</span> <span m=''4940480''>a</span>
  <span m=''4942180''>char a</span> <span m=''4942550''>and</span> <span m=''4942860''>char
  b</span> <span m=''4943974''>in</span> <span m=''4944381''>a</span> <span m=''4944790''>struct,</span>
  <span m=''4946310''>then</span> <span m=''4946690''>updating</span> <span m=''4947250''>x</span>
  <span m=''4947720''>and</span> <span m=''4947960''>x, b</span> <span m=''4948450''>in</span>
  <span m=''4948580''>parallel</span> <span m=''4949040''>may</span> <span m=''4949190''>cause</span>
  <span m=''4949510''>a</span> <span m=''4949570''>race,</span> <span m=''4951210''>because</span>
  <span m=''4951510''>they''re</span> <span m=''4951620''>both</span> <span m=''4952030''>actually</span>
  <span m=''4952420''>operating</span> <span m=''4952810''>on</span> <span m=''4952890''>a</span>
  <span m=''4952950''>word</span> <span m=''4953280''>basis.</span> </p><p><span m=''4954380''>Now
  on</span> <span m=''4954480''>the</span> <span m=''4954590''>Intel</span> <span
  m=''4955030''>architectures,</span> <span m=''4956650''>that</span> <span m=''4956880''>doesn''t</span>
  <span m=''4957130''>happen.</span> <span m=''4957550''>Because</span> <span m=''4958000''>Intel</span>
  <span m=''4958380''>supports</span> <span m=''4959030''>atomic</span> <span m=''4959470''>updates</span>
  <span m=''4959990''>of</span> <span m=''4960080''>single</span> <span m=''4960410''>bytes.</span>
  <span m=''4962090''>So</span> <span m=''4962680''>you</span> <span m=''4962730''>don''t</span>
  <span m=''4962880''>have</span> <span m=''4963030''>to</span> <span m=''4963140''>worry</span>
  <span m=''4963240''>about</span> <span m=''4963580''>it.</span> <span m=''4963740''>But
  if</span> <span m=''4963800''>you were</span> <span m=''4964000''>accessing</span>
  <span m=''4964510''>bits</span> <span m=''4965540''>within</span> <span m=''4965900''>a</span>
  <span m=''4965970''>word,</span> <span m=''4966900''>you</span> <span m=''4967050''>could</span>
  <span m=''4967200''>end</span> <span m=''4967360''>up</span> <span m=''4967500''>with</span>
  <span m=''4967600''>the</span> <span m=''4967660''>same</span> <span m=''4967990''>thing.</span>
  <span m=''4968240''>You</span> <span m=''4968320''>access</span> <span m=''4968710''>bit</span>
  <span m=''4969020''>five</span> <span m=''4969470''>and</span> <span m=''4969700''>bit</span>
  <span m=''4969930''>three,</span> <span m=''4971680''>you</span> <span m=''4971900''>think</span>
  <span m=''4972170''>you''re</span> <span m=''4972480''>acting</span> <span m=''4972990''>independently,</span>
  <span m=''4973570''>but</span> <span m=''4973700''>in</span> <span m=''4973790''>fact,</span>
  <span m=''4974140''>you''re</span> <span m=''4974270''>reading</span> <span m=''4974530''>the</span>
  <span m=''4974610''>whole</span> <span m=''4974850''>word</span> <span m=''4975670''>or</span>
  <span m=''4975750''>the</span> <span m=''4975830''>whole</span> <span m=''4976040''>byte</span>
  <span m=''4976490''>in</span> <span m=''4976620''>order</span> <span m=''4976870''>to</span>
  <span m=''4977220''>access</span> <span m=''4977670''>it.</span> </p><p><span m=''4981070''>The</span>
  <span m=''4982200''>technology</span> <span m=''4982830''>that</span> <span m=''4982930''>you''re</span>
  <span m=''4983070''>going</span> <span m=''4983170''>to</span> <span m=''4983220''>be</span>
  <span m=''4983400''>using</span> <span m=''4983850''>fortunately</span> <span m=''4984450''>comes</span>
  <span m=''4984850''>with</span> <span m=''4985270''>a</span> <span m=''4985660''>race</span>
  <span m=''4986120''>detector,</span> <span m=''4987330''>which</span> <span m=''4987530''>you</span>
  <span m=''4987650''>will</span> <span m=''4987800''>find</span> <span m=''4988140''>invaluable</span>
  <span m=''4989180''>for</span> <span m=''4989340''>debugging</span> <span m=''4989810''>your</span>
  <span m=''4989960''>stuff.</span> <span m=''4991590''>And</span> <span m=''4991830''>so</span>
  <span m=''4991980''>this</span> <span m=''4992150''>is</span> <span m=''4992300''>kind</span>
  <span m=''4992620''>of</span> <span m=''4992710''>like</span> <span m=''4992970''>a</span>
  <span m=''4993020''>Valgrind</span> <span m=''4993730''>for</span> <span m=''4993870''>races.</span>
  <span m=''4998920''>What''s</span> <span m=''4999370''>good</span> <span m=''4999510''>about</span>
  <span m=''4999790''>this</span> <span m=''4999950''>race</span> <span m=''5000230''>detector</span>
  <span m=''5000720''>is</span> <span m=''5000930''>it</span> <span m=''5001070''>provides</span>
  <span m=''5001710''>a</span> <span m=''5002420''>rock</span> <span m=''5002740''>hard</span>
  <span m=''5003050''>guarantee.</span> </p><p><span m=''5004150''>If</span> <span
  m=''5004540''>you</span> <span m=''5004770''>have</span> <span m=''5004990''>a</span>
  <span m=''5005120''>deterministic</span> <span m=''5006150''>program</span> <span
  m=''5007210''>that</span> <span m=''5007380''>on</span> <span m=''5007530''>a</span>
  <span m=''5007560''>given</span> <span m=''5008080''>input</span> <span m=''5008520''>could</span>
  <span m=''5008680''>possibly</span> <span m=''5009370''>behave</span> <span m=''5009820''>any</span>
  <span m=''5010020''>differently</span> <span m=''5010490''>from</span> <span m=''5010670''>your</span>
  <span m=''5010840''>serial</span> <span m=''5011250''>program,</span> <span m=''5012840''>from</span>
  <span m=''5013000''>the</span> <span m=''5013730''>corresponding</span> <span m=''5014310''>serial</span>
  <span m=''5014690''>program,</span> <span m=''5015080''>if</span> <span m=''5015210''>you</span>
  <span m=''5015310''>got</span> <span m=''5015680''>rid</span> <span m=''5015890''>of</span>
  <span m=''5015980''>the</span> <span m=''5016810''>parallel</span> <span m=''5017190''>keywords,</span>
  <span m=''5018200''>this</span> <span m=''5018630''>tool,</span> <span m=''5018970''>Cilkscreen,</span>
  <span m=''5019620''>guarantees</span> <span m=''5020190''>to</span> <span m=''5020290''>report</span>
  <span m=''5020720''>and</span> <span m=''5020820''>localize</span> <span m=''5021460''>the</span>
  <span m=''5021570''>offending</span> <span m=''5021990''>race.</span> <span m=''5023370''>It''ll</span>
  <span m=''5023630''>tell</span> <span m=''5024030''>you,</span> <span m=''5024240''>you
  got</span> <span m=''5024490''>a</span> <span m=''5024530''>race</span> <span m=''5024920''>between</span>
  <span m=''5025250''>this</span> <span m=''5025470''>location</span> <span m=''5025970''>and</span>
  <span m=''5026060''>that</span> <span m=''5026280''>location.</span> <span m=''5027100''>And
  it''s</span> <span m=''5027270''>up</span> <span m=''5027380''>to</span> <span m=''5027460''>you</span>
  <span m=''5027570''>to</span> <span m=''5027670''>find it</span> <span m=''5028080''>and</span>
  <span m=''5028170''>fix</span> <span m=''5028440''>it,</span> <span m=''5028740''>but</span>
  <span m=''5029850''>it</span> <span m=''5029980''>can</span> <span m=''5030150''>tell</span>
  <span m=''5030330''>you</span> <span m=''5030440''>that.</span> </p><p><span m=''5031065''>It</span>
  <span m=''5031330''>employs</span> <span m=''5032030''>regression</span> <span m=''5032480''>test</span>
  <span m=''5032770''>methodology,</span> <span m=''5033450''>where</span> <span m=''5033750''>the</span>
  <span m=''5033850''>programmer</span> <span m=''5034300''>provides</span> <span
  m=''5034820''>test</span> <span m=''5035150''>inputs.</span> <span m=''5035820''>So</span>
  <span m=''5035970''>if</span> <span m=''5036030''>you</span> <span m=''5036150''>don''t</span>
  <span m=''5036340''>provide</span> <span m=''5036740''>test</span> <span m=''5037080''>inputs</span>
  <span m=''5037910''>to</span> <span m=''5038950''>elicit</span> <span m=''5039460''>the</span>
  <span m=''5039560''>race,</span> <span m=''5040610''>you</span> <span m=''5040720''>still</span>
  <span m=''5040980''>can</span> <span m=''5041120''>have</span> <span m=''5041280''>a</span>
  <span m=''5041330''>bug.</span> <span m=''5042650''>But</span> <span m=''5042810''>if</span>
  <span m=''5042980''>you</span> <span m=''5043090''>have</span> <span m=''5043190''>a</span>
  <span m=''5043280''>test</span> <span m=''5043610''>input</span> <span m=''5043980''>that</span>
  <span m=''5044090''>in</span> <span m=''5044230''>any</span> <span m=''5044490''>way</span>
  <span m=''5044840''>could</span> <span m=''5045030''>behave</span> <span m=''5045430''>differently</span>
  <span m=''5045880''>than</span> <span m=''5046020''>the</span> <span m=''5046100''>serial</span>
  <span m=''5046520''>execution,</span> <span m=''5047600''>bingo.</span> <span m=''5048090''>It''ll</span>
  <span m=''5048320''>tell</span> <span m=''5048510''>you.</span> </p><p><span m=''5051850''>It</span>
  <span m=''5052290''>identifies</span> <span m=''5053200''>a</span> <span m=''5053440''>bunch</span>
  <span m=''5053690''>of</span> <span m=''5053800''>things</span> <span m=''5054250''>involving
  the</span> <span m=''5054600''>race,</span> <span m=''5054860''>including</span>
  <span m=''5055280''>a</span> <span m=''5055320''>stack</span> <span m=''5055700''>trace.</span>
  <span m=''5056700''>It</span> <span m=''5056940''>runs</span> <span m=''5057210''>off</span>
  <span m=''5057370''>the</span> <span m=''5057460''>binary</span> <span m=''5057890''>executable</span>
  <span m=''5058700''>using</span> <span m=''5059160''>what''s</span> <span m=''5059350''>called</span>
  <span m=''5059580''>dynamic</span> <span m=''5060090''>instrumentation.</span> <span
  m=''5061530''>So</span> <span m=''5061640''>that''s</span> <span m=''5061820''>kind</span>
  <span m=''5061960''>of</span> <span m=''5062100''>like</span> <span m=''5062370''>Valgrind,</span>
  <span m=''5063060''>except</span> <span m=''5063790''>it</span> <span m=''5063890''>actually</span>
  <span m=''5064170''>does</span> <span m=''5064470''>this</span> <span m=''5065370''>as</span>
  <span m=''5065630''>it''s</span> <span m=''5065750''>running.</span> <span m=''5066700''>It</span>
  <span m=''5067000''>uses</span> <span m=''5067440''>a</span> <span m=''5067850''>technology</span>
  <span m=''5068500''>called</span> <span m=''5068870''>PIN,</span> <span m=''5069720''>which</span>
  <span m=''5069910''>you</span> <span m=''5070020''>can</span> <span m=''5070460''>read</span>
  <span m=''5070730''>about.</span> <span m=''5071030''>P-I-N,</span> <span m=''5073160''>which</span>
  <span m=''5073670''>is</span> <span m=''5073950''>a</span> <span m=''5074550''>nice</span>
  <span m=''5074920''>platform</span> <span m=''5075510''>for</span> <span m=''5075710''>doing</span>
  <span m=''5077070''>code</span> <span m=''5077340''>rewriting</span> <span m=''5077880''>and</span>
  <span m=''5077970''>analysis</span> <span m=''5078560''>on</span> <span m=''5078690''>the</span>
  <span m=''5078770''>fly.</span> </p><p><span m=''5079620''>It</span> <span m=''5079750''>runs</span>
  <span m=''5079940''>about</span> <span m=''5080160''>20</span> <span m=''5080440''>times</span>
  <span m=''5080750''>slower</span> <span m=''5081100''>than</span> <span m=''5081260''>real</span>
  <span m=''5081470''>time.</span> <span m=''5082600''>So</span> <span m=''5083830''>you</span>
  <span m=''5084050''>basically</span> <span m=''5084450''>use</span> <span m=''5084610''>it</span>
  <span m=''5084740''>for</span> <span m=''5084840''>debugging.</span> <span m=''5087600''>So</span>
  <span m=''5093050''>the</span> <span m=''5093510''>first</span> <span m=''5094160''>part</span>
  <span m=''5094500''>of</span> <span m=''5094570''>project</span> <span m=''5095060''>four</span>
  <span m=''5095510''>is</span> <span m=''5095700''>basically</span> <span m=''5096170''>coming</span>
  <span m=''5096470''>up</span> <span m=''5096570''>to</span> <span m=''5096660''>speed</span>
  <span m=''5097450''>with</span> <span m=''5097570''>this</span> <span m=''5097740''>technology.</span>
  <span m=''5098750''>And</span> <span m=''5098940''>so,</span> <span m=''5099070''>there''s</span>
  <span m=''5099220''>some</span> <span m=''5099350''>good</span> <span m=''5099520''>things.</span>
  <span m=''5099790''>And</span> <span m=''5099890''>that''s</span> <span m=''5100110''>going</span>
  <span m=''5100210''>to</span> <span m=''5100260''>be</span> <span m=''5100390''>available</span>
  <span m=''5100810''>tomorrow.</span> <span m=''5101180''>Is</span> <span m=''5101290''>that
  what</span> <span m=''5101350''>we</span> <span m=''5101620''>said?</span> <span
  m=''5101900''>Yeah,</span> <span m=''5102470''>that</span> <span m=''5102590''>will</span>
  <span m=''5102660''>be</span> <span m=''5102760''>available</span> <span m=''5103140''>tomorrow.</span>
  </p><p><span m=''5105310''>So</span> <span m=''5105460''>this</span> <span m=''5105650''>is</span>
  <span m=''5105790''>actually--</span> <span m=''5106050''>this is</span> <span m=''5106300''>tons</span>
  <span m=''5106560''>of</span> <span m=''5106640''>fun.</span> <span m=''5107410''>Most</span>
  <span m=''5108440''>people</span> <span m=''5108700''>in</span> <span m=''5108760''>most</span>
  <span m=''5108980''>places</span> <span m=''5109330''>don''t</span> <span m=''5109500''>get</span>
  <span m=''5109640''>to</span> <span m=''5109710''>play</span> <span m=''5109950''>with</span>
  <span m=''5110120''>parallel</span> <span m=''5110500''>technology</span> <span
  m=''5111060''>like</span> <span m=''5111260''>this.</span> </p>'
uid: b3d5da5f-cd90-d88e-1273-9229d0e49cd2
---
